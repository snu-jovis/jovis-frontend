{
  "tpch": {
    "1": "/* TPC-H Query 1 */\n-- using 1711772513 as a seed to the RNG\n\nselect\n\tl_returnflag,\n\tl_linestatus,\n\tsum(l_quantity) as sum_qty,\n\tsum(l_extendedprice) as sum_base_price,\n\tsum(l_extendedprice * (1 - l_discount)) as sum_disc_price,\n\tsum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge,\n\tavg(l_quantity) as avg_qty,\n\tavg(l_extendedprice) as avg_price,\n\tavg(l_discount) as avg_disc,\n\tcount(*) as count_order\nfrom\n\tlineitem\nwhere\n\tl_shipdate <= date '1998-12-01' - interval '70' day\ngroup by\n\tl_returnflag,\n\tl_linestatus\norder by\n\tl_returnflag,\n\tl_linestatus\nLIMIT 1;\n",
    "2": "/* TPC-H Query 2 */\n-- using 1711772513 as a seed to the RNG\n\nselect\n\ts_acctbal,\n\ts_name,\n\tn_name,\n\tp_partkey,\n\tp_mfgr,\n\ts_address,\n\ts_phone,\n\ts_comment\nfrom\n\tpart,\n\tsupplier,\n\tpartsupp,\n\tnation,\n\tregion\nwhere\n\tp_partkey = ps_partkey\n\tand s_suppkey = ps_suppkey\n\tand p_size = 11\n\tand p_type like '%NICKEL'\n\tand s_nationkey = n_nationkey\n\tand n_regionkey = r_regionkey\n\tand r_name = 'MIDDLE EAST'\n\tand ps_supplycost = (\n\t\tselect\n\t\t\tmin(ps_supplycost)\n\t\tfrom\n\t\t\tpartsupp,\n\t\t\tsupplier,\n\t\t\tnation,\n\t\t\tregion\n\t\twhere\n\t\t\tp_partkey = ps_partkey\n\t\t\tand s_suppkey = ps_suppkey\n\t\t\tand s_nationkey = n_nationkey\n\t\t\tand n_regionkey = r_regionkey\n\t\t\tand r_name = 'MIDDLE EAST'\n\t)\norder by\n\ts_acctbal desc,\n\tn_name,\n\ts_name,\n\tp_partkey\nLIMIT 100;\n",
    "3": "/* TPC-H Query 3 */\n-- using 1711772513 as a seed to the RNG\n\nselect\n\tl_orderkey,\n\tsum(l_extendedprice * (1 - l_discount)) as revenue,\n\to_orderdate,\n\to_shippriority\nfrom\n\tcustomer,\n\torders,\n\tlineitem\nwhere\n\tc_mktsegment = 'MACHINERY'\n\tand c_custkey = o_custkey\n\tand l_orderkey = o_orderkey\n\tand o_orderdate < date '1995-03-26'\n\tand l_shipdate > date '1995-03-26'\ngroup by\n\tl_orderkey,\n\to_orderdate,\n\to_shippriority\norder by\n\trevenue desc,\n\to_orderdate\nLIMIT 10;",
    "4": "/* TPC-H Query 4 */\n-- using 1711772513 as a seed to the RNG\n\nselect\n\to_orderpriority,\n\tcount(*) as order_count\nfrom\n\torders\nwhere\n\to_orderdate >= date '1997-01-01'\n\tand o_orderdate < date '1997-01-01' + interval '3' month\n\tand exists (\n\t\tselect\n\t\t\t*\n\t\tfrom\n\t\t\tlineitem\n\t\twhere\n\t\t\tl_orderkey = o_orderkey\n\t\t\tand l_commitdate < l_receiptdate\n\t)\ngroup by\n\to_orderpriority\norder by\n\to_orderpriority\nLIMIT 1;\n",
    "5": "/* TPC-H Query 5 */\n-- using 1711772513 as a seed to the RNG\n\nselect\n\tn_name,\n\tsum(l_extendedprice * (1 - l_discount)) as revenue\nfrom\n\tcustomer,\n\torders,\n\tlineitem,\n\tsupplier,\n\tnation,\n\tregion\nwhere\n\tc_custkey = o_custkey\n\tand l_orderkey = o_orderkey\n\tand l_suppkey = s_suppkey\n\tand c_nationkey = s_nationkey\n\tand s_nationkey = n_nationkey\n\tand n_regionkey = r_regionkey\n\tand r_name = 'EUROPE'\n\tand o_orderdate >= date '1997-01-01'\n\tand o_orderdate < date '1997-01-01' + interval '1' year\ngroup by\n\tn_name\norder by\n\trevenue desc\nLIMIT 1;\n",
    "6": "/* TPC-H Query 6 */\n-- using 1711772513 as a seed to the RNG\n\nselect\n\tsum(l_extendedprice * l_discount) as revenue\nfrom\n\tlineitem\nwhere\n\tl_shipdate >= date '1997-01-01'\n\tand l_shipdate < date '1997-01-01' + interval '1' year\n\tand l_discount between 0.05 - 0.01 and 0.05 + 0.01\n\tand l_quantity < 25\nLIMIT 1;\n",
    "7": "/* TPC-H Query 7 */\n-- using 1711772513 as a seed to the RNG\n\nselect\n\tsupp_nation,\n\tcust_nation,\n\tl_year,\n\tsum(volume) as revenue\nfrom\n\t(\n\t\tselect\n\t\t\tn1.n_name as supp_nation,\n\t\t\tn2.n_name as cust_nation,\n\t\t\textract(year from l_shipdate) as l_year,\n\t\t\tl_extendedprice * (1 - l_discount) as volume\n\t\tfrom\n\t\t\tsupplier,\n\t\t\tlineitem,\n\t\t\torders,\n\t\t\tcustomer,\n\t\t\tnation n1,\n\t\t\tnation n2\n\t\twhere\n\t\t\ts_suppkey = l_suppkey\n\t\t\tand o_orderkey = l_orderkey\n\t\t\tand c_custkey = o_custkey\n\t\t\tand s_nationkey = n1.n_nationkey\n\t\t\tand c_nationkey = n2.n_nationkey\n\t\t\tand (\n\t\t\t\t(n1.n_name = 'INDONESIA' and n2.n_name = 'PERU')\n\t\t\t\tor (n1.n_name = 'PERU' and n2.n_name = 'INDONESIA')\n\t\t\t)\n\t\t\tand l_shipdate between date '1995-01-01' and date '1996-12-31'\n\t) as shipping\ngroup by\n\tsupp_nation,\n\tcust_nation,\n\tl_year\norder by\n\tsupp_nation,\n\tcust_nation,\n\tl_year\nLIMIT 1;",
    "8": "/* TPC-H Query 8 */\n-- using 1711772513 as a seed to the RNG\n\nselect\n\to_year,\n\tsum(case\n\t\twhen nation = 'PERU' then volume\n\t\telse 0\n\tend) / sum(volume) as mkt_share\nfrom\n\t(\n\t\tselect\n\t\t\textract(year from o_orderdate) as o_year,\n\t\t\tl_extendedprice * (1 - l_discount) as volume,\n\t\t\tn2.n_name as nation\n\t\tfrom\n\t\t\tpart,\n\t\t\tsupplier,\n\t\t\tlineitem,\n\t\t\torders,\n\t\t\tcustomer,\n\t\t\tnation n1,\n\t\t\tnation n2,\n\t\t\tregion\n\t\twhere\n\t\t\tp_partkey = l_partkey\n\t\t\tand s_suppkey = l_suppkey\n\t\t\tand l_orderkey = o_orderkey\n\t\t\tand o_custkey = c_custkey\n\t\t\tand c_nationkey = n1.n_nationkey\n\t\t\tand n1.n_regionkey = r_regionkey\n\t\t\tand r_name = 'AMERICA'\n\t\t\tand s_nationkey = n2.n_nationkey\n\t\t\tand o_orderdate between date '1995-01-01' and date '1996-12-31'\n\t\t\tand p_type = 'MEDIUM BURNISHED TIN'\n\t) as all_nations\ngroup by\n\to_year\norder by\n\to_year\nLIMIT 1;",
    "9": "/* TPC-H Query 9 */\n-- using 1711772513 as a seed to the RNG\n\nselect\n\tnation,\n\to_year,\n\tsum(amount) as sum_profit\nfrom\n\t(\n\t\tselect\n\t\t\tn_name as nation,\n\t\t\textract(year from o_orderdate) as o_year,\n\t\t\tl_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount\n\t\tfrom\n\t\t\tpart,\n\t\t\tsupplier,\n\t\t\tlineitem,\n\t\t\tpartsupp,\n\t\t\torders,\n\t\t\tnation\n\t\twhere\n\t\t\ts_suppkey = l_suppkey\n\t\t\tand ps_suppkey = l_suppkey\n\t\t\tand ps_partkey = l_partkey\n\t\t\tand p_partkey = l_partkey\n\t\t\tand o_orderkey = l_orderkey\n\t\t\tand s_nationkey = n_nationkey\n\t\t\tand p_name like '%green%'\n\t) as profit\ngroup by\n\tnation,\n\to_year\norder by\n\tnation,\n\to_year desc;",
    "10": "/* TPC-H Query 10 */\n-- using 1711772513 as a seed to the RNG\n\nselect\n\tc_custkey,\n\tc_name,\n\tsum(l_extendedprice * (1 - l_discount)) as revenue,\n\tc_acctbal,\n\tn_name,\n\tc_address,\n\tc_phone,\n\tc_comment\nfrom\n\tcustomer,\n\torders,\n\tlineitem,\n\tnation\nwhere\n\tc_custkey = o_custkey\n\tand l_orderkey = o_orderkey\n\tand o_orderdate >= date '1994-12-01'\n\tand o_orderdate < date '1994-12-01' + interval '3' month\n\tand l_returnflag = 'R'\n\tand c_nationkey = n_nationkey\ngroup by\n\tc_custkey,\n\tc_name,\n\tc_acctbal,\n\tc_phone,\n\tn_name,\n\tc_address,\n\tc_comment\norder by\n\trevenue desc;",
    "11": "/* TPC-H Query 11 */\n-- using 1711772513 as a seed to the RNG\n\nselect\n\tps_partkey,\n\tsum(ps_supplycost * ps_availqty) as value\nfrom\n\tpartsupp,\n\tsupplier,\n\tnation\nwhere\n\tps_suppkey = s_suppkey\n\tand s_nationkey = n_nationkey\n\tand n_name = 'JAPAN'\ngroup by\n\tps_partkey having\n\t\tsum(ps_supplycost * ps_availqty) > (\n\t\t\tselect\n\t\t\t\tsum(ps_supplycost * ps_availqty) * 0.0001000000\n\t\t\tfrom\n\t\t\t\tpartsupp,\n\t\t\t\tsupplier,\n\t\t\t\tnation\n\t\t\twhere\n\t\t\t\tps_suppkey = s_suppkey\n\t\t\t\tand s_nationkey = n_nationkey\n\t\t\t\tand n_name = 'JAPAN'\n\t\t)\norder by\n\tvalue desc\nLIMIT 1;",
    "12": "/* TPC-H Query 12 */\n-- using 1711772513 as a seed to the RNG\n\nselect\n\tl_shipmode,\n\tsum(case\n\t\twhen o_orderpriority = '1-URGENT'\n\t\t\tor o_orderpriority = '2-HIGH'\n\t\t\tthen 1\n\t\telse 0\n\tend) as high_line_count,\n\tsum(case\n\t\twhen o_orderpriority <> '1-URGENT'\n\t\t\tand o_orderpriority <> '2-HIGH'\n\t\t\tthen 1\n\t\telse 0\n\tend) as low_line_count\nfrom\n\torders,\n\tlineitem\nwhere\n\to_orderkey = l_orderkey\n\tand l_shipmode in ('FOB', 'TRUCK')\n\tand l_commitdate < l_receiptdate\n\tand l_shipdate < l_commitdate\n\tand l_receiptdate >= date '1994-01-01'\n\tand l_receiptdate < date '1994-01-01' + interval '1' year\ngroup by\n\tl_shipmode\norder by\n\tl_shipmode\nLIMIT 1;",
    "13": "/* TPC-H Query 13 */\n-- using 1711772513 as a seed to the RNG\n\nselect\n\tc_count,\n\tcount(*) as custdist\nfrom\n\t(\n\t\tselect\n\t\t\tc_custkey,\n\t\t\tcount(o_orderkey)\n\t\tfrom\n\t\t\tcustomer left outer join orders on\n\t\t\t\tc_custkey = o_custkey\n\t\t\t\tand o_comment not like '%unusual%requests%'\n\t\tgroup by\n\t\t\tc_custkey\n\t) as c_orders (c_custkey, c_count)\ngroup by\n\tc_count\norder by\n\tcustdist desc,\n\tc_count desc\nLIMIT 1;",
    "14": "/* TPC-H Query 14 */\n-- using 1711772513 as a seed to the RNG\n\nselect\n\t100.00 * sum(case\n\t\twhen p_type like 'PROMO%'\n\t\t\tthen l_extendedprice * (1 - l_discount)\n\t\telse 0\n\tend) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue\nfrom\n\tlineitem,\n\tpart\nwhere\n\tl_partkey = p_partkey\n\tand l_shipdate >= date '1994-11-01'\n\tand l_shipdate < date '1994-11-01' + interval '1' month\nLIMIT 1;",
    "15": "/* TPC-H Query 15 */\n-- using 1711772513 as a seed to the RNG\n\nwith revenue0 (supplier_no, total_revenue) as (\n\tselect\n\t\tl_suppkey,\n\t\tsum(l_extendedprice * (1 - l_discount))\n\tfrom\n\t\tlineitem\n\twhere\n\t\tl_shipdate >= date '1993-05-01'\n\t\tand l_shipdate < date '1993-05-01' + interval '3' month\n\tgroup by\n\t\tl_suppkey\n)\nselect\n\ts_suppkey,\n\ts_name,\n\ts_address,\n\ts_phone,\n\ttotal_revenue\nfrom\n\tsupplier,\n\trevenue0\nwhere\n\ts_suppkey = supplier_no\n\tand total_revenue = (\n\t\tselect\n\t\t\tmax(total_revenue)\n\t\tfrom\n\t\t\trevenue0\n\t)\norder by\n\ts_suppkey\nLIMIT 1;\n",
    "16": "/* TPC-H Query 16 */\n-- using 1711772513 as a seed to the RNG\n\nselect\n\tp_brand,\n\tp_type,\n\tp_size,\n\tcount(distinct ps_suppkey) as supplier_cnt\nfrom\n\tpartsupp,\n\tpart\nwhere\n\tp_partkey = ps_partkey\n\tand p_brand <> 'Brand#43'\n\tand p_type not like 'STANDARD ANODIZED%'\n\tand p_size in (45, 33, 36, 5, 40, 32, 41, 14)\n\tand ps_suppkey not in (\n\t\tselect\n\t\t\ts_suppkey\n\t\tfrom\n\t\t\tsupplier\n\t\twhere\n\t\t\ts_comment like '%Customer%Complaints%'\n\t)\ngroup by\n\tp_brand,\n\tp_type,\n\tp_size\norder by\n\tsupplier_cnt desc,\n\tp_brand,\n\tp_type,\n\tp_size\nLIMIT 1;",
    "17": "/* TPC-H Query 17 */\n-- using 1711772513 as a seed to the RNG\n\nselect\n\tsum(l_extendedprice) / 7.0 as avg_yearly\nfrom\n\tlineitem,\n\tpart,\n\t(SELECT l_partkey AS agg_partkey, 0.2 * avg(l_quantity) AS avg_quantity FROM lineitem GROUP BY l_partkey) part_agg\nwhere\n\tp_partkey = l_partkey\n\tand agg_partkey = l_partkey\n\tand p_brand = 'Brand#31'\n\tand p_container = 'WRAP JAR'\n\tand l_quantity < avg_quantity\nLIMIT 1;\n",
    "18": "/* TPC-H Query 18 */\n-- using 1711772513 as a seed to the RNG\n\nselect\n\tc_name,\n\tc_custkey,\n\to_orderkey,\n\to_orderdate,\n\to_totalprice,\n\tsum(l_quantity)\nfrom\n\tcustomer,\n\torders,\n\tlineitem\nwhere\n\to_orderkey in (\n\t\tselect\n\t\t\tl_orderkey\n\t\tfrom\n\t\t\tlineitem\n\t\tgroup by\n\t\t\tl_orderkey having\n\t\t\t\tsum(l_quantity) > 312\n\t)\n\tand c_custkey = o_custkey\n\tand o_orderkey = l_orderkey\ngroup by\n\tc_name,\n\tc_custkey,\n\to_orderkey,\n\to_orderdate,\n\to_totalprice\norder by\n\to_totalprice desc,\n\to_orderdate\nLIMIT 100;",
    "19": "/* TPC-H Query 19 */\n-- using 1711772513 as a seed to the RNG\n\nselect\n\tsum(l_extendedprice* (1 - l_discount)) as revenue\nfrom\n\tlineitem,\n\tpart\nwhere\n\t(\n\t\tp_partkey = l_partkey\n\t\tand p_brand = 'Brand#54'\n\t\tand p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG')\n\t\tand l_quantity >= 8 and l_quantity <= 8 + 10\n\t\tand p_size between 1 and 5\n\t\tand l_shipmode in ('AIR', 'AIR REG')\n\t\tand l_shipinstruct = 'DELIVER IN PERSON'\n\t)\n\tor\n\t(\n\t\tp_partkey = l_partkey\n\t\tand p_brand = 'Brand#41'\n\t\tand p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK')\n\t\tand l_quantity >= 11 and l_quantity <= 11 + 10\n\t\tand p_size between 1 and 10\n\t\tand l_shipmode in ('AIR', 'AIR REG')\n\t\tand l_shipinstruct = 'DELIVER IN PERSON'\n\t)\n\tor\n\t(\n\t\tp_partkey = l_partkey\n\t\tand p_brand = 'Brand#43'\n\t\tand p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG')\n\t\tand l_quantity >= 24 and l_quantity <= 24 + 10\n\t\tand p_size between 1 and 15\n\t\tand l_shipmode in ('AIR', 'AIR REG')\n\t\tand l_shipinstruct = 'DELIVER IN PERSON'\n\t)\nLIMIT 1;",
    "20": "/* TPC-H Query 20 */\n-- using 1711772513 as a seed to the RNG\n\nselect\n\ts_name,\n\ts_address\nfrom\n\tsupplier,\n\tnation\nwhere\n\ts_suppkey in (\n\t\tselect\n\t\t\tps_suppkey\n\t\tfrom\n\t\t\tpartsupp,\n\t\t\t(\n\t\t\t\tselect\n\t\t\t\t\tl_partkey agg_partkey,\n\t\t\t\t\tl_suppkey agg_suppkey,\n\t\t\t\t\t0.5 * sum(l_quantity) AS agg_quantity\n\t\t\t\tfrom\n\t\t\t\t\tlineitem\n\t\t\t\twhere\n\t\t\t\t\tl_shipdate >= date '1996-01-01'\n\t\t\t\t\tand l_shipdate < date '1996-01-01' + interval '1' year\n\t\t\t\tgroup by\n\t\t\t\t\tl_partkey,\n\t\t\t\t\tl_suppkey\n\t\t\t) agg_lineitem\n\t\twhere\n\t\t\tagg_partkey = ps_partkey\n\t\t\tand agg_suppkey = ps_suppkey\n\t\t\tand ps_partkey in (\n\t\t\t\tselect\n\t\t\t\t\tp_partkey\n\t\t\t\tfrom\n\t\t\t\t\tpart\n\t\t\t\twhere\n\t\t\t\t\tp_name like 'orange%'\n\t\t\t)\n\t\t\tand ps_availqty > agg_quantity\n\t)\n\tand s_nationkey = n_nationkey\n\tand n_name = 'ARGENTINA'\norder by\n\ts_name;",
    "21": "/* TPC-H Query 21 */\n-- using 1711772513 as a seed to the RNG\n\nselect\n\ts_name,\n\tcount(*) as numwait\nfrom\n\tsupplier,\n\tlineitem l1,\n\torders,\n\tnation\nwhere\n\ts_suppkey = l1.l_suppkey\n\tand o_orderkey = l1.l_orderkey\n\tand o_orderstatus = 'F'\n\tand l1.l_receiptdate > l1.l_commitdate\n\tand exists (\n\t\tselect\n\t\t\t*\n\t\tfrom\n\t\t\tlineitem l2\n\t\twhere\n\t\t\tl2.l_orderkey = l1.l_orderkey\n\t\t\tand l2.l_suppkey <> l1.l_suppkey\n\t)\n\tand not exists (\n\t\tselect\n\t\t\t*\n\t\tfrom\n\t\t\tlineitem l3\n\t\twhere\n\t\t\tl3.l_orderkey = l1.l_orderkey\n\t\t\tand l3.l_suppkey <> l1.l_suppkey\n\t\t\tand l3.l_receiptdate > l3.l_commitdate\n\t)\n\tand s_nationkey = n_nationkey\n\tand n_name = 'PERU'\ngroup by\n\ts_name\norder by\n\tnumwait desc,\n\ts_name;",
    "22": "/* TPC-H Query 22 */\n-- using 1711772513 as a seed to the RNG\n\nselect\n\tcntrycode,\n\tcount(*) as numcust,\n\tsum(c_acctbal) as totacctbal\nfrom\n\t(\n\t\tselect\n\t\t\tsubstring(c_phone from 1 for 2) as cntrycode,\n\t\t\tc_acctbal\n\t\tfrom\n\t\t\tcustomer\n\t\twhere\n\t\t\tsubstring(c_phone from 1 for 2) in\n\t\t\t\t('11', '29', '25', '30', '17', '22', '12')\n\t\t\tand c_acctbal > (\n\t\t\t\tselect\n\t\t\t\t\tavg(c_acctbal)\n\t\t\t\tfrom\n\t\t\t\t\tcustomer\n\t\t\t\twhere\n\t\t\t\t\tc_acctbal > 0.00\n\t\t\t\t\tand substring(c_phone from 1 for 2) in\n\t\t\t\t\t\t('11', '29', '25', '30', '17', '22', '12')\n\t\t\t)\n\t\t\tand not exists (\n\t\t\t\tselect\n\t\t\t\t\t*\n\t\t\t\tfrom\n\t\t\t\t\torders\n\t\t\t\twhere\n\t\t\t\t\to_custkey = c_custkey\n\t\t\t)\n\t) as custsale\ngroup by\n\tcntrycode\norder by\n\tcntrycode\nLIMIT 1;"
  },
  "tpcds": {
    "1": "/* TPC-DS Query 1 */\n\nwith customer_total_return as (\n\tselect\n\t\tsr_customer_sk as ctr_customer_sk,\n\t\tsr_store_sk as ctr_store_sk,\n\t\tsum(SR_FEE) as ctr_total_return\n\tfrom\n\t\tstore_returns,\n\t\tdate_dim\n\twhere\n\t\tsr_returned_date_sk = d_date_sk\n\t\tand d_year = 2000\n\tgroup by\n\t\tsr_customer_sk,\n\t\tsr_store_sk\n)\nselect\n\tc_customer_id\nfrom\n\tcustomer_total_return ctr1,\n\tstore,\n\tcustomer\nwhere\n\tctr1.ctr_total_return > (\n\t\tselect\n\t\t\tavg(ctr_total_return) * 1.2\n\t\tfrom\n\t\t\tcustomer_total_return ctr2\n\t\twhere\n\t\t\tctr1.ctr_store_sk = ctr2.ctr_store_sk\n\t)\n\tand s_store_sk = ctr1.ctr_store_sk\n\tand s_state = 'TN'\n\tand ctr1.ctr_customer_sk = c_customer_sk\norder by\n\tc_customer_id\nlimit 100;\n",
    "2": "/* TPC-DS Query 2 */\n\nwith wscs as (\n\tselect\n\t\tsold_date_sk,\n\t\tsales_price\n\tfrom (\n\t\tselect\n\t\t\tws_sold_date_sk as sold_date_sk,\n\t\t\tws_ext_sales_price as sales_price\n\t\tfrom web_sales\n\t\tunion all\n\t\tselect\n\t\t\tcs_sold_date_sk as sold_date_sk,\n\t\t\tcs_ext_sales_price as sales_price\n\t\tfrom catalog_sales\n\t)\n),\nwswscs as (\n\tselect\n\t\td_week_seq,\n\t\tsum(case when (d_day_name = 'Sunday') then sales_price else null end) as sun_sales,\n\t\tsum(case when (d_day_name = 'Monday') then sales_price else null end) as mon_sales,\n\t\tsum(case when (d_day_name = 'Tuesday') then sales_price else null end) as tue_sales,\n\t\tsum(case when (d_day_name = 'Wednesday') then sales_price else null end) as wed_sales,\n\t\tsum(case when (d_day_name = 'Thursday') then sales_price else null end) as thu_sales,\n\t\tsum(case when (d_day_name = 'Friday') then sales_price else null end) as fri_sales,\n\t\tsum(case when (d_day_name = 'Saturday') then sales_price else null end) as sat_sales\n\tfrom\n\t\twscs,\n\t\tdate_dim\n\twhere\n\t\td_date_sk = sold_date_sk\n\tgroup by\n\t\td_week_seq\n)\nselect\n\td_week_seq1,\n\tround(sun_sales1 / sun_sales2, 2),\n\tround(mon_sales1 / mon_sales2, 2),\n\tround(tue_sales1 / tue_sales2, 2),\n\tround(wed_sales1 / wed_sales2, 2),\n\tround(thu_sales1 / thu_sales2, 2),\n\tround(fri_sales1 / fri_sales2, 2),\n\tround(sat_sales1 / sat_sales2, 2)\nfrom (\n\tselect\n\t\twswscs.d_week_seq as d_week_seq1,\n\t\tsun_sales as sun_sales1,\n\t\tmon_sales as mon_sales1,\n\t\ttue_sales as tue_sales1,\n\t\twed_sales as wed_sales1,\n\t\tthu_sales as thu_sales1,\n\t\tfri_sales as fri_sales1,\n\t\tsat_sales as sat_sales1\n\tfrom\n\t\twswscs,\n\t\tdate_dim\n\twhere\n\t\tdate_dim.d_week_seq = wswscs.d_week_seq\n\t\tand d_year = 1998\n) y,\n(\n\tselect\n\t\twswscs.d_week_seq as d_week_seq2,\n\t\tsun_sales as sun_sales2,\n\t\tmon_sales as mon_sales2,\n\t\ttue_sales as tue_sales2,\n\t\twed_sales as wed_sales2,\n\t\tthu_sales as thu_sales2,\n\t\tfri_sales as fri_sales2,\n\t\tsat_sales as sat_sales2\n\tfrom\n\t\twswscs,\n\t\tdate_dim\n\twhere\n\t\tdate_dim.d_week_seq = wswscs.d_week_seq\n\t\tand d_year = 1998 + 1\n) z\nwhere\n\td_week_seq1 = d_week_seq2 - 53\norder by\n\td_week_seq1;\n",
    "3": "/* TPC-DS Query 3 */\n\nselect\n\tdt.d_year,\n\titem.i_brand_id as brand_id,\n\titem.i_brand as brand,\n\tsum(ss_sales_price) as sum_agg\nfrom\n\tdate_dim dt,\n\tstore_sales,\n\titem\nwhere\n\tdt.d_date_sk = store_sales.ss_sold_date_sk\n\tand store_sales.ss_item_sk = item.i_item_sk\n\tand item.i_manufact_id = 816\n\tand dt.d_moy = 11\ngroup by\n\tdt.d_year,\n\titem.i_brand,\n\titem.i_brand_id\norder by\n\tdt.d_year,\n\tsum_agg desc,\n\tbrand_id\nlimit 100;\n",
    "4": "/* TPC-DS Query 4 */\n\nwith year_total as (\n\tselect\n\t\tc_customer_id as customer_id,\n\t\tc_first_name as customer_first_name,\n\t\tc_last_name as customer_last_name,\n\t\tc_preferred_cust_flag as customer_preferred_cust_flag,\n\t\tc_birth_country as customer_birth_country,\n\t\tc_login as customer_login,\n\t\tc_email_address as customer_email_address,\n\t\td_year as dyear,\n\t\tsum(((ss_ext_list_price - ss_ext_wholesale_cost - ss_ext_discount_amt) + ss_ext_sales_price) / 2) as year_total,\n\t\t's' as sale_type\n\tfrom\n\t\tcustomer,\n\t\tstore_sales,\n\t\tdate_dim\n\twhere\n\t\tc_customer_sk = ss_customer_sk\n\t\tand ss_sold_date_sk = d_date_sk\n\tgroup by\n\t\tc_customer_id,\n\t\tc_first_name,\n\t\tc_last_name,\n\t\tc_preferred_cust_flag,\n\t\tc_birth_country,\n\t\tc_login,\n\t\tc_email_address,\n\t\td_year\n\tunion all\n\tselect\n\t\tc_customer_id as customer_id,\n\t\tc_first_name as customer_first_name,\n\t\tc_last_name as customer_last_name,\n\t\tc_preferred_cust_flag as customer_preferred_cust_flag,\n\t\tc_birth_country as customer_birth_country,\n\t\tc_login as customer_login,\n\t\tc_email_address as customer_email_address,\n\t\td_year as dyear,\n\t\tsum(((cs_ext_list_price - cs_ext_wholesale_cost - cs_ext_discount_amt) + cs_ext_sales_price) / 2) as year_total,\n\t\t'c' as sale_type\n\tfrom\n\t\tcustomer,\n\t\tcatalog_sales,\n\t\tdate_dim\n\twhere\n\t\tc_customer_sk = cs_bill_customer_sk\n\t\tand cs_sold_date_sk = d_date_sk\n\tgroup by\n\t\tc_customer_id,\n\t\tc_first_name,\n\t\tc_last_name,\n\t\tc_preferred_cust_flag,\n\t\tc_birth_country,\n\t\tc_login,\n\t\tc_email_address,\n\t\td_year\n\tunion all\n\tselect\n\t\tc_customer_id as customer_id,\n\t\tc_first_name as customer_first_name,\n\t\tc_last_name as customer_last_name,\n\t\tc_preferred_cust_flag as customer_preferred_cust_flag,\n\t\tc_birth_country as customer_birth_country,\n\t\tc_login as customer_login,\n\t\tc_email_address as customer_email_address,\n\t\td_year as dyear,\n\t\tsum(((ws_ext_list_price - ws_ext_wholesale_cost - ws_ext_discount_amt) + ws_ext_sales_price) / 2) as year_total,\n\t\t'w' as sale_type\n\tfrom\n\t\tcustomer,\n\t\tweb_sales,\n\t\tdate_dim\n\twhere\n\t\tc_customer_sk = ws_bill_customer_sk\n\t\tand ws_sold_date_sk = d_date_sk\n\tgroup by\n\t\tc_customer_id,\n\t\tc_first_name,\n\t\tc_last_name,\n\t\tc_preferred_cust_flag,\n\t\tc_birth_country,\n\t\tc_login,\n\t\tc_email_address,\n\t\td_year\n)\nselect\n\tt_s_secyear.customer_id,\n\tt_s_secyear.customer_first_name,\n\tt_s_secyear.customer_last_name,\n\tt_s_secyear.customer_birth_country\nfrom\n\tyear_total t_s_firstyear,\n\tyear_total t_s_secyear,\n\tyear_total t_c_firstyear,\n\tyear_total t_c_secyear,\n\tyear_total t_w_firstyear,\n\tyear_total t_w_secyear\nwhere\n\tt_s_secyear.customer_id = t_s_firstyear.customer_id\n\tand t_s_firstyear.customer_id = t_c_secyear.customer_id\n\tand t_s_firstyear.customer_id = t_c_firstyear.customer_id\n\tand t_s_firstyear.customer_id = t_w_firstyear.customer_id\n\tand t_s_firstyear.customer_id = t_w_secyear.customer_id\n\tand t_s_firstyear.sale_type = 's'\n\tand t_c_firstyear.sale_type = 'c'\n\tand t_w_firstyear.sale_type = 'w'\n\tand t_s_secyear.sale_type = 's'\n\tand t_c_secyear.sale_type = 'c'\n\tand t_w_secyear.sale_type = 'w'\n\tand t_s_firstyear.dyear = 1999\n\tand t_s_secyear.dyear = 1999 + 1\n\tand t_c_firstyear.dyear = 1999\n\tand t_c_secyear.dyear = 1999 + 1\n\tand t_w_firstyear.dyear = 1999\n\tand t_w_secyear.dyear = 1999 + 1\n\tand t_s_firstyear.year_total > 0\n\tand t_c_firstyear.year_total > 0\n\tand t_w_firstyear.year_total > 0\n\tand case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end >\n\t\tcase when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end\n\tand case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end >\n\t\tcase when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end\norder by\n\tt_s_secyear.customer_id,\n\tt_s_secyear.customer_first_name,\n\tt_s_secyear.customer_last_name,\n\tt_s_secyear.customer_birth_country\nlimit 100;\n",
    "5": "/* TPC-DS Query 5 */\n\nwith ssr as (\n\tselect\n\t\ts_store_id,\n\t\tsum(sales_price) as sales,\n\t\tsum(profit) as profit,\n\t\tsum(return_amt) as returns,\n\t\tsum(net_loss) as profit_loss\n\tfrom (\n\t\tselect\n\t\t\tss_store_sk as store_sk,\n\t\t\tss_sold_date_sk as date_sk,\n\t\t\tss_ext_sales_price as sales_price,\n\t\t\tss_net_profit as profit,\n\t\t\tcast(0 as decimal(7,2)) as return_amt,\n\t\t\tcast(0 as decimal(7,2)) as net_loss\n\t\tfrom store_sales\n\t\tunion all\n\t\tselect\n\t\t\tsr_store_sk as store_sk,\n\t\t\tsr_returned_date_sk as date_sk,\n\t\t\tcast(0 as decimal(7,2)) as sales_price,\n\t\t\tcast(0 as decimal(7,2)) as profit,\n\t\t\tsr_return_amt as return_amt,\n\t\t\tsr_net_loss as net_loss\n\t\tfrom store_returns\n\t) salesreturns,\n\tdate_dim,\n\tstore\n\twhere\n\t\tdate_sk = d_date_sk\n\t\tand d_date between cast('2000-08-19' as date) and (cast('2000-08-19' as date) + 14)\n\t\tand store_sk = s_store_sk\n\tgroup by s_store_id\n),\ncsr as (\n\tselect\n\t\tcp_catalog_page_id,\n\t\tsum(sales_price) as sales,\n\t\tsum(profit) as profit,\n\t\tsum(return_amt) as returns,\n\t\tsum(net_loss) as profit_loss\n\tfrom (\n\t\tselect\n\t\t\tcs_catalog_page_sk as page_sk,\n\t\t\tcs_sold_date_sk as date_sk,\n\t\t\tcs_ext_sales_price as sales_price,\n\t\t\tcs_net_profit as profit,\n\t\t\tcast(0 as decimal(7,2)) as return_amt,\n\t\t\tcast(0 as decimal(7,2)) as net_loss\n\t\tfrom catalog_sales\n\t\tunion all\n\t\tselect\n\t\t\tcr_catalog_page_sk as page_sk,\n\t\t\tcr_returned_date_sk as date_sk,\n\t\t\tcast(0 as decimal(7,2)) as sales_price,\n\t\t\tcast(0 as decimal(7,2)) as profit,\n\t\t\tcr_return_amount as return_amt,\n\t\t\tcr_net_loss as net_loss\n\t\tfrom catalog_returns\n\t) salesreturns,\n\tdate_dim,\n\tcatalog_page\n\twhere\n\t\tdate_sk = d_date_sk\n\t\tand d_date between cast('2000-08-19' as date) and (cast('2000-08-19' as date) + 14)\n\t\tand page_sk = cp_catalog_page_sk\n\tgroup by cp_catalog_page_id\n),\nwsr as (\n\tselect\n\t\tweb_site_id,\n\t\tsum(sales_price) as sales,\n\t\tsum(profit) as profit,\n\t\tsum(return_amt) as returns,\n\t\tsum(net_loss) as profit_loss\n\tfrom (\n\t\tselect\n\t\t\tws_web_site_sk as wsr_web_site_sk,\n\t\t\tws_sold_date_sk as date_sk,\n\t\t\tws_ext_sales_price as sales_price,\n\t\t\tws_net_profit as profit,\n\t\t\tcast(0 as decimal(7,2)) as return_amt,\n\t\t\tcast(0 as decimal(7,2)) as net_loss\n\t\tfrom web_sales\n\t\tunion all\n\t\tselect\n\t\t\tws_web_site_sk as wsr_web_site_sk,\n\t\t\twr_returned_date_sk as date_sk,\n\t\t\tcast(0 as decimal(7,2)) as sales_price,\n\t\t\tcast(0 as decimal(7,2)) as profit,\n\t\t\twr_return_amt as return_amt,\n\t\t\twr_net_loss as net_loss\n\t\tfrom web_returns\n\t\tleft outer join web_sales on (\n\t\t\twr_item_sk = ws_item_sk\n\t\t\tand wr_order_number = ws_order_number\n\t\t)\n\t) salesreturns,\n\tdate_dim,\n\tweb_site\n\twhere\n\t\tdate_sk = d_date_sk\n\t\tand d_date between cast('2000-08-19' as date) and (cast('2000-08-19' as date) + 14)\n\t\tand wsr_web_site_sk = web_site_sk\n\tgroup by web_site_id\n)\nselect\n\tchannel,\n\tid,\n\tsum(sales) as sales,\n\tsum(returns) as returns,\n\tsum(profit) as profit\nfrom (\n\tselect\n\t\t'store channel' as channel,\n\t\t'store' || s_store_id as id,\n\t\tsales,\n\t\treturns,\n\t\t(profit - profit_loss) as profit\n\tfrom ssr\n\tunion all\n\tselect\n\t\t'catalog channel' as channel,\n\t\t'catalog_page' || cp_catalog_page_id as id,\n\t\tsales,\n\t\treturns,\n\t\t(profit - profit_loss) as profit\n\tfrom csr\n\tunion all\n\tselect\n\t\t'web channel' as channel,\n\t\t'web_site' || web_site_id as id,\n\t\tsales,\n\t\treturns,\n\t\t(profit - profit_loss) as profit\n\tfrom wsr\n) x\ngroup by rollup (channel, id)\norder by\n\tchannel,\n\tid\nlimit 100;\n",
    "6": "/* TPC-DS Query 6 */\n\nselect\n\ta.ca_state as state,\n\tcount(*) as cnt\nfrom\n\tcustomer_address a,\n\tcustomer c,\n\tstore_sales s,\n\tdate_dim d,\n\titem i\nwhere\n\ta.ca_address_sk = c.c_current_addr_sk\n\tand c.c_customer_sk = s.ss_customer_sk\n\tand s.ss_sold_date_sk = d.d_date_sk\n\tand s.ss_item_sk = i.i_item_sk\n\tand d.d_month_seq = (\n\t\tselect\n\t\t\tdistinct d_month_seq\n\t\tfrom\n\t\t\tdate_dim\n\t\twhere\n\t\t\td_year = 2002\n\t\t\tand d_moy = 3\n\t)\n\tand i.i_current_price > 1.2 * (\n\t\tselect\n\t\t\tavg(j.i_current_price)\n\t\tfrom\n\t\t\titem j\n\t\twhere\n\t\t\tj.i_category = i.i_category\n\t)\ngroup by\n\ta.ca_state\nhaving\n\tcount(*) >= 10\norder by\n\tcnt,\n\ta.ca_state\nlimit 100;\n",
    "7": "/* TPC-DS Query 7 */\n\nselect\n\ti_item_id,\n\tavg(ss_quantity) as agg1,\n\tavg(ss_list_price) as agg2,\n\tavg(ss_coupon_amt) as agg3,\n\tavg(ss_sales_price) as agg4\nfrom\n\tstore_sales,\n\tcustomer_demographics,\n\tdate_dim,\n\titem,\n\tpromotion\nwhere\n\tss_sold_date_sk = d_date_sk\n\tand ss_item_sk = i_item_sk\n\tand ss_cdemo_sk = cd_demo_sk\n\tand ss_promo_sk = p_promo_sk\n\tand cd_gender = 'F'\n\tand cd_marital_status = 'W'\n\tand cd_education_status = 'College'\n\tand (p_channel_email = 'N' or p_channel_event = 'N')\n\tand d_year = 2001\ngroup by\n\ti_item_id\norder by\n\ti_item_id\nlimit 100;\n",
    "8": "/* TPC-DS Query 8 */\n\nselect\n\ts_store_name,\n\tsum(ss_net_profit)\nfrom\n\tstore_sales,\n\tdate_dim,\n\tstore,\n\t(\n\t\tselect\n\t\t\tca_zip\n\t\tfrom (\n\t\t\tselect\n\t\t\t\tsubstr(ca_zip, 1, 5) as ca_zip\n\t\t\tfrom\n\t\t\t\tcustomer_address\n\t\t\twhere\n\t\t\t\tsubstr(ca_zip, 1, 5) in (\n\t\t\t\t\t'47602', '16704', '35863', '28577', '83910', '36201',\n\t\t\t\t\t'58412', '48162', '28055', '41419', '80332', '38607',\n\t\t\t\t\t'77817', '24891', '16226', '18410', '21231', '59345'\n\t\t\t\t\t'13918', '51089', '20317', '17167', '54585', '67881'\n\t\t\t\t\t'78366', '47770', '18360', '51717', '73108', '14440'\n\t\t\t\t\t'21800', '89338', '45859', '65501', '34948', '25973'\n\t\t\t\t\t'73219', '25333', '17291', '10374', '18829', '60736'\n\t\t\t\t\t'82620', '41351', '52094', '19326', '25214', '54207'\n\t\t\t\t\t'40936', '21814', '79077', '25178', '75742', '77454'\n\t\t\t\t\t'30621', '89193', '27369', '41232', '48567', '83041'\n\t\t\t\t\t'71948', '37119', '68341', '14073', '16891', '62878'\n\t\t\t\t\t'49130', '19833', '24286', '27700', '40979', '50412'\n\t\t\t\t\t'81504', '94835', '84844', '71954', '39503', '57649'\n\t\t\t\t\t'18434', '24987', '12350', '86379', '27413', '44529'\n\t\t\t\t\t'98569', '16515', '27287', '24255', '21094', '16005'\n\t\t\t\t\t'56436', '91110', '68293', '56455', '54558', '10298'\n\t\t\t\t\t'83647', '32754', '27052', '51766', '19444', '13869'\n\t\t\t\t\t'45645', '94791', '57631', '20712', '37788', '41807'\n\t\t\t\t\t'46507', '21727', '71836', '81070', '50632', '88086'\n\t\t\t\t\t'63991', '20244', '31655', '51782', '29818', '63792'\n\t\t\t\t\t'68605', '94898', '36430', '57025', '20601', '82080'\n\t\t\t\t\t'33869', '22728', '35834', '29086', '92645', '98584'\n\t\t\t\t\t'98072', '11652', '78093', '57553', '43830', '71144'\n\t\t\t\t\t'53565', '18700', '90209', '71256', '38353', '54364'\n\t\t\t\t\t'28571', '96560', '57839', '56355', '50679', '45266'\n\t\t\t\t\t'84680', '34306', '34972', '48530', '30106', '15371'\n\t\t\t\t\t'92380', '84247', '92292', '68852', '13338', '34594'\n\t\t\t\t\t'82602', '70073', '98069', '85066', '47289', '11686'\n\t\t\t\t\t'98862', '26217', '47529', '63294', '51793', '35926'\n\t\t\t\t\t'24227', '14196', '24594', '32489', '99060', '49472'\n\t\t\t\t\t'43432', '49211', '14312', '88137', '47369', '56877'\n\t\t\t\t\t'20534', '81755', '15794', '12318', '21060', '73134'\n\t\t\t\t\t'41255', '63073', '81003', '73873', '66057', '51184'\n\t\t\t\t\t'51195', '45676', '92696', '70450', '90669', '98338'\n\t\t\t\t\t'25264', '38919', '59226', '58581', '60298', '17895'\n\t\t\t\t\t'19489', '52301', '80846', '95464', '68770', '51634'\n\t\t\t\t\t'19988', '18367', '18421', '11618', '67975', '25494'\n\t\t\t\t\t'41352', '95430', '15734', '62585', '97173', '33773'\n\t\t\t\t\t'10425', '75675', '53535', '17879', '41967', '12197'\n\t\t\t\t\t'67998', '79658', '59130', '72592', '14851', '43933'\n\t\t\t\t\t'68101', '50636', '25717', '71286', '24660', '58058'\n\t\t\t\t\t'72991', '95042', '15543', '33122', '69280', '11912'\n\t\t\t\t\t'59386', '27642', '65177', '17672', '33467', '64592'\n\t\t\t\t\t'36335', '54010', '18767', '63193', '42361', '49254'\n\t\t\t\t\t'33113', '33159', '36479', '59080', '11855', '81963'\n\t\t\t\t\t'31016', '49140', '29392', '41836', '32958', '53163'\n\t\t\t\t\t'13844', '73146', '23952', '65148', '93498', '14530'\n\t\t\t\t\t'46131', '58454', '13376', '13378', '83986', '12320'\n\t\t\t\t\t'17193', '59852', '46081', '98533', '52389', '13086'\n\t\t\t\t\t'68843', '31013', '13261', '60560', '13443', '45533'\n\t\t\t\t\t'83583', '11489', '58218', '19753', '22911', '25115'\n\t\t\t\t\t'86709', '27156', '32669', '13123', '51933', '39214'\n\t\t\t\t\t'41331', '66943', '14155', '69998', '49101', '70070'\n\t\t\t\t\t'35076', '14242', '73021', '59494', '15782', '29752'\n\t\t\t\t\t'37914', '74686', '83086', '34473', '15751', '81084'\n\t\t\t\t\t'49230', '91894', '60624', '17819', '28810', '63180'\n\t\t\t\t\t'56224', '39459', '55233', '75752', '43639', '55349'\n\t\t\t\t\t'86057', '62361', '50788', '31830', '58062', '18218'\n\t\t\t\t\t'85761', '60083', '45484', '21204', '90229', '70041'\n\t\t\t\t\t'41162', '35390', '16364', '39500', '68908', '26689'\n\t\t\t\t\t'52868', '81335', '40146', '11340', '61527', '61794'\n\t\t\t\t\t'71997', '30415', '59004', '29450', '58117', '69952'\n\t\t\t\t\t'33562', '83833', '27385', '61860', '96435', '48333'\n\t\t\t\t\t'23065', '32961', '84919', '61997', '99132', '22815'\n\t\t\t\t\t'56600', '68730', '48017', '95694', '32919', '88217'\n\t\t\t\t\t'27116', '28239', '58032', '18884', '16791', '21343'\n\t\t\t\t\t'97462', '18569', '75660', '15475'\n\t\t\t\t)\n\t\t\tintersect\n\t\t\tselect\n\t\t\t\tca_zip\n\t\t\tfrom (\n\t\t\t\tselect\n\t\t\t\t\tsubstr(ca_zip, 1, 5) as ca_zip,\n\t\t\t\t\tcount(*) as cnt\n\t\t\t\tfrom\n\t\t\t\t\tcustomer_address,\n\t\t\t\t\tcustomer\n\t\t\t\twhere\n\t\t\t\t\tca_address_sk = c_current_addr_sk\n\t\t\t\t\tand c_preferred_cust_flag = 'Y'\n\t\t\t\tgroup by\n\t\t\t\t\tca_zip\n\t\t\t\thaving\n\t\t\t\t\tcount(*) > 10\n\t\t\t) A1\n\t\t) A2\n\t) V1\nwhere\n\tss_store_sk = s_store_sk\n\tand ss_sold_date_sk = d_date_sk\n\tand d_qoy = 2\n\tand d_year = 1998\n\tand substr(s_zip, 1, 2) = substr(V1.ca_zip, 1, 2)\ngroup by\n\ts_store_name\norder by\n\ts_store_name\nlimit 100;\n",
    "9": "/* TPC-DS Query 9 */\n\nselect\n\tcase\n\t\twhen (\n\t\t\tselect\n\t\t\t\tcount(*)\n\t\t\tfrom\n\t\t\t\tstore_sales\n\t\t\twhere\n\t\t\t\tss_quantity between 1 and 20\n\t\t) > 1071\n\t\tthen (\n\t\t\tselect\n\t\t\t\tavg(ss_ext_tax)\n\t\t\tfrom\n\t\t\t\tstore_sales\n\t\t\twhere\n\t\t\t\tss_quantity between 1 and 20\n\t\t)\n\t\telse (\n\t\t\tselect\n\t\t\t\tavg(ss_net_paid_inc_tax)\n\t\t\tfrom\n\t\t\t\tstore_sales\n\t\t\twhere\n\t\t\t\tss_quantity between 1 and 20\n\t\t)\n\tend as bucket1,\n\tcase\n\t\twhen (\n\t\t\tselect\n\t\t\t\tcount(*)\n\t\t\tfrom\n\t\t\t\tstore_sales\n\t\t\twhere\n\t\t\t\tss_quantity between 21 and 40\n\t\t) > 39161\n\t\tthen (\n\t\t\tselect\n\t\t\t\tavg(ss_ext_tax)\n\t\t\tfrom\n\t\t\t\tstore_sales\n\t\t\twhere\n\t\t\t\tss_quantity between 21 and 40\n\t\t)\n\t\telse (\n\t\t\tselect\n\t\t\t\tavg(ss_net_paid_inc_tax)\n\t\t\tfrom\n\t\t\t\tstore_sales\n\t\t\twhere\n\t\t\t\tss_quantity between 21 and 40\n\t\t)\n\tend as bucket2,\n\tcase\n\t\twhen (\n\t\t\tselect\n\t\t\t\tcount(*)\n\t\t\tfrom\n\t\t\t\tstore_sales\n\t\t\twhere\n\t\t\t\tss_quantity between 41 and 60\n\t\t) > 29434\n\t\tthen (\n\t\t\tselect\n\t\t\t\tavg(ss_ext_tax)\n\t\t\tfrom\n\t\t\t\tstore_sales\n\t\t\twhere\n\t\t\t\tss_quantity between 41 and 60\n\t\t)\n\t\telse (\n\t\t\tselect\n\t\t\t\tavg(ss_net_paid_inc_tax)\n\t\t\tfrom\n\t\t\t\tstore_sales\n\t\t\twhere\n\t\t\t\tss_quantity between 41 and 60\n\t\t)\n\tend as bucket3,\n\tcase\n\t\twhen (\n\t\t\tselect\n\t\t\t\tcount(*)\n\t\t\tfrom\n\t\t\t\tstore_sales\n\t\t\twhere\n\t\t\t\tss_quantity between 61 and 80\n\t\t) > 6568\n\t\tthen (\n\t\t\tselect\n\t\t\t\tavg(ss_ext_tax)\n\t\t\tfrom\n\t\t\t\tstore_sales\n\t\t\twhere\n\t\t\t\tss_quantity between 61 and 80\n\t\t)\n\t\telse (\n\t\t\tselect\n\t\t\t\tavg(ss_net_paid_inc_tax)\n\t\t\tfrom\n\t\t\t\tstore_sales\n\t\t\twhere\n\t\t\t\tss_quantity between 61 and 80\n\t\t)\n\tend as bucket4,\n\tcase\n\t\twhen (\n\t\t\tselect\n\t\t\t\tcount(*)\n\t\t\tfrom\n\t\t\t\tstore_sales\n\t\t\twhere\n\t\t\t\tss_quantity between 81 and 100\n\t\t) > 21216\n\t\tthen (\n\t\t\tselect\n\t\t\t\tavg(ss_ext_tax)\n\t\t\tfrom\n\t\t\t\tstore_sales\n\t\t\twhere\n\t\t\t\tss_quantity between 81 and 100\n\t\t)\n\t\telse (\n\t\t\tselect\n\t\t\t\tavg(ss_net_paid_inc_tax)\n\t\t\tfrom\n\t\t\t\tstore_sales\n\t\t\twhere\n\t\t\t\tss_quantity between 81 and 100\n\t\t)\n\tend as bucket5\nfrom\n\treason\nwhere\n\tr_reason_sk = 1;\n",
    "10": "/* TPC-DS Query 10 */\n\nselect\n\tcd_gender,\n\tcd_marital_status,\n\tcd_education_status,\n\tcount(*) as cnt1,\n\tcd_purchase_estimate,\n\tcount(*) as cnt2,\n\tcd_credit_rating,\n\tcount(*) as cnt3,\n\tcd_dep_count,\n\tcount(*) as cnt4,\n\tcd_dep_employed_count,\n\tcount(*) as cnt5,\n\tcd_dep_college_count,\n\tcount(*) as cnt6\nfrom\n\tcustomer c,\n\tcustomer_address ca,\n\tcustomer_demographics\nwhere\n\tc.c_current_addr_sk = ca.ca_address_sk\n\tand ca_county in (\n\t\t'Fairfield County',\n\t\t'Campbell County',\n\t\t'Washtenaw County',\n\t\t'Escambia County',\n\t\t'Cleburne County'\n\t)\n\tand cd_demo_sk = c.c_current_cdemo_sk\n\tand exists (\n\t\tselect\n\t\t\t*\n\t\tfrom\n\t\t\tstore_sales,\n\t\t\tdate_dim\n\t\twhere\n\t\t\tc.c_customer_sk = ss_customer_sk\n\t\t\tand ss_sold_date_sk = d_date_sk\n\t\t\tand d_year = 2001\n\t\t\tand d_moy between 3 and 3 + 3\n\t)\n\tand (\n\t\texists (\n\t\t\tselect\n\t\t\t\t*\n\t\t\tfrom\n\t\t\t\tweb_sales,\n\t\t\t\tdate_dim\n\t\t\twhere\n\t\t\t\tc.c_customer_sk = ws_bill_customer_sk\n\t\t\t\tand ws_sold_date_sk = d_date_sk\n\t\t\t\tand d_year = 2001\n\t\t\t\tand d_moy between 3 and 3 + 3\n\t\t)\n\t\tor exists (\n\t\t\tselect\n\t\t\t\t*\n\t\t\tfrom\n\t\t\t\tcatalog_sales,\n\t\t\t\tdate_dim\n\t\t\twhere\n\t\t\t\tc.c_customer_sk = cs_ship_customer_sk\n\t\t\t\tand cs_sold_date_sk = d_date_sk\n\t\t\t\tand d_year = 2001\n\t\t\t\tand d_moy between 3 and 3 + 3\n\t\t)\n\t)\ngroup by\n\tcd_gender,\n\tcd_marital_status,\n\tcd_education_status,\n\tcd_purchase_estimate,\n\tcd_credit_rating,\n\tcd_dep_count,\n\tcd_dep_employed_count,\n\tcd_dep_college_count\norder by\n\tcd_gender,\n\tcd_marital_status,\n\tcd_education_status,\n\tcd_purchase_estimate,\n\tcd_credit_rating,\n\tcd_dep_count,\n\tcd_dep_employed_count,\n\tcd_dep_college_count\nlimit 100;\n",
    "11": "/* TPC-DS Query 11 */\n\nwith year_total as (\n\tselect\n\t\tc_customer_id as customer_id,\n\t\tc_first_name as customer_first_name,\n\t\tc_last_name as customer_last_name,\n\t\tc_preferred_cust_flag as customer_preferred_cust_flag,\n\t\tc_birth_country as customer_birth_country,\n\t\tc_login as customer_login,\n\t\tc_email_address as customer_email_address,\n\t\td_year as dyear,\n\t\tsum(ss_ext_list_price - ss_ext_discount_amt) as year_total,\n\t\t's' as sale_type\n\tfrom\n\t\tcustomer,\n\t\tstore_sales,\n\t\tdate_dim\n\twhere\n\t\tc_customer_sk = ss_customer_sk\n\t\tand ss_sold_date_sk = d_date_sk\n\tgroup by\n\t\tc_customer_id,\n\t\tc_first_name,\n\t\tc_last_name,\n\t\tc_preferred_cust_flag,\n\t\tc_birth_country,\n\t\tc_login,\n\t\tc_email_address,\n\t\td_year\n\tunion all\n\tselect\n\t\tc_customer_id as customer_id,\n\t\tc_first_name as customer_first_name,\n\t\tc_last_name as customer_last_name,\n\t\tc_preferred_cust_flag as customer_preferred_cust_flag,\n\t\tc_birth_country as customer_birth_country,\n\t\tc_login as customer_login,\n\t\tc_email_address as customer_email_address,\n\t\td_year as dyear,\n\t\tsum(ws_ext_list_price - ws_ext_discount_amt) as year_total,\n\t\t'w' as sale_type\n\tfrom\n\t\tcustomer,\n\t\tweb_sales,\n\t\tdate_dim\n\twhere\n\t\tc_customer_sk = ws_bill_customer_sk\n\t\tand ws_sold_date_sk = d_date_sk\n\tgroup by\n\t\tc_customer_id,\n\t\tc_first_name,\n\t\tc_last_name,\n\t\tc_preferred_cust_flag,\n\t\tc_birth_country,\n\t\tc_login,\n\t\tc_email_address,\n\t\td_year\n)\nselect\n\tt_s_secyear.customer_id,\n\tt_s_secyear.customer_first_name,\n\tt_s_secyear.customer_last_name,\n\tt_s_secyear.customer_email_address\nfrom\n\tyear_total t_s_firstyear,\n\tyear_total t_s_secyear,\n\tyear_total t_w_firstyear,\n\tyear_total t_w_secyear\nwhere\n\tt_s_secyear.customer_id = t_s_firstyear.customer_id\n\tand t_s_firstyear.customer_id = t_w_secyear.customer_id\n\tand t_s_firstyear.customer_id = t_w_firstyear.customer_id\n\tand t_s_firstyear.sale_type = 's'\n\tand t_w_firstyear.sale_type = 'w'\n\tand t_s_secyear.sale_type = 's'\n\tand t_w_secyear.sale_type = 'w'\n\tand t_s_firstyear.dyear = 1998\n\tand t_s_secyear.dyear = 1998 + 1\n\tand t_w_firstyear.dyear = 1998\n\tand t_w_secyear.dyear = 1998 + 1\n\tand t_s_firstyear.year_total > 0\n\tand t_w_firstyear.year_total > 0\n\tand case\n\t\twhen t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total\n\t\telse 0.0\n\tend > case\n\t\twhen t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total\n\t\telse 0.0\n\tend\norder by\n\tt_s_secyear.customer_id,\n\tt_s_secyear.customer_first_name,\n\tt_s_secyear.customer_last_name,\n\tt_s_secyear.customer_email_address\nlimit 100;\n",
    "12": "/* TPC-DS Query 12 */\n\nselect\n\ti_item_id,\n\ti_item_desc,\n\ti_category,\n\ti_class,\n\ti_current_price,\n\tsum(ws_ext_sales_price) as itemrevenue,\n\tsum(ws_ext_sales_price) * 100 / sum(sum(ws_ext_sales_price)) over (\n\t\tpartition by i_class\n\t) as revenueratio\nfrom\n\tweb_sales,\n\titem,\n\tdate_dim\nwhere\n\tws_item_sk = i_item_sk\n\tand i_category in ('Men', 'Books', 'Electronics')\n\tand ws_sold_date_sk = d_date_sk\n\tand d_date between cast('2001-06-15' as date) and (cast('2001-06-15' as date) + 30)\ngroup by\n\ti_item_id,\n\ti_item_desc,\n\ti_category,\n\ti_class,\n\ti_current_price\norder by\n\ti_category,\n\ti_class,\n\ti_item_id,\n\ti_item_desc,\n\trevenueratio\nlimit 100;\n",
    "13": "/* TPC-DS Query 13 */\n\nselect\n\tavg(ss_quantity),\n\tavg(ss_ext_sales_price),\n\tavg(ss_ext_wholesale_cost),\n\tsum(ss_ext_wholesale_cost)\nfrom\n\tstore_sales,\n\tstore,\n\tcustomer_demographics,\n\thousehold_demographics,\n\tcustomer_address,\n\tdate_dim\nwhere\n\ts_store_sk = ss_store_sk\n\tand ss_sold_date_sk = d_date_sk\n\tand d_year = 2001\n\tand (\n\t\t(\n\t\t\tss_hdemo_sk = hd_demo_sk\n\t\t\tand cd_demo_sk = ss_cdemo_sk\n\t\t\tand cd_marital_status = 'M'\n\t\t\tand cd_education_status = 'College'\n\t\t\tand ss_sales_price between 100.00 and 150.00\n\t\t\tand hd_dep_count = 3\n\t\t)\n\t\tor (\n\t\t\tss_hdemo_sk = hd_demo_sk\n\t\t\tand cd_demo_sk = ss_cdemo_sk\n\t\t\tand cd_marital_status = 'D'\n\t\t\tand cd_education_status = 'Primary'\n\t\t\tand ss_sales_price between 50.00 and 100.00\n\t\t\tand hd_dep_count = 1\n\t\t)\n\t\tor (\n\t\t\tss_hdemo_sk = hd_demo_sk\n\t\t\tand cd_demo_sk = ss_cdemo_sk\n\t\t\tand cd_marital_status = 'W'\n\t\t\tand cd_education_status = '2 yr Degree'\n\t\t\tand ss_sales_price between 150.00 and 200.00\n\t\t\tand hd_dep_count = 1\n\t\t)\n\t)\n\tand (\n\t\t(\n\t\t\tss_addr_sk = ca_address_sk\n\t\t\tand ca_country = 'United States'\n\t\t\tand ca_state in ('IL', 'TN', 'TX')\n\t\t\tand ss_net_profit between 100 and 200\n\t\t)\n\t\tor (\n\t\t\tss_addr_sk = ca_address_sk\n\t\t\tand ca_country = 'United States'\n\t\t\tand ca_state in ('WY', 'OH', 'ID')\n\t\t\tand ss_net_profit between 150 and 300\n\t\t)\n\t\tor (\n\t\t\tss_addr_sk = ca_address_sk\n\t\t\tand ca_country = 'United States'\n\t\t\tand ca_state in ('MS', 'SC', 'IA')\n\t\t\tand ss_net_profit between 50 and 250\n\t\t)\n\t);\n",
    "14": "/* TPC-DS Query 14 */\n\nwith cross_items as (\n\tselect\n\t\ti_item_sk as ss_item_sk\n\tfrom\n\t\titem,\n\t\t(\n\t\t\tselect\n\t\t\t\tiss.i_brand_id as brand_id,\n\t\t\t\tiss.i_class_id as class_id,\n\t\t\t\tiss.i_category_id as category_id\n\t\t\tfrom\n\t\t\t\tstore_sales,\n\t\t\t\titem iss,\n\t\t\t\tdate_dim d1\n\t\t\twhere\n\t\t\t\tss_item_sk = iss.i_item_sk\n\t\t\t\tand ss_sold_date_sk = d1.d_date_sk\n\t\t\t\tand d1.d_year between 1999 and 1999 + 2\n\t\t\tintersect\n\t\t\tselect\n\t\t\t\tics.i_brand_id,\n\t\t\t\tics.i_class_id,\n\t\t\t\tics.i_category_id\n\t\t\tfrom\n\t\t\t\tcatalog_sales,\n\t\t\t\titem ics,\n\t\t\t\tdate_dim d2\n\t\t\twhere\n\t\t\t\tcs_item_sk = ics.i_item_sk\n\t\t\t\tand cs_sold_date_sk = d2.d_date_sk\n\t\t\t\tand d2.d_year between 1999 and 1999 + 2\n\t\t\tintersect\n\t\t\tselect\n\t\t\t\tiws.i_brand_id,\n\t\t\t\tiws.i_class_id,\n\t\t\t\tiws.i_category_id\n\t\t\tfrom\n\t\t\t\tweb_sales,\n\t\t\t\titem iws,\n\t\t\t\tdate_dim d3\n\t\t\twhere\n\t\t\t\tws_item_sk = iws.i_item_sk\n\t\t\t\tand ws_sold_date_sk = d3.d_date_sk\n\t\t\t\tand d3.d_year between 1999 and 1999 + 2\n\t\t) x\n\twhere\n\t\ti_brand_id = brand_id\n\t\tand i_class_id = class_id\n\t\tand i_category_id = category_id\n),\navg_sales as (\n\tselect\n\t\tavg(quantity * list_price) as average_sales\n\tfrom (\n\t\tselect\n\t\t\tss_quantity as quantity,\n\t\t\tss_list_price as list_price\n\t\tfrom\n\t\t\tstore_sales,\n\t\t\tdate_dim\n\t\twhere\n\t\t\tss_sold_date_sk = d_date_sk\n\t\t\tand d_year between 1999 and 1999 + 2\n\t\tunion all\n\t\tselect\n\t\t\tcs_quantity as quantity,\n\t\t\tcs_list_price as list_price\n\t\tfrom\n\t\t\tcatalog_sales,\n\t\t\tdate_dim\n\t\twhere\n\t\t\tcs_sold_date_sk = d_date_sk\n\t\t\tand d_year between 1999 and 1999 + 2\n\t\tunion all\n\t\tselect\n\t\t\tws_quantity as quantity,\n\t\t\tws_list_price as list_price\n\t\tfrom\n\t\t\tweb_sales,\n\t\t\tdate_dim\n\t\twhere\n\t\t\tws_sold_date_sk = d_date_sk\n\t\t\tand d_year between 1999 and 1999 + 2\n\t) x\n)\nselect\n\tchannel,\n\ti_brand_id,\n\ti_class_id,\n\ti_category_id,\n\tsum(sales),\n\tsum(number_sales)\nfrom (\n\tselect\n\t\t'store' as channel,\n\t\ti_brand_id,\n\t\ti_class_id,\n\t\ti_category_id,\n\t\tsum(ss_quantity * ss_list_price) as sales,\n\t\tcount(*) as number_sales\n\tfrom\n\t\tstore_sales,\n\t\titem,\n\t\tdate_dim\n\twhere\n\t\tss_item_sk in (select ss_item_sk from cross_items)\n\t\tand ss_item_sk = i_item_sk\n\t\tand ss_sold_date_sk = d_date_sk\n\t\tand d_year = 1999 + 2\n\t\tand d_moy = 11\n\tgroup by\n\t\ti_brand_id,\n\t\ti_class_id,\n\t\ti_category_id\n\thaving\n\t\tsum(ss_quantity * ss_list_price) > (select average_sales from avg_sales)\n\tunion all\n\tselect\n\t\t'catalog' as channel,\n\t\ti_brand_id,\n\t\ti_class_id,\n\t\ti_category_id,\n\t\tsum(cs_quantity * cs_list_price) as sales,\n\t\tcount(*) as number_sales\n\tfrom\n\t\tcatalog_sales,\n\t\titem,\n\t\tdate_dim\n\twhere\n\t\tcs_item_sk in (select ss_item_sk from cross_items)\n\t\tand cs_item_sk = i_item_sk\n\t\tand cs_sold_date_sk = d_date_sk\n\t\tand d_year = 1999 + 2\n\t\tand d_moy = 11\n\tgroup by\n\t\ti_brand_id,\n\t\ti_class_id,\n\t\ti_category_id\n\thaving\n\t\tsum(cs_quantity * cs_list_price) > (select average_sales from avg_sales)\n\tunion all\n\tselect\n\t\t'web' as channel,\n\t\ti_brand_id,\n\t\ti_class_id,\n\t\ti_category_id,\n\t\tsum(ws_quantity * ws_list_price) as sales,\n\t\tcount(*) as number_sales\n\tfrom\n\t\tweb_sales,\n\t\titem,\n\t\tdate_dim\n\twhere\n\t\tws_item_sk in (select ss_item_sk from cross_items)\n\t\tand ws_item_sk = i_item_sk\n\t\tand ws_sold_date_sk = d_date_sk\n\t\tand d_year = 1999 + 2\n\t\tand d_moy = 11\n\tgroup by\n\t\ti_brand_id,\n\t\ti_class_id,\n\t\ti_category_id\n\thaving\n\t\tsum(ws_quantity * ws_list_price) > (select average_sales from avg_sales)\n) y\ngroup by\n\trollup(channel, i_brand_id, i_class_id, i_category_id)\norder by\n\tchannel,\n\ti_brand_id,\n\ti_class_id,\n\ti_category_id\nlimit 100;\n",
    "15": "/* TPC-DS Query 15 */\n\nselect\n\tca_zip,\n\tsum(cs_sales_price)\nfrom\n\tcatalog_sales,\n\tcustomer,\n\tcustomer_address,\n\tdate_dim\nwhere\n\tcs_bill_customer_sk = c_customer_sk\n\tand c_current_addr_sk = ca_address_sk\n\tand (\n\t\tsubstr(ca_zip, 1, 5) in (\n\t\t\t'85669', '86197', '88274', '83405', '86475',\n\t\t\t'85392', '85460', '80348', '81792'\n\t\t)\n\t\tor ca_state in ('CA', 'WA', 'GA')\n\t\tor cs_sales_price > 500\n\t)\n\tand cs_sold_date_sk = d_date_sk\n\tand d_qoy = 2\n\tand d_year = 2001\ngroup by\n\tca_zip\norder by\n\tca_zip\nlimit 100;\n",
    "16": "/* TPC-DS Query 16 */\n\nselect\n\tcount(distinct cs_order_number) as \"order count\",\n\tsum(cs_ext_ship_cost) as \"total shipping cost\",\n\tsum(cs_net_profit) as \"total net profit\"\nfrom\n\tcatalog_sales cs1,\n\tdate_dim,\n\tcustomer_address,\n\tcall_center\nwhere\n\td_date between '2002-4-01' and (cast('2002-4-01' as date) + 60)\n\tand cs1.cs_ship_date_sk = d_date_sk\n\tand cs1.cs_ship_addr_sk = ca_address_sk\n\tand ca_state = 'PA'\n\tand cs1.cs_call_center_sk = cc_call_center_sk\n\tand cc_county in (\n\t\t'Williamson County',\n\t\t'Williamson County',\n\t\t'Williamson County',\n\t\t'Williamson County',\n\t\t'Williamson County'\n\t)\n\tand exists (\n\t\tselect\n\t\t\t*\n\t\tfrom\n\t\t\tcatalog_sales cs2\n\t\twhere\n\t\t\tcs1.cs_order_number = cs2.cs_order_number\n\t\t\tand cs1.cs_warehouse_sk <> cs2.cs_warehouse_sk\n\t)\n\tand not exists (\n\t\tselect\n\t\t\t*\n\t\tfrom\n\t\t\tcatalog_returns cr1\n\t\twhere\n\t\t\tcs1.cs_order_number = cr1.cr_order_number\n\t)\norder by\n\tcount(distinct cs_order_number)\nlimit 100;\n",
    "17": "/* TPC-DS Query 17 */\n\nselect\n\ti_item_id,\n\ti_item_desc,\n\ts_state,\n\tcount(ss_quantity) as store_sales_quantitycount,\n\tavg(ss_quantity) as store_sales_quantityave,\n\tstddev_samp(ss_quantity) as store_sales_quantitystdev,\n\tstddev_samp(ss_quantity) / avg(ss_quantity) as store_sales_quantitycov,\n\tcount(sr_return_quantity) as store_returns_quantitycount,\n\tavg(sr_return_quantity) as store_returns_quantityave,\n\tstddev_samp(sr_return_quantity) as store_returns_quantitystdev,\n\tstddev_samp(sr_return_quantity) / avg(sr_return_quantity) as store_returns_quantitycov,\n\tcount(cs_quantity) as catalog_sales_quantitycount,\n\tavg(cs_quantity) as catalog_sales_quantityave,\n\tstddev_samp(cs_quantity) as catalog_sales_quantitystdev,\n\tstddev_samp(cs_quantity) / avg(cs_quantity) as catalog_sales_quantitycov\nfrom\n\tstore_sales,\n\tstore_returns,\n\tcatalog_sales,\n\tdate_dim d1,\n\tdate_dim d2,\n\tdate_dim d3,\n\tstore,\n\titem\nwhere\n\td1.d_quarter_name = '2001Q1'\n\tand d1.d_date_sk = ss_sold_date_sk\n\tand i_item_sk = ss_item_sk\n\tand s_store_sk = ss_store_sk\n\tand ss_customer_sk = sr_customer_sk\n\tand ss_item_sk = sr_item_sk\n\tand ss_ticket_number = sr_ticket_number\n\tand sr_returned_date_sk = d2.d_date_sk\n\tand d2.d_quarter_name in ('2001Q1', '2001Q2', '2001Q3')\n\tand sr_customer_sk = cs_bill_customer_sk\n\tand sr_item_sk = cs_item_sk\n\tand cs_sold_date_sk = d3.d_date_sk\n\tand d3.d_quarter_name in ('2001Q1', '2001Q2', '2001Q3')\ngroup by\n\ti_item_id,\n\ti_item_desc,\n\ts_state\norder by\n\ti_item_id,\n\ti_item_desc,\n\ts_state\nlimit 100;\n",
    "18": "/* TPC-DS Query 18 */\n\nselect\n\ti_item_id,\n\tca_country,\n\tca_state,\n\tca_county,\n\tavg(cast(cs_quantity as decimal(12, 2))) as agg1,\n\tavg(cast(cs_list_price as decimal(12, 2))) as agg2,\n\tavg(cast(cs_coupon_amt as decimal(12, 2))) as agg3,\n\tavg(cast(cs_sales_price as decimal(12, 2))) as agg4,\n\tavg(cast(cs_net_profit as decimal(12, 2))) as agg5,\n\tavg(cast(c_birth_year as decimal(12, 2))) as agg6,\n\tavg(cast(cd1.cd_dep_count as decimal(12, 2))) as agg7\nfrom\n\tcatalog_sales,\n\tcustomer_demographics cd1,\n\tcustomer_demographics cd2,\n\tcustomer,\n\tcustomer_address,\n\tdate_dim,\n\titem\nwhere\n\tcs_sold_date_sk = d_date_sk\n\tand cs_item_sk = i_item_sk\n\tand cs_bill_cdemo_sk = cd1.cd_demo_sk\n\tand cs_bill_customer_sk = c_customer_sk\n\tand cd1.cd_gender = 'F'\n\tand cd1.cd_education_status = 'Primary'\n\tand c_current_cdemo_sk = cd2.cd_demo_sk\n\tand c_current_addr_sk = ca_address_sk\n\tand c_birth_month in (1, 3, 7, 11, 10, 4)\n\tand d_year = 2001\n\tand ca_state in ('AL', 'MO', 'TN', 'GA', 'MT', 'IN', 'CA')\ngroup by\n\trollup(i_item_id, ca_country, ca_state, ca_county)\norder by\n\tca_country,\n\tca_state,\n\tca_county,\n\ti_item_id\nlimit 100;\n",
    "19": "/* TPC-DS Query 19 */\n\nselect\n\ti_brand_id as brand_id,\n\ti_brand as brand,\n\ti_manufact_id,\n\ti_manufact,\n\tsum(ss_ext_sales_price) as ext_price\nfrom\n\tdate_dim,\n\tstore_sales,\n\titem,\n\tcustomer,\n\tcustomer_address,\n\tstore\nwhere\n\td_date_sk = ss_sold_date_sk\n\tand ss_item_sk = i_item_sk\n\tand i_manager_id = 14\n\tand d_moy = 11\n\tand d_year = 2002\n\tand ss_customer_sk = c_customer_sk\n\tand c_current_addr_sk = ca_address_sk\n\tand substr(ca_zip, 1, 5) <> substr(s_zip, 1, 5)\n\tand ss_store_sk = s_store_sk\ngroup by\n\ti_brand,\n\ti_brand_id,\n\ti_manufact_id,\n\ti_manufact\norder by\n\text_price desc,\n\ti_brand,\n\ti_brand_id,\n\ti_manufact_id,\n\ti_manufact\nlimit 100;\n",
    "20": "/* TPC-DS Query 20 */\n\nselect\n\ti_item_id,\n\ti_item_desc,\n\ti_category,\n\ti_class,\n\ti_current_price,\n\tsum(cs_ext_sales_price) as itemrevenue,\n\tsum(cs_ext_sales_price) * 100 / sum(sum(cs_ext_sales_price)) over (\n\t\tpartition by i_class\n\t) as revenueratio\nfrom\n\tcatalog_sales,\n\titem,\n\tdate_dim\nwhere\n\tcs_item_sk = i_item_sk\n\tand i_category in ('Books', 'Music', 'Sports')\n\tand cs_sold_date_sk = d_date_sk\n\tand d_date between cast('2002-06-18' as date) and (cast('2002-06-18' as date) + 30)\ngroup by\n\ti_item_id,\n\ti_item_desc,\n\ti_category,\n\ti_class,\n\ti_current_price\norder by\n\ti_category,\n\ti_class,\n\ti_item_id,\n\ti_item_desc,\n\trevenueratio\nlimit 100;\n",
    "21": "/* TPC-DS Query 21 */\n\nselect\n\t*\nfrom (\n\tselect\n\t\tw_warehouse_name,\n\t\ti_item_id,\n\t\tsum(\n\t\t\tcase\n\t\t\t\twhen (cast(d_date as date) < cast('1999-06-22' as date)) then inv_quantity_on_hand\n\t\t\t\telse 0\n\t\t\tend\n\t\t) as inv_before,\n\t\tsum(\n\t\t\tcase\n\t\t\t\twhen (cast(d_date as date) >= cast('1999-06-22' as date)) then inv_quantity_on_hand\n\t\t\t\telse 0\n\t\t\tend\n\t\t) as inv_after\n\tfrom\n\t\tinventory,\n\t\twarehouse,\n\t\titem,\n\t\tdate_dim\n\twhere\n\t\ti_current_price between 0.99 and 1.49\n\t\tand i_item_sk = inv_item_sk\n\t\tand inv_warehouse_sk = w_warehouse_sk\n\t\tand inv_date_sk = d_date_sk\n\t\tand d_date between (cast('1999-06-22' as date) - 30) and (cast('1999-06-22' as date) + 30)\n\tgroup by\n\t\tw_warehouse_name,\n\t\ti_item_id\n) x\nwhere\n\t(case\n\t\twhen inv_before > 0 then inv_after / inv_before\n\t\telse null\n\tend) between 2.0 / 3.0 and 3.0 / 2.0\norder by\n\tw_warehouse_name,\n\ti_item_id\nlimit 100;\n",
    "22": "/* TPC-DS Query 22 */\n\nselect\n\ti_product_name,\n\ti_brand,\n\ti_class,\n\ti_category,\n\tavg(inv_quantity_on_hand) as qoh\nfrom\n\tinventory,\n\tdate_dim,\n\titem\nwhere\n\tinv_date_sk = d_date_sk\n\tand inv_item_sk = i_item_sk\n\tand d_month_seq between 1200 and 1200 + 11\ngroup by\n\trollup(i_product_name, i_brand, i_class, i_category)\norder by\n\tqoh,\n\ti_product_name,\n\ti_brand,\n\ti_class,\n\ti_category\nlimit 100;\n",

    "23": "/* TPC-DS Query 23-1 */\n\nwith frequent_ss_items as (\n\tselect\n\t\tsubstr(i_item_desc, 1, 30) as itemdesc,\n\t\ti_item_sk as item_sk,\n\t\td_date as solddate,\n\t\tcount(*) as cnt\n\tfrom\n\t\tstore_sales,\n\t\tdate_dim,\n\t\titem\n\twhere\n\t\tss_sold_date_sk = d_date_sk\n\t\tand ss_item_sk = i_item_sk\n\t\tand d_year in (2000, 2000 + 1, 2000 + 2, 2000 + 3)\n\tgroup by\n\t\tsubstr(i_item_desc, 1, 30),\n\t\ti_item_sk,\n\t\td_date\n\thaving\n\t\tcount(*) > 4\n),\nmax_store_sales as (\n\tselect\n\t\tmax(csales) as tpcds_cmax\n\tfrom (\n\t\tselect\n\t\t\tc_customer_sk,\n\t\t\tsum(ss_quantity * ss_sales_price) as csales\n\t\tfrom\n\t\t\tstore_sales,\n\t\t\tcustomer,\n\t\t\tdate_dim\n\t\twhere\n\t\t\tss_customer_sk = c_customer_sk\n\t\t\tand ss_sold_date_sk = d_date_sk\n\t\t\tand d_year in (2000, 2000 + 1, 2000 + 2, 2000 + 3)\n\t\tgroup by\n\t\t\tc_customer_sk\n\t)\n),\nbest_ss_customer as (\n\tselect\n\t\tc_customer_sk,\n\t\tsum(ss_quantity * ss_sales_price) as ssales\n\tfrom\n\t\tstore_sales,\n\t\tcustomer\n\twhere\n\t\tss_customer_sk = c_customer_sk\n\tgroup by\n\t\tc_customer_sk\n\thaving\n\t\tsum(ss_quantity * ss_sales_price) > (95 / 100.0) * (select tpcds_cmax from max_store_sales)\n)\nselect\n\tsum(sales)\nfrom (\n\tselect\n\t\tcs_quantity * cs_list_price as sales\n\tfrom\n\t\tcatalog_sales,\n\t\tdate_dim\n\twhere\n\t\td_year = 2000\n\t\tand d_moy = 7\n\t\tand cs_sold_date_sk = d_date_sk\n\t\tand cs_item_sk in (select item_sk from frequent_ss_items)\n\t\tand cs_bill_customer_sk in (select c_customer_sk from best_ss_customer)\n\tunion all\n\tselect\n\t\tws_quantity * ws_list_price as sales\n\tfrom\n\t\tweb_sales,\n\t\tdate_dim\n\twhere\n\t\td_year = 2000\n\t\tand d_moy = 7\n\t\tand ws_sold_date_sk = d_date_sk\n\t\tand ws_item_sk in (select item_sk from frequent_ss_items)\n\t\tand ws_bill_customer_sk in (select c_customer_sk from best_ss_customer)\n) x\nlimit 100;\n",
    "24": "/* TPC-DS Query 23-2 */\n\nwith frequent_ss_items as (\n\tselect\n\t\tsubstr(i_item_desc, 1, 30) as itemdesc,\n\t\ti_item_sk as item_sk,\n\t\td_date as solddate,\n\t\tcount(*) as cnt\n\tfrom\n\t\tstore_sales,\n\t\tdate_dim,\n\t\titem\n\twhere\n\t\tss_sold_date_sk = d_date_sk\n\t\tand ss_item_sk = i_item_sk\n\t\tand d_year in (2000, 2000 + 1, 2000 + 2, 2000 + 3)\n\tgroup by\n\t\tsubstr(i_item_desc, 1, 30),\n\t\ti_item_sk,\n\t\td_date\n\thaving\n\t\tcount(*) > 4\n),\nmax_store_sales as (\n\tselect\n\t\tmax(csales) as tpcds_cmax\n\tfrom (\n\t\tselect\n\t\t\tc_customer_sk,\n\t\t\tsum(ss_quantity * ss_sales_price) as csales\n\t\tfrom\n\t\t\tstore_sales,\n\t\t\tcustomer,\n\t\t\tdate_dim\n\t\twhere\n\t\t\tss_customer_sk = c_customer_sk\n\t\t\tand ss_sold_date_sk = d_date_sk\n\t\t\tand d_year in (2000, 2000 + 1, 2000 + 2, 2000 + 3)\n\t\tgroup by\n\t\t\tc_customer_sk\n\t)\n),\nbest_ss_customer as (\n\tselect\n\t\tc_customer_sk,\n\t\tsum(ss_quantity * ss_sales_price) as ssales\n\tfrom\n\t\tstore_sales,\n\t\tcustomer\n\twhere\n\t\tss_customer_sk = c_customer_sk\n\tgroup by\n\t\tc_customer_sk\n\thaving\n\t\tsum(ss_quantity * ss_sales_price) > (95 / 100.0) * (select tpcds_cmax from max_store_sales)\n)\nselect\n\tc_last_name,\n\tc_first_name,\n\tsales\nfrom (\n\tselect\n\t\tc_last_name,\n\t\tc_first_name,\n\t\tsum(cs_quantity * cs_list_price) as sales\n\tfrom\n\t\tcatalog_sales,\n\t\tcustomer,\n\t\tdate_dim\n\twhere\n\t\td_year = 2000\n\t\tand d_moy = 7\n\t\tand cs_sold_date_sk = d_date_sk\n\t\tand cs_item_sk in (select item_sk from frequent_ss_items)\n\t\tand cs_bill_customer_sk in (select c_customer_sk from best_ss_customer)\n\t\tand cs_bill_customer_sk = c_customer_sk\n\tgroup by\n\t\tc_last_name,\n\t\tc_first_name\n\tunion all\n\tselect\n\t\tc_last_name,\n\t\tc_first_name,\n\t\tsum(ws_quantity * ws_list_price) as sales\n\tfrom\n\t\tweb_sales,\n\t\tcustomer,\n\t\tdate_dim\n\twhere\n\t\td_year = 2000\n\t\tand d_moy = 7\n\t\tand ws_sold_date_sk = d_date_sk\n\t\tand ws_item_sk in (select item_sk from frequent_ss_items)\n\t\tand ws_bill_customer_sk in (select c_customer_sk from best_ss_customer)\n\t\tand ws_bill_customer_sk = c_customer_sk\n\tgroup by\n\t\tc_last_name,\n\t\tc_first_name\n) y\norder by\n\tc_last_name,\n\tc_first_name,\n\tsales\nlimit 100;\n",

    "25": "/* TPC-DS Query 24-1 */\n\nwith ssales as (\n\tselect\n\t\tc_last_name,\n\t\tc_first_name,\n\t\ts_store_name,\n\t\tca_state,\n\t\ts_state,\n\t\ti_color,\n\t\ti_current_price,\n\t\ti_manager_id,\n\t\ti_units,\n\t\ti_size,\n\t\tsum(ss_net_paid) as netpaid\n\tfrom\n\t\tstore_sales,\n\t\tstore_returns,\n\t\tstore,\n\t\titem,\n\t\tcustomer,\n\t\tcustomer_address\n\twhere\n\t\tss_ticket_number = sr_ticket_number\n\t\tand ss_item_sk = sr_item_sk\n\t\tand ss_customer_sk = c_customer_sk\n\t\tand ss_item_sk = i_item_sk\n\t\tand ss_store_sk = s_store_sk\n\t\tand c_current_addr_sk = ca_address_sk\n\t\tand c_birth_country <> upper(ca_country)\n\t\tand s_zip = ca_zip\n\t\tand s_market_id = 5\n\tgroup by\n\t\tc_last_name,\n\t\tc_first_name,\n\t\ts_store_name,\n\t\tca_state,\n\t\ts_state,\n\t\ti_color,\n\t\ti_current_price,\n\t\ti_manager_id,\n\t\ti_units,\n\t\ti_size\n)\nselect\n\tc_last_name,\n\tc_first_name,\n\ts_store_name,\n\tsum(netpaid) as paid\nfrom\n\tssales\nwhere\n\ti_color = 'aquamarine'\ngroup by\n\tc_last_name,\n\tc_first_name,\n\ts_store_name\nhaving\n\tsum(netpaid) > (\n\t\tselect\n\t\t\t0.05 * avg(netpaid)\n\t\tfrom\n\t\t\tssales\n\t)\norder by\n\tc_last_name,\n\tc_first_name,\n\ts_store_name;\n",
    "26": "/* TPC-DS Query 24-2 */\n\nwith ssales as (\n\tselect\n\t\tc_last_name,\n\t\tc_first_name,\n\t\ts_store_name,\n\t\tca_state,\n\t\ts_state,\n\t\ti_color,\n\t\ti_current_price,\n\t\ti_manager_id,\n\t\ti_units,\n\t\ti_size,\n\t\tsum(ss_net_paid) as netpaid\n\tfrom\n\t\tstore_sales,\n\t\tstore_returns,\n\t\tstore,\n\t\titem,\n\t\tcustomer,\n\t\tcustomer_address\n\twhere\n\t\tss_ticket_number = sr_ticket_number\n\t\tand ss_item_sk = sr_item_sk\n\t\tand ss_customer_sk = c_customer_sk\n\t\tand ss_item_sk = i_item_sk\n\t\tand ss_store_sk = s_store_sk\n\t\tand c_current_addr_sk = ca_address_sk\n\t\tand c_birth_country <> upper(ca_country)\n\t\tand s_zip = ca_zip\n\t\tand s_market_id = 5\n\tgroup by\n\t\tc_last_name,\n\t\tc_first_name,\n\t\ts_store_name,\n\t\tca_state,\n\t\ts_state,\n\t\ti_color,\n\t\ti_current_price,\n\t\ti_manager_id,\n\t\ti_units,\n\t\ti_size\n)\nselect\n\tc_last_name,\n\tc_first_name,\n\ts_store_name,\n\tsum(netpaid) as paid\nfrom\n\tssales\nwhere\n\ti_color = 'seashell'\ngroup by\n\tc_last_name,\n\tc_first_name,\n\ts_store_name\nhaving\n\tsum(netpaid) > (\n\t\tselect\n\t\t\t0.05 * avg(netpaid)\n\t\tfrom\n\t\t\tssales\n\t)\norder by\n\tc_last_name,\n\tc_first_name,\n\ts_store_name;\n",

    "27": "/* TPC-DS Query 25 */\n\nselect\n\ti_item_id,\n\ti_item_desc,\n\ts_store_id,\n\ts_store_name,\n\tmax(ss_net_profit) as store_sales_profit,\n\tmax(sr_net_loss) as store_returns_loss,\n\tmax(cs_net_profit) as catalog_sales_profit\nfrom\n\tstore_sales,\n\tstore_returns,\n\tcatalog_sales,\n\tdate_dim d1,\n\tdate_dim d2,\n\tdate_dim d3,\n\tstore,\n\titem\nwhere\n\td1.d_moy = 4\n\tand d1.d_year = 1999\n\tand d1.d_date_sk = ss_sold_date_sk\n\tand i_item_sk = ss_item_sk\n\tand s_store_sk = ss_store_sk\n\tand ss_customer_sk = sr_customer_sk\n\tand ss_item_sk = sr_item_sk\n\tand ss_ticket_number = sr_ticket_number\n\tand sr_returned_date_sk = d2.d_date_sk\n\tand d2.d_moy between 4 and 10\n\tand d2.d_year = 1999\n\tand sr_customer_sk = cs_bill_customer_sk\n\tand sr_item_sk = cs_item_sk\n\tand cs_sold_date_sk = d3.d_date_sk\n\tand d3.d_moy between 4 and 10\n\tand d3.d_year = 1999\ngroup by\n\ti_item_id,\n\ti_item_desc,\n\ts_store_id,\n\ts_store_name\norder by\n\ti_item_id,\n\ti_item_desc,\n\ts_store_id,\n\ts_store_name\nlimit 100;\n",
    "28": "/* TPC-DS Query 26 */\n\nselect\n\ti_item_id,\n\tavg(cs_quantity) as agg1,\n\tavg(cs_list_price) as agg2,\n\tavg(cs_coupon_amt) as agg3,\n\tavg(cs_sales_price) as agg4\nfrom\n\tcatalog_sales,\n\tcustomer_demographics,\n\tdate_dim,\n\titem,\n\tpromotion\nwhere\n\tcs_sold_date_sk = d_date_sk\n\tand cs_item_sk = i_item_sk\n\tand cs_bill_cdemo_sk = cd_demo_sk\n\tand cs_promo_sk = p_promo_sk\n\tand cd_gender = 'M'\n\tand cd_marital_status = 'W'\n\tand cd_education_status = 'Unknown'\n\tand (p_channel_email = 'N' or p_channel_event = 'N')\n\tand d_year = 2002\ngroup by\n\ti_item_id\norder by\n\ti_item_id\nlimit 100;\n",
    "29": "/* TPC-DS Query 27 */\n\nselect\n\ti_item_id,\n\ts_state,\n\tgrouping(s_state) as g_state,\n\tavg(ss_quantity) as agg1,\n\tavg(ss_list_price) as agg2,\n\tavg(ss_coupon_amt) as agg3,\n\tavg(ss_sales_price) as agg4\nfrom\n\tstore_sales,\n\tcustomer_demographics,\n\tdate_dim,\n\tstore,\n\titem\nwhere\n\tss_sold_date_sk = d_date_sk\n\tand ss_item_sk = i_item_sk\n\tand ss_store_sk = s_store_sk\n\tand ss_cdemo_sk = cd_demo_sk\n\tand cd_gender = 'M'\n\tand cd_marital_status = 'W'\n\tand cd_education_status = 'Secondary'\n\tand d_year = 1999\n\tand s_state in ('TN', 'TN', 'TN', 'TN', 'TN', 'TN')\ngroup by\n\trollup(i_item_id, s_state)\norder by\n\ti_item_id,\n\ts_state\nlimit 100;\n",
    "30": "/* TPC-DS Query 28 */\n\nselect\n\t*\nfrom (\n\tselect\n\t\tavg(ss_list_price) as B1_LP,\n\t\tcount(ss_list_price) as B1_CNT,\n\t\tcount(distinct ss_list_price) as B1_CNTD\n\tfrom\n\t\tstore_sales\n\twhere\n\t\tss_quantity between 0 and 5\n\t\tand (\n\t\t\tss_list_price between 107 and 107 + 10\n\t\t\tor ss_coupon_amt between 1319 and 1319 + 1000\n\t\t\tor ss_wholesale_cost between 60 and 60 + 20\n\t\t)\n) B1,\n(\n\tselect\n\t\tavg(ss_list_price) as B2_LP,\n\t\tcount(ss_list_price) as B2_CNT,\n\t\tcount(distinct ss_list_price) as B2_CNTD\n\tfrom\n\t\tstore_sales\n\twhere\n\t\tss_quantity between 6 and 10\n\t\tand (\n\t\t\tss_list_price between 23 and 23 + 10\n\t\t\tor ss_coupon_amt between 825 and 825 + 1000\n\t\t\tor ss_wholesale_cost between 43 and 43 + 20\n\t\t)\n) B2,\n(\n\tselect\n\t\tavg(ss_list_price) as B3_LP,\n\t\tcount(ss_list_price) as B3_CNT,\n\t\tcount(distinct ss_list_price) as B3_CNTD\n\tfrom\n\t\tstore_sales\n\twhere\n\t\tss_quantity between 11 and 15\n\t\tand (\n\t\t\tss_list_price between 74 and 74 + 10\n\t\t\tor ss_coupon_amt between 4381 and 4381 + 1000\n\t\t\tor ss_wholesale_cost between 57 and 57 + 20\n\t\t)\n) B3,\n(\n\tselect\n\t\tavg(ss_list_price) as B4_LP,\n\t\tcount(ss_list_price) as B4_CNT,\n\t\tcount(distinct ss_list_price) as B4_CNTD\n\tfrom\n\t\tstore_sales\n\twhere\n\t\tss_quantity between 16 and 20\n\t\tand (\n\t\t\tss_list_price between 89 and 89 + 10\n\t\t\tor ss_coupon_amt between 3117 and 3117 + 1000\n\t\t\tor ss_wholesale_cost between 68 and 68 + 20\n\t\t)\n) B4,\n(\n\tselect\n\t\tavg(ss_list_price) as B5_LP,\n\t\tcount(ss_list_price) as B5_CNT,\n\t\tcount(distinct ss_list_price) as B5_CNTD\n\tfrom\n\t\tstore_sales\n\twhere\n\t\tss_quantity between 21 and 25\n\t\tand (\n\t\t\tss_list_price between 58 and 58 + 10\n\t\t\tor ss_coupon_amt between 9402 and 9402 + 1000\n\t\t\tor ss_wholesale_cost between 38 and 38 + 20\n\t\t)\n) B5,\n(\n\tselect\n\t\tavg(ss_list_price) as B6_LP,\n\t\tcount(ss_list_price) as B6_CNT,\n\t\tcount(distinct ss_list_price) as B6_CNTD\n\tfrom\n\t\tstore_sales\n\twhere\n\t\tss_quantity between 26 and 30\n\t\tand (\n\t\t\tss_list_price between 64 and 64 + 10\n\t\t\tor ss_coupon_amt between 5792 and 5792 + 1000\n\t\t\tor ss_wholesale_cost between 73 and 73 + 20\n\t\t)\n) B6\nlimit 100;\n",
    "31": "/* TPC-DS Query 29 */\n\nselect\n\ti_item_id,\n\ti_item_desc,\n\ts_store_id,\n\ts_store_name,\n\tmax(ss_quantity) as store_sales_quantity,\n\tmax(sr_return_quantity) as store_returns_quantity,\n\tmax(cs_quantity) as catalog_sales_quantity\nfrom\n\tstore_sales,\n\tstore_returns,\n\tcatalog_sales,\n\tdate_dim d1,\n\tdate_dim d2,\n\tdate_dim d3,\n\tstore,\n\titem\nwhere\n\td1.d_moy = 4\n\tand d1.d_year = 1998\n\tand d1.d_date_sk = ss_sold_date_sk\n\tand i_item_sk = ss_item_sk\n\tand s_store_sk = ss_store_sk\n\tand ss_customer_sk = sr_customer_sk\n\tand ss_item_sk = sr_item_sk\n\tand ss_ticket_number = sr_ticket_number\n\tand sr_returned_date_sk = d2.d_date_sk\n\tand d2.d_moy between 4 and 4 + 3\n\tand d2.d_year = 1998\n\tand sr_customer_sk = cs_bill_customer_sk\n\tand sr_item_sk = cs_item_sk\n\tand cs_sold_date_sk = d3.d_date_sk\n\tand d3.d_year in (1998, 1998 + 1, 1998 + 2)\ngroup by\n\ti_item_id,\n\ti_item_desc,\n\ts_store_id,\n\ts_store_name\norder by\n\ti_item_id,\n\ti_item_desc,\n\ts_store_id,\n\ts_store_name\nlimit 100;\n",
    "32": "/* TPC-DS Query 30 */\n\nwith customer_total_return as (\n\tselect\n\t\twr_returning_customer_sk as ctr_customer_sk,\n\t\tca_state as ctr_state,\n\t\tsum(wr_return_amt) as ctr_total_return\n\tfrom\n\t\tweb_returns,\n\t\tdate_dim,\n\t\tcustomer_address\n\twhere\n\t\twr_returned_date_sk = d_date_sk\n\t\tand d_year = 2000\n\t\tand wr_returning_addr_sk = ca_address_sk\n\tgroup by\n\t\twr_returning_customer_sk,\n\t\tca_state\n)\nselect\n\tc_customer_id,\n\tc_salutation,\n\tc_first_name,\n\tc_last_name,\n\tc_preferred_cust_flag,\n\tc_birth_day,\n\tc_birth_month,\n\tc_birth_year,\n\tc_birth_country,\n\tc_login,\n\tc_email_address,\n\tc_last_review_date,\n\tctr_total_return\nfrom\n\tcustomer_total_return ctr1,\n\tcustomer_address,\n\tcustomer\nwhere\n\tctr1.ctr_total_return > (\n\t\tselect\n\t\t\tavg(ctr_total_return) * 1.2\n\t\tfrom\n\t\t\tcustomer_total_return ctr2\n\t\twhere\n\t\t\tctr1.ctr_state = ctr2.ctr_state\n\t)\n\tand ca_address_sk = c_current_addr_sk\n\tand ca_state = 'AR'\n\tand ctr1.ctr_customer_sk = c_customer_sk\norder by\n\tc_customer_id,\n\tc_salutation,\n\tc_first_name,\n\tc_last_name,\n\tc_preferred_cust_flag,\n\tc_birth_day,\n\tc_birth_month,\n\tc_birth_year,\n\tc_birth_country,\n\tc_login,\n\tc_email_address,\n\tc_last_review_date,\n\tctr_total_return\nlimit 100;\n",
    "33": "/* TPC-DS Query 31 */\n\nwith ss as (\n\tselect\n\t\tca_county,\n\t\td_qoy,\n\t\td_year,\n\t\tsum(ss_ext_sales_price) as store_sales\n\tfrom\n\t\tstore_sales,\n\t\tdate_dim,\n\t\tcustomer_address\n\twhere\n\t\tss_sold_date_sk = d_date_sk\n\t\tand ss_addr_sk = ca_address_sk\n\tgroup by\n\t\tca_county,\n\t\td_qoy,\n\t\td_year\n),\nws as (\n\tselect\n\t\tca_county,\n\t\td_qoy,\n\t\td_year,\n\t\tsum(ws_ext_sales_price) as web_sales\n\tfrom\n\t\tweb_sales,\n\t\tdate_dim,\n\t\tcustomer_address\n\twhere\n\t\tws_sold_date_sk = d_date_sk\n\t\tand ws_bill_addr_sk = ca_address_sk\n\tgroup by\n\t\tca_county,\n\t\td_qoy,\n\t\td_year\n)\nselect\n\tss1.ca_county,\n\tss1.d_year,\n\tws2.web_sales / ws1.web_sales as web_q1_q2_increase,\n\tss2.store_sales / ss1.store_sales as store_q1_q2_increase,\n\tws3.web_sales / ws2.web_sales as web_q2_q3_increase,\n\tss3.store_sales / ss2.store_sales as store_q2_q3_increase\nfrom\n\tss ss1,\n\tss ss2,\n\tss ss3,\n\tws ws1,\n\tws ws2,\n\tws ws3\nwhere\n\tss1.d_qoy = 1\n\tand ss1.d_year = 1999\n\tand ss1.ca_county = ss2.ca_county\n\tand ss2.d_qoy = 2\n\tand ss2.d_year = 1999\n\tand ss2.ca_county = ss3.ca_county\n\tand ss3.d_qoy = 3\n\tand ss3.d_year = 1999\n\tand ss1.ca_county = ws1.ca_county\n\tand ws1.d_qoy = 1\n\tand ws1.d_year = 1999\n\tand ws1.ca_county = ws2.ca_county\n\tand ws2.d_qoy = 2\n\tand ws2.d_year = 1999\n\tand ws1.ca_county = ws3.ca_county\n\tand ws3.d_qoy = 3\n\tand ws3.d_year = 1999\n\tand case when ws1.web_sales > 0 then ws2.web_sales / ws1.web_sales else null end > case when ss1.store_sales > 0 then ss2.store_sales / ss1.store_sales else null end\n\tand case when ws2.web_sales > 0 then ws3.web_sales / ws2.web_sales else null end > case when ss2.store_sales > 0 then ss3.store_sales / ss2.store_sales else null end\norder by\n\tstore_q2_q3_increase;\n",
    "34": "/* TPC-DS Query 32 */\n\nselect\n\tsum(cs_ext_discount_amt) as \"excess discount amount\"\nfrom\n\tcatalog_sales,\n\titem,\n\tdate_dim\nwhere\n\ti_manufact_id = 722\n\tand i_item_sk = cs_item_sk\n\tand d_date between '2001-03-09' and (cast('2001-03-09' as date) + 90)\n\tand d_date_sk = cs_sold_date_sk\n\tand cs_ext_discount_amt > (\n\t\tselect\n\t\t\t1.3 * avg(cs_ext_discount_amt)\n\t\tfrom\n\t\t\tcatalog_sales,\n\t\t\tdate_dim\n\t\twhere\n\t\t\tcs_item_sk = i_item_sk\n\t\t\tand d_date between '2001-03-09' and (cast('2001-03-09' as date) + 90)\n\t\t\tand d_date_sk = cs_sold_date_sk\n\t)\nlimit 100;\n",
    "35": "/* TPC-DS Query 33 */\n\nwith ss as (\n\tselect\n\t\ti_manufact_id,\n\t\tsum(ss_ext_sales_price) as total_sales\n\tfrom\n\t\tstore_sales,\n\t\tdate_dim,\n\t\tcustomer_address,\n\t\titem\n\twhere\n\t\ti_manufact_id in (\n\t\t\tselect\n\t\t\t\ti_manufact_id\n\t\t\tfrom\n\t\t\t\titem\n\t\t\twhere\n\t\t\t\ti_category in ('Books')\n\t\t)\n\t\tand ss_item_sk = i_item_sk\n\t\tand ss_sold_date_sk = d_date_sk\n\t\tand d_year = 2001\n\t\tand d_moy = 3\n\t\tand ss_addr_sk = ca_address_sk\n\t\tand ca_gmt_offset = -5\n\tgroup by\n\t\ti_manufact_id\n),\ncs as (\n\tselect\n\t\ti_manufact_id,\n\t\tsum(cs_ext_sales_price) as total_sales\n\tfrom\n\t\tcatalog_sales,\n\t\tdate_dim,\n\t\tcustomer_address,\n\t\titem\n\twhere\n\t\ti_manufact_id in (\n\t\t\tselect\n\t\t\t\ti_manufact_id\n\t\t\tfrom\n\t\t\t\titem\n\t\t\twhere\n\t\t\t\ti_category in ('Books')\n\t\t)\n\t\tand cs_item_sk = i_item_sk\n\t\tand cs_sold_date_sk = d_date_sk\n\t\tand d_year = 2001\n\t\tand d_moy = 3\n\t\tand cs_bill_addr_sk = ca_address_sk\n\t\tand ca_gmt_offset = -5\n\tgroup by\n\t\ti_manufact_id\n),\nws as (\n\tselect\n\t\ti_manufact_id,\n\t\tsum(ws_ext_sales_price) as total_sales\n\tfrom\n\t\tweb_sales,\n\t\tdate_dim,\n\t\tcustomer_address,\n\t\titem\n\twhere\n\t\ti_manufact_id in (\n\t\t\tselect\n\t\t\t\ti_manufact_id\n\t\t\tfrom\n\t\t\t\titem\n\t\t\twhere\n\t\t\t\ti_category in ('Books')\n\t\t)\n\t\tand ws_item_sk = i_item_sk\n\t\tand ws_sold_date_sk = d_date_sk\n\t\tand d_year = 2001\n\t\tand d_moy = 3\n\t\tand ws_bill_addr_sk = ca_address_sk\n\t\tand ca_gmt_offset = -5\n\tgroup by\n\t\ti_manufact_id\n)\nselect\n\ti_manufact_id,\n\tsum(total_sales) as total_sales\nfrom (\n\tselect * from ss\n\tunion all\n\tselect * from cs\n\tunion all\n\tselect * from ws\n) tmp1\ngroup by\n\ti_manufact_id\norder by\n\ttotal_sales\nlimit 100;\n",
    "36": "/* TPC-DS Query 34 */\n\nselect\n\tc_last_name,\n\tc_first_name,\n\tc_salutation,\n\tc_preferred_cust_flag,\n\tss_ticket_number,\n\tcnt\nfrom (\n\tselect\n\t\tss_ticket_number,\n\t\tss_customer_sk,\n\t\tcount(*) as cnt\n\tfrom\n\t\tstore_sales,\n\t\tdate_dim,\n\t\tstore,\n\t\thousehold_demographics\n\twhere\n\t\tstore_sales.ss_sold_date_sk = date_dim.d_date_sk\n\t\tand store_sales.ss_store_sk = store.s_store_sk\n\t\tand store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n\t\tand (\n\t\t\tdate_dim.d_dom between 1 and 3\n\t\t\tor date_dim.d_dom between 25 and 28\n\t\t)\n\t\tand (\n\t\t\thousehold_demographics.hd_buy_potential = '1001-5000'\n\t\t\tor household_demographics.hd_buy_potential = '0-500'\n\t\t)\n\t\tand household_demographics.hd_vehicle_count > 0\n\t\tand (\n\t\t\tcase\n\t\t\t\twhen household_demographics.hd_vehicle_count > 0\n\t\t\t\tthen household_demographics.hd_dep_count / household_demographics.hd_vehicle_count\n\t\t\t\telse null\n\t\t\tend\n\t\t) > 1.2\n\t\tand date_dim.d_year in (2000, 2000 + 1, 2000 + 2)\n\t\tand store.s_county in (\n\t\t\t'Williamson County',\n\t\t\t'Williamson County',\n\t\t\t'Williamson County',\n\t\t\t'Williamson County',\n\t\t\t'Williamson County',\n\t\t\t'Williamson County',\n\t\t\t'Williamson County',\n\t\t\t'Williamson County'\n\t\t)\n\tgroup by\n\t\tss_ticket_number,\n\t\tss_customer_sk\n) dn,\ncustomer\nwhere\n\tss_customer_sk = c_customer_sk\n\tand cnt between 15 and 20\norder by\n\tc_last_name,\n\tc_first_name,\n\tc_salutation,\n\tc_preferred_cust_flag desc,\n\tss_ticket_number;\n",
    "37": "/* TPC-DS Query 35 */\n\nselect\n\tca_state,\n\tcd_gender,\n\tcd_marital_status,\n\tcd_dep_count,\n\tcount(*) as cnt1,\n\tavg(cd_dep_count),\n\tstddev_samp(cd_dep_count),\n\tsum(cd_dep_count),\n\tcd_dep_employed_count,\n\tcount(*) as cnt2,\n\tavg(cd_dep_employed_count),\n\tstddev_samp(cd_dep_employed_count),\n\tsum(cd_dep_employed_count),\n\tcd_dep_college_count,\n\tcount(*) as cnt3,\n\tavg(cd_dep_college_count),\n\tstddev_samp(cd_dep_college_count),\n\tsum(cd_dep_college_count)\nfrom\n\tcustomer c,\n\tcustomer_address ca,\n\tcustomer_demographics\nwhere\n\tc.c_current_addr_sk = ca.ca_address_sk\n\tand cd_demo_sk = c.c_current_cdemo_sk\n\tand exists (\n\t\tselect\n\t\t\t*\n\t\tfrom\n\t\t\tstore_sales,\n\t\t\tdate_dim\n\t\twhere\n\t\t\tc.c_customer_sk = ss_customer_sk\n\t\t\tand ss_sold_date_sk = d_date_sk\n\t\t\tand d_year = 1999\n\t\t\tand d_qoy < 4\n\t)\n\tand (\n\t\texists (\n\t\t\tselect\n\t\t\t\t*\n\t\t\tfrom\n\t\t\t\tweb_sales,\n\t\t\t\tdate_dim\n\t\t\twhere\n\t\t\t\tc.c_customer_sk = ws_bill_customer_sk\n\t\t\t\tand ws_sold_date_sk = d_date_sk\n\t\t\t\tand d_year = 1999\n\t\t\t\tand d_qoy < 4\n\t\t)\n\t\tor exists (\n\t\t\tselect\n\t\t\t\t*\n\t\t\tfrom\n\t\t\t\tcatalog_sales,\n\t\t\t\tdate_dim\n\t\t\twhere\n\t\t\t\tc.c_customer_sk = cs_ship_customer_sk\n\t\t\t\tand cs_sold_date_sk = d_date_sk\n\t\t\t\tand d_year = 1999\n\t\t\t\tand d_qoy < 4\n\t\t)\n\t)\ngroup by\n\tca_state,\n\tcd_gender,\n\tcd_marital_status,\n\tcd_dep_count,\n\tcd_dep_employed_count,\n\tcd_dep_college_count\norder by\n\tca_state,\n\tcd_gender,\n\tcd_marital_status,\n\tcd_dep_count,\n\tcd_dep_employed_count,\n\tcd_dep_college_count\nlimit 100;\n",
    "38": "/* TPC-DS Query 36 */\n\nselect\n\t*\nfrom (\n\tselect\n\t\tsum(ss_net_profit) / sum(ss_ext_sales_price) as gross_margin,\n\t\ti_category,\n\t\ti_class,\n\t\tgrouping(i_category) + grouping(i_class) as lochierarchy,\n\t\trank() over (\n\t\t\tpartition by grouping(i_category) + grouping(i_class),\n\t\t\tcase when grouping(i_class) = 0 then i_category end\n\t\t\torder by sum(ss_net_profit) / sum(ss_ext_sales_price) asc\n\t\t) as rank_within_parent\n\tfrom\n\t\tstore_sales,\n\t\tdate_dim d1,\n\t\titem,\n\t\tstore\n\twhere\n\t\td1.d_year = 2000\n\t\tand d1.d_date_sk = ss_sold_date_sk\n\t\tand i_item_sk = ss_item_sk\n\t\tand s_store_sk = ss_store_sk\n\t\tand s_state in (\n\t\t\t'TN', 'TN', 'TN', 'TN',\n\t\t\t'TN', 'TN', 'TN', 'TN'\n\t\t)\n\tgroup by\n\t\trollup(i_category, i_class)\n) as sub\norder by\n\tlochierarchy desc,\n\tcase when lochierarchy = 0 then i_category end,\n\trank_within_parent\nlimit 100;\n",
    "39": "/* TPC-DS Query 37 */\n\nselect\n\ti_item_id,\n\ti_item_desc,\n\ti_current_price\nfrom\n\titem,\n\tinventory,\n\tdate_dim,\n\tcatalog_sales\nwhere\n\ti_current_price between 29 and 29 + 30\n\tand inv_item_sk = i_item_sk\n\tand d_date_sk = inv_date_sk\n\tand d_date between cast('2002-03-29' as date) and (cast('2002-03-29' as date) + 60)\n\tand i_manufact_id in (705, 742, 777, 944)\n\tand inv_quantity_on_hand between 100 and 500\n\tand cs_item_sk = i_item_sk\ngroup by\n\ti_item_id,\n\ti_item_desc,\n\ti_current_price\norder by\n\ti_item_id\nlimit 100;\n",
    "40": "/* TPC-DS Query 38 */\n\nselect\n\tcount(*)\nfrom (\n\tselect\n\t\tdistinct c_last_name,\n\t\tc_first_name,\n\t\td_date\n\tfrom\n\t\tstore_sales,\n\t\tdate_dim,\n\t\tcustomer\n\twhere\n\t\tstore_sales.ss_sold_date_sk = date_dim.d_date_sk\n\t\tand store_sales.ss_customer_sk = customer.c_customer_sk\n\t\tand d_month_seq between 1189 and 1189 + 11\n\tintersect\n\tselect\n\t\tdistinct c_last_name,\n\t\tc_first_name,\n\t\td_date\n\tfrom\n\t\tcatalog_sales,\n\t\tdate_dim,\n\t\tcustomer\n\twhere\n\t\tcatalog_sales.cs_sold_date_sk = date_dim.d_date_sk\n\t\tand catalog_sales.cs_bill_customer_sk = customer.c_customer_sk\n\t\tand d_month_seq between 1189 and 1189 + 11\n\tintersect\n\tselect\n\t\tdistinct c_last_name,\n\t\tc_first_name,\n\t\td_date\n\tfrom\n\t\tweb_sales,\n\t\tdate_dim,\n\t\tcustomer\n\twhere\n\t\tweb_sales.ws_sold_date_sk = date_dim.d_date_sk\n\t\tand web_sales.ws_bill_customer_sk = customer.c_customer_sk\n\t\tand d_month_seq between 1189 and 1189 + 11\n) hot_cust\nlimit 100;\n",
    "41": "/* TPC-DS Query 39 */\n\nwith inv as (\n\tselect\n\t\tw_warehouse_name,\n\t\tw_warehouse_sk,\n\t\ti_item_sk,\n\t\td_moy,\n\t\tstdev,\n\t\tmean,\n\t\tcase mean when 0 then null else stdev / mean end as cov\n\tfrom (\n\t\tselect\n\t\t\tw_warehouse_name,\n\t\t\tw_warehouse_sk,\n\t\t\ti_item_sk,\n\t\t\td_moy,\n\t\t\tstddev_samp(inv_quantity_on_hand) as stdev,\n\t\t\tavg(inv_quantity_on_hand) as mean\n\t\tfrom\n\t\t\tinventory,\n\t\t\titem,\n\t\t\twarehouse,\n\t\t\tdate_dim\n\t\twhere\n\t\t\tinv_item_sk = i_item_sk\n\t\t\tand inv_warehouse_sk = w_warehouse_sk\n\t\t\tand inv_date_sk = d_date_sk\n\t\t\tand d_year = 2000\n\t\tgroup by\n\t\t\tw_warehouse_name,\n\t\t\tw_warehouse_sk,\n\t\t\ti_item_sk,\n\t\t\td_moy\n\t) foo\n\twhere\n\t\tcase mean when 0 then 0 else stdev / mean end > 1\n)\nselect\n\tinv1.w_warehouse_sk,\n\tinv1.i_item_sk,\n\tinv1.d_moy,\n\tinv1.mean,\n\tinv1.cov,\n\tinv2.w_warehouse_sk,\n\tinv2.i_item_sk,\n\tinv2.d_moy,\n\tinv2.mean,\n\tinv2.cov\nfrom\n\tinv inv1,\n\tinv inv2\nwhere\n\tinv1.i_item_sk = inv2.i_item_sk\n\tand inv1.w_warehouse_sk = inv2.w_warehouse_sk\n\tand inv1.d_moy = 1\n\tand inv2.d_moy = 1 + 1\norder by\n\tinv1.w_warehouse_sk,\n\tinv1.i_item_sk,\n\tinv1.d_moy,\n\tinv1.mean,\n\tinv1.cov,\n\tinv2.d_moy,\n\tinv2.mean,\n\tinv2.cov;\n\nwith inv as (\n\tselect\n\t\tw_warehouse_name,\n\t\tw_warehouse_sk,\n\t\ti_item_sk,\n\t\td_moy,\n\t\tstdev,\n\t\tmean,\n\t\tcase mean when 0 then null else stdev / mean end as cov\n\tfrom (\n\t\tselect\n\t\t\tw_warehouse_name,\n\t\t\tw_warehouse_sk,\n\t\t\ti_item_sk,\n\t\t\td_moy,\n\t\t\tstddev_samp(inv_quantity_on_hand) as stdev,\n\t\t\tavg(inv_quantity_on_hand) as mean\n\t\tfrom\n\t\t\tinventory,\n\t\t\titem,\n\t\t\twarehouse,\n\t\t\tdate_dim\n\t\twhere\n\t\t\tinv_item_sk = i_item_sk\n\t\t\tand inv_warehouse_sk = w_warehouse_sk\n\t\t\tand inv_date_sk = d_date_sk\n\t\t\tand d_year = 2000\n\t\tgroup by\n\t\t\tw_warehouse_name,\n\t\t\tw_warehouse_sk,\n\t\t\ti_item_sk,\n\t\t\td_moy\n\t) foo\n\twhere\n\t\tcase mean when 0 then 0 else stdev / mean end > 1\n)\nselect\n\tinv1.w_warehouse_sk,\n\tinv1.i_item_sk,\n\tinv1.d_moy,\n\tinv1.mean,\n\tinv1.cov,\n\tinv2.w_warehouse_sk,\n\tinv2.i_item_sk,\n\tinv2.d_moy,\n\tinv2.mean,\n\tinv2.cov\nfrom\n\tinv inv1,\n\tinv inv2\nwhere\n\tinv1.i_item_sk = inv2.i_item_sk\n\tand inv1.w_warehouse_sk = inv2.w_warehouse_sk\n\tand inv1.d_moy = 1\n\tand inv2.d_moy = 1 + 1\n\tand inv1.cov > 1.5\norder by\n\tinv1.w_warehouse_sk,\n\tinv1.i_item_sk,\n\tinv1.d_moy,\n\tinv1.mean,\n\tinv1.cov,\n\tinv2.d_moy,\n\tinv2.mean,\n\tinv2.cov;\n",
    "42": "/* TPC-DS Query 40 */\n\nselect\n\tw_state,\n\ti_item_id,\n\tsum(\n\t\tcase when (cast(d_date as date) < cast('2001-05-02' as date))\n\t\t\tthen cs_sales_price - coalesce(cr_refunded_cash, 0)\n\t\t\telse 0\n\t\tend\n\t) as sales_before,\n\tsum(\n\t\tcase when (cast(d_date as date) >= cast('2001-05-02' as date))\n\t\t\tthen cs_sales_price - coalesce(cr_refunded_cash, 0)\n\t\t\telse 0\n\t\tend\n\t) as sales_after\nfrom\n\tcatalog_sales\n\tleft outer join catalog_returns on (\n\t\tcs_order_number = cr_order_number\n\t\tand cs_item_sk = cr_item_sk\n\t),\n\twarehouse,\n\titem,\n\tdate_dim\nwhere\n\ti_current_price between 0.99 and 1.49\n\tand i_item_sk = cs_item_sk\n\tand cs_warehouse_sk = w_warehouse_sk\n\tand cs_sold_date_sk = d_date_sk\n\tand d_date between (cast('2001-05-02' as date) - 30)\n\t\tand (cast('2001-05-02' as date) + 30)\ngroup by\n\tw_state,\n\ti_item_id\norder by\n\tw_state,\n\ti_item_id\nlimit 100;\n",
    "43": "/* TPC-DS Query 41 */\n\nselect\n\tdistinct(i_product_name)\nfrom\n\titem i1\nwhere\n\ti_manufact_id between 704 and 704 + 40\n\tand (\n\t\tselect\n\t\t\tcount(*) as item_cnt\n\t\tfrom\n\t\t\titem\n\t\twhere\n\t\t\t(\n\t\t\t\ti_manufact = i1.i_manufact\n\t\t\t\tand (\n\t\t\t\t\t(\n\t\t\t\t\t\ti_category = 'Women'\n\t\t\t\t\t\tand (i_color = 'forest' or i_color = 'lime')\n\t\t\t\t\t\tand (i_units = 'Pallet' or i_units = 'Pound')\n\t\t\t\t\t\tand (i_size = 'economy' or i_size = 'small')\n\t\t\t\t\t)\n\t\t\t\t\tor (\n\t\t\t\t\t\ti_category = 'Women'\n\t\t\t\t\t\tand (i_color = 'navy' or i_color = 'slate')\n\t\t\t\t\t\tand (i_units = 'Gross' or i_units = 'Bunch')\n\t\t\t\t\t\tand (i_size = 'extra large' or i_size = 'petite')\n\t\t\t\t\t)\n\t\t\t\t\tor (\n\t\t\t\t\t\ti_category = 'Men'\n\t\t\t\t\t\tand (i_color = 'powder' or i_color = 'sky')\n\t\t\t\t\t\tand (i_units = 'Dozen' or i_units = 'Lb')\n\t\t\t\t\t\tand (i_size = 'N/A' or i_size = 'large')\n\t\t\t\t\t)\n\t\t\t\t\tor (\n\t\t\t\t\t\ti_category = 'Men'\n\t\t\t\t\t\tand (i_color = 'maroon' or i_color = 'smoke')\n\t\t\t\t\t\tand (i_units = 'Ounce' or i_units = 'Case')\n\t\t\t\t\t\tand (i_size = 'economy' or i_size = 'small')\n\t\t\t\t\t)\n\t\t\t\t)\n\t\t\t)\n\t\t\tor (\n\t\t\t\ti_manufact = i1.i_manufact\n\t\t\t\tand (\n\t\t\t\t\t(\n\t\t\t\t\t\ti_category = 'Women'\n\t\t\t\t\t\tand (i_color = 'dark' or i_color = 'aquamarine')\n\t\t\t\t\t\tand (i_units = 'Ton' or i_units = 'Tbl')\n\t\t\t\t\t\tand (i_size = 'economy' or i_size = 'small')\n\t\t\t\t\t)\n\t\t\t\t\tor (\n\t\t\t\t\t\ti_category = 'Women'\n\t\t\t\t\t\tand (i_color = 'frosted' or i_color = 'plum')\n\t\t\t\t\t\tand (i_units = 'Dram' or i_units = 'Box')\n\t\t\t\t\t\tand (i_size = 'extra large' or i_size = 'petite')\n\t\t\t\t\t)\n\t\t\t\t\tor (\n\t\t\t\t\t\ti_category = 'Men'\n\t\t\t\t\t\tand (i_color = 'papaya' or i_color = 'peach')\n\t\t\t\t\t\tand (i_units = 'Bundle' or i_units = 'Carton')\n\t\t\t\t\t\tand (i_size = 'N/A' or i_size = 'large')\n\t\t\t\t\t)\n\t\t\t\t\tor (\n\t\t\t\t\t\ti_category = 'Men'\n\t\t\t\t\t\tand (i_color = 'firebrick' or i_color = 'sienna')\n\t\t\t\t\t\tand (i_units = 'Cup' or i_units = 'Each')\n\t\t\t\t\t\tand (i_size = 'economy' or i_size = 'small')\n\t\t\t\t\t)\n\t\t\t\t)\n\t\t\t)\n\t\t) > 0\norder by\n\ti_product_name\nlimit 100;\n",
    "44": "/* TPC-DS Query 42 */\n\nselect\n\tdt.d_year,\n\titem.i_category_id,\n\titem.i_category,\n\tsum(ss_ext_sales_price)\nfrom\n\tdate_dim dt,\n\tstore_sales,\n\titem\nwhere\n\tdt.d_date_sk = store_sales.ss_sold_date_sk\n\tand store_sales.ss_item_sk = item.i_item_sk\n\tand item.i_manager_id = 1\n\tand dt.d_moy = 11\n\tand dt.d_year = 1998\ngroup by\n\tdt.d_year,\n\titem.i_category_id,\n\titem.i_category\norder by\n\tsum(ss_ext_sales_price) desc,\n\tdt.d_year,\n\titem.i_category_id,\n\titem.i_category\nlimit 100;\n",
    "45": "/* TPC-DS Query 43 */\n\nselect\n\ts_store_name,\n\ts_store_id,\n\tsum(case when (d_day_name = 'Sunday') then ss_sales_price else null end) as sun_sales,\n\tsum(case when (d_day_name = 'Monday') then ss_sales_price else null end) as mon_sales,\n\tsum(case when (d_day_name = 'Tuesday') then ss_sales_price else null end) as tue_sales,\n\tsum(case when (d_day_name = 'Wednesday') then ss_sales_price else null end) as wed_sales,\n\tsum(case when (d_day_name = 'Thursday') then ss_sales_price else null end) as thu_sales,\n\tsum(case when (d_day_name = 'Friday') then ss_sales_price else null end) as fri_sales,\n\tsum(case when (d_day_name = 'Saturday') then ss_sales_price else null end) as sat_sales\nfrom\n\tdate_dim,\n\tstore_sales,\n\tstore\nwhere\n\td_date_sk = ss_sold_date_sk\n\tand s_store_sk = ss_store_sk\n\tand s_gmt_offset = -5\n\tand d_year = 2000\ngroup by\n\ts_store_name,\n\ts_store_id\norder by\n\ts_store_name,\n\ts_store_id,\n\tsun_sales,\n\tmon_sales,\n\ttue_sales,\n\twed_sales,\n\tthu_sales,\n\tfri_sales,\n\tsat_sales\nlimit 100;\n",
    "46": "/* TPC-DS Query 44 */\n\nselect\n\tasceding.rnk,\n\ti1.i_product_name as best_performing,\n\ti2.i_product_name as worst_performing\nfrom\n\t(select *\n\t from (\n\t\tselect\n\t\t\titem_sk,\n\t\t\trank() over (order by rank_col asc) as rnk\n\t\tfrom (\n\t\t\tselect\n\t\t\t\tss_item_sk as item_sk,\n\t\t\t\tavg(ss_net_profit) as rank_col\n\t\t\tfrom\n\t\t\t\tstore_sales ss1\n\t\t\twhere\n\t\t\t\tss_store_sk = 4\n\t\t\tgroup by\n\t\t\t\tss_item_sk\n\t\t\thaving avg(ss_net_profit) > 0.9 * (\n\t\t\t\tselect\n\t\t\t\t\tavg(ss_net_profit) as rank_col\n\t\t\t\tfrom\n\t\t\t\t\tstore_sales\n\t\t\t\twhere\n\t\t\t\t\tss_store_sk = 4\n\t\t\t\t\tand ss_hdemo_sk is null\n\t\t\t\tgroup by\n\t\t\t\t\tss_store_sk\n\t\t\t)\n\t\t) V1\n\t) V11\n\twhere\n\t\trnk < 11\n\t) as asceding,\n\t(select *\n\t from (\n\t\tselect\n\t\t\titem_sk,\n\t\t\trank() over (order by rank_col desc) as rnk\n\t\tfrom (\n\t\t\tselect\n\t\t\t\tss_item_sk as item_sk,\n\t\t\t\tavg(ss_net_profit) as rank_col\n\t\t\tfrom\n\t\t\t\tstore_sales ss1\n\t\t\twhere\n\t\t\t\tss_store_sk = 4\n\t\t\tgroup by\n\t\t\t\tss_item_sk\n\t\t\thaving avg(ss_net_profit) > 0.9 * (\n\t\t\t\tselect\n\t\t\t\t\tavg(ss_net_profit) as rank_col\n\t\t\t\tfrom\n\t\t\t\t\tstore_sales\n\t\t\t\twhere\n\t\t\t\t\tss_store_sk = 4\n\t\t\t\t\tand ss_hdemo_sk is null\n\t\t\t\tgroup by\n\t\t\t\t\tss_store_sk\n\t\t\t)\n\t\t) V2\n\t) V21\n\twhere\n\t\trnk < 11\n\t) as descending,\n\titem i1,\n\titem i2\nwhere\n\tasceding.rnk = descending.rnk\n\tand i1.i_item_sk = asceding.item_sk\n\tand i2.i_item_sk = descending.item_sk\norder by\n\tasceding.rnk\nlimit 100;\n",
    "47": "/* TPC-DS Query 45 */\n\nselect\n\tca_zip,\n\tca_city,\n\tsum(ws_sales_price)\nfrom\n\tweb_sales,\n\tcustomer,\n\tcustomer_address,\n\tdate_dim,\n\titem\nwhere\n\tws_bill_customer_sk = c_customer_sk\n\tand c_current_addr_sk = ca_address_sk\n\tand ws_item_sk = i_item_sk\n\tand (\n\t\tsubstr(ca_zip, 1, 5) in (\n\t\t\t'85669', '86197', '88274', '83405', '86475', '85392', '85460', '80348', '81792'\n\t\t)\n\t\tor i_item_id in (\n\t\t\tselect\n\t\t\t\ti_item_id\n\t\t\tfrom\n\t\t\t\titem\n\t\t\twhere\n\t\t\t\ti_item_sk in (2, 3, 5, 7, 11, 13, 17, 19, 23, 29)\n\t\t)\n\t)\n\tand ws_sold_date_sk = d_date_sk\n\tand d_qoy = 1\n\tand d_year = 2000\ngroup by\n\tca_zip,\n\tca_city\norder by\n\tca_zip,\n\tca_city\nlimit 100;\n",
    "48": "/* TPC-DS Query 46 */\n\nselect\n\tc_last_name,\n\tc_first_name,\n\tca_city,\n\tbought_city,\n\tss_ticket_number,\n\tamt,\n\tprofit\nfrom\n\t(\n\t\tselect\n\t\t\tss_ticket_number,\n\t\t\tss_customer_sk,\n\t\t\tca_city as bought_city,\n\t\t\tsum(ss_coupon_amt) as amt,\n\t\t\tsum(ss_net_profit) as profit\n\t\tfrom\n\t\t\tstore_sales,\n\t\t\tdate_dim,\n\t\t\tstore,\n\t\t\thousehold_demographics,\n\t\t\tcustomer_address\n\t\twhere\n\t\t\tstore_sales.ss_sold_date_sk = date_dim.d_date_sk\n\t\t\tand store_sales.ss_store_sk = store.s_store_sk\n\t\t\tand store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n\t\t\tand store_sales.ss_addr_sk = customer_address.ca_address_sk\n\t\t\tand (\n\t\t\t\thousehold_demographics.hd_dep_count = 8\n\t\t\t\tor household_demographics.hd_vehicle_count = 0\n\t\t\t)\n\t\t\tand date_dim.d_dow in (6, 0)\n\t\t\tand date_dim.d_year in (2000, 2000 + 1, 2000 + 2)\n\t\t\tand store.s_city in ('Midway', 'Fairview', 'Fairview', 'Midway', 'Fairview')\n\t\tgroup by\n\t\t\tss_ticket_number,\n\t\t\tss_customer_sk,\n\t\t\tss_addr_sk,\n\t\t\tca_city\n\t) dn,\n\tcustomer,\n\tcustomer_address current_addr\nwhere\n\tss_customer_sk = c_customer_sk\n\tand customer.c_current_addr_sk = current_addr.ca_address_sk\n\tand current_addr.ca_city <> bought_city\norder by\n\tc_last_name,\n\tc_first_name,\n\tca_city,\n\tbought_city,\n\tss_ticket_number\nlimit 100;\n",
    "49": "/* TPC-DS Query 47 */\n\nwith v1 as (\n\tselect\n\t\ti_category,\n\t\ti_brand,\n\t\ts_store_name,\n\t\ts_company_name,\n\t\td_year,\n\t\td_moy,\n\t\tsum(ss_sales_price) as sum_sales,\n\t\tavg(sum(ss_sales_price)) over (\n\t\t\tpartition by i_category, i_brand,\n\t\t\ts_store_name, s_company_name, d_year\n\t\t) as avg_monthly_sales,\n\t\trank() over (\n\t\t\tpartition by i_category, i_brand,\n\t\t\ts_store_name, s_company_name\n\t\t\torder by d_year, d_moy\n\t\t) as rn\n\tfrom\n\t\titem,\n\t\tstore_sales,\n\t\tdate_dim,\n\t\tstore\n\twhere\n\t\tss_item_sk = i_item_sk\n\t\tand ss_sold_date_sk = d_date_sk\n\t\tand ss_store_sk = s_store_sk\n\t\tand (\n\t\t\td_year = 2000\n\t\t\tor (d_year = 2000 - 1 and d_moy = 12)\n\t\t\tor (d_year = 2000 + 1 and d_moy = 1)\n\t\t)\n\tgroup by\n\t\ti_category,\n\t\ti_brand,\n\t\ts_store_name,\n\t\ts_company_name,\n\t\td_year,\n\t\td_moy\n),\nv2 as (\n\tselect\n\t\tv1.s_store_name,\n\t\tv1.s_company_name,\n\t\tv1.d_year,\n\t\tv1.avg_monthly_sales,\n\t\tv1.sum_sales,\n\t\tv1_lag.sum_sales as psum,\n\t\tv1_lead.sum_sales as nsum\n\tfrom\n\t\tv1,\n\t\tv1 v1_lag,\n\t\tv1 v1_lead\n\twhere\n\t\tv1.i_category = v1_lag.i_category\n\t\tand v1.i_category = v1_lead.i_category\n\t\tand v1.i_brand = v1_lag.i_brand\n\t\tand v1.i_brand = v1_lead.i_brand\n\t\tand v1.s_store_name = v1_lag.s_store_name\n\t\tand v1.s_store_name = v1_lead.s_store_name\n\t\tand v1.s_company_name = v1_lag.s_company_name\n\t\tand v1.s_company_name = v1_lead.s_company_name\n\t\tand v1.rn = v1_lag.rn + 1\n\t\tand v1.rn = v1_lead.rn - 1\n)\nselect\n\t*\nfrom\n\tv2\nwhere\n\td_year = 2000\n\tand avg_monthly_sales > 0\n\tand case\n\t\twhen avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales\n\t\telse null\n\tend > 0.1\norder by\n\tsum_sales - avg_monthly_sales,\n\tnsum\nlimit 100;\n",
    "50": "/* TPC-DS Query 48 */\n\nselect\n\tsum(ss_quantity)\nfrom\n\tstore_sales,\n\tstore,\n\tcustomer_demographics,\n\tcustomer_address,\n\tdate_dim\nwhere\n\ts_store_sk = ss_store_sk\n\tand ss_sold_date_sk = d_date_sk\n\tand d_year = 2001\n\tand (\n\t\t(\n\t\t\tcd_demo_sk = ss_cdemo_sk\n\t\t\tand cd_marital_status = 'S'\n\t\t\tand cd_education_status = 'Secondary'\n\t\t\tand ss_sales_price between 100.00 and 150.00\n\t\t)\n\t\tor (\n\t\t\tcd_demo_sk = ss_cdemo_sk\n\t\t\tand cd_marital_status = 'M'\n\t\t\tand cd_education_status = '2 yr Degree'\n\t\t\tand ss_sales_price between 50.00 and 100.00\n\t\t)\n\t\tor (\n\t\t\tcd_demo_sk = ss_cdemo_sk\n\t\t\tand cd_marital_status = 'D'\n\t\t\tand cd_education_status = 'Advanced Degree'\n\t\t\tand ss_sales_price between 150.00 and 200.00\n\t\t)\n\t)\n\tand (\n\t\t(\n\t\t\tss_addr_sk = ca_address_sk\n\t\t\tand ca_country = 'United States'\n\t\t\tand ca_state in ('ND', 'NY', 'SD')\n\t\t\tand ss_net_profit between 0 and 2000\n\t\t)\n\t\tor (\n\t\t\tss_addr_sk = ca_address_sk\n\t\t\tand ca_country = 'United States'\n\t\t\tand ca_state in ('MD', 'GA', 'KS')\n\t\t\tand ss_net_profit between 150 and 3000\n\t\t)\n\t\tor (\n\t\t\tss_addr_sk = ca_address_sk\n\t\t\tand ca_country = 'United States'\n\t\t\tand ca_state in ('CO', 'MN', 'NC')\n\t\t\tand ss_net_profit between 50 and 25000\n\t\t)\n\t);\n",
    "51": "/* TPC-DS Query 49 */\n\nselect\n\tchannel,\n\titem,\n\treturn_ratio,\n\treturn_rank,\n\tcurrency_rank\nfrom (\n\tselect\n\t\t'web' as channel,\n\t\tweb.item,\n\t\tweb.return_ratio,\n\t\tweb.return_rank,\n\t\tweb.currency_rank\n\tfrom (\n\t\tselect\n\t\t\titem,\n\t\t\treturn_ratio,\n\t\t\tcurrency_ratio,\n\t\t\trank() over (order by return_ratio) as return_rank,\n\t\t\trank() over (order by currency_ratio) as currency_rank\n\t\tfrom (\n\t\t\tselect\n\t\t\t\tws.ws_item_sk as item,\n\t\t\t\t(cast(sum(coalesce(wr.wr_return_quantity, 0)) as decimal(15, 4)) /\n\t\t\t\t cast(sum(coalesce(ws.ws_quantity, 0)) as decimal(15, 4))) as return_ratio,\n\t\t\t\t(cast(sum(coalesce(wr.wr_return_amt, 0)) as decimal(15, 4)) /\n\t\t\t\t cast(sum(coalesce(ws.ws_net_paid, 0)) as decimal(15, 4))) as currency_ratio\n\t\t\tfrom\n\t\t\t\tweb_sales ws\n\t\t\t\tleft outer join web_returns wr\n\t\t\t\t\ton (ws.ws_order_number = wr.wr_order_number\n\t\t\t\t\t and ws.ws_item_sk = wr.wr_item_sk),\n\t\t\t\tdate_dim\n\t\t\twhere\n\t\t\t\twr.wr_return_amt > 10000\n\t\t\t\tand ws.ws_net_profit > 1\n\t\t\t\tand ws.ws_net_paid > 0\n\t\t\t\tand ws.ws_quantity > 0\n\t\t\t\tand ws_sold_date_sk = d_date_sk\n\t\t\t\tand d_year = 1998\n\t\t\t\tand d_moy = 11\n\t\t\tgroup by ws.ws_item_sk\n\t\t) in_web\n\t) web\n\twhere\n\t\tweb.return_rank <= 10\n\t\tor web.currency_rank <= 10\n\tunion\n\tselect\n\t\t'catalog' as channel,\n\t\tcatalog.item,\n\t\tcatalog.return_ratio,\n\t\tcatalog.return_rank,\n\t\tcatalog.currency_rank\n\tfrom (\n\t\tselect\n\t\t\titem,\n\t\t\treturn_ratio,\n\t\t\tcurrency_ratio,\n\t\t\trank() over (order by return_ratio) as return_rank,\n\t\t\trank() over (order by currency_ratio) as currency_rank\n\t\tfrom (\n\t\t\tselect\n\t\t\t\tcs.cs_item_sk as item,\n\t\t\t\t(cast(sum(coalesce(cr.cr_return_quantity, 0)) as decimal(15, 4)) /\n\t\t\t\t cast(sum(coalesce(cs.cs_quantity, 0)) as decimal(15, 4))) as return_ratio,\n\t\t\t\t(cast(sum(coalesce(cr.cr_return_amount, 0)) as decimal(15, 4)) /\n\t\t\t\t cast(sum(coalesce(cs.cs_net_paid, 0)) as decimal(15, 4))) as currency_ratio\n\t\t\tfrom\n\t\t\t\tcatalog_sales cs\n\t\t\t\tleft outer join catalog_returns cr\n\t\t\t\t\ton (cs.cs_order_number = cr.cr_order_number\n\t\t\t\t\t and cs.cs_item_sk = cr.cr_item_sk),\n\t\t\t\tdate_dim\n\t\t\twhere\n\t\t\t\tcr.cr_return_amount > 10000\n\t\t\t\tand cs.cs_net_profit > 1\n\t\t\t\tand cs.cs_net_paid > 0\n\t\t\t\tand cs.cs_quantity > 0\n\t\t\t\tand cs_sold_date_sk = d_date_sk\n\t\t\t\tand d_year = 1998\n\t\t\t\tand d_moy = 11\n\t\t\tgroup by cs.cs_item_sk\n\t\t) in_cat\n\t) catalog\n\twhere\n\t\tcatalog.return_rank <= 10\n\t\tor catalog.currency_rank <= 10\n\tunion\n\tselect\n\t\t'store' as channel,\n\t\tstore.item,\n\t\tstore.return_ratio,\n\t\tstore.return_rank,\n\t\tstore.currency_rank\n\tfrom (\n\t\tselect\n\t\t\titem,\n\t\t\treturn_ratio,\n\t\t\tcurrency_ratio,\n\t\t\trank() over (order by return_ratio) as return_rank,\n\t\t\trank() over (order by currency_ratio) as currency_rank\n\t\tfrom (\n\t\t\tselect\n\t\t\t\tsts.ss_item_sk as item,\n\t\t\t\t(cast(sum(coalesce(sr.sr_return_quantity, 0)) as decimal(15, 4)) /\n\t\t\t\t cast(sum(coalesce(sts.ss_quantity, 0)) as decimal(15, 4))) as return_ratio,\n\t\t\t\t(cast(sum(coalesce(sr.sr_return_amt, 0)) as decimal(15, 4)) /\n\t\t\t\t cast(sum(coalesce(sts.ss_net_paid, 0)) as decimal(15, 4))) as currency_ratio\n\t\t\tfrom\n\t\t\t\tstore_sales sts\n\t\t\t\tleft outer join store_returns sr\n\t\t\t\t\ton (sts.ss_ticket_number = sr.sr_ticket_number\n\t\t\t\t\t and sts.ss_item_sk = sr.sr_item_sk),\n\t\t\t\tdate_dim\n\t\t\twhere\n\t\t\t\tsr.sr_return_amt > 10000\n\t\t\t\tand sts.ss_net_profit > 1\n\t\t\t\tand sts.ss_net_paid > 0\n\t\t\t\tand sts.ss_quantity > 0\n\t\t\t\tand ss_sold_date_sk = d_date_sk\n\t\t\t\tand d_year = 1998\n\t\t\t\tand d_moy = 11\n\t\t\tgroup by sts.ss_item_sk\n\t\t) in_store\n\t) store\n\twhere\n\t\tstore.return_rank <= 10\n\t\tor store.currency_rank <= 10\n) x\norder by\n\tchannel,\n\treturn_rank,\n\tcurrency_rank,\n\titem\nlimit 100;\n",
    "52": "/* TPC-DS Query 50 */\n\nselect\n\ts_store_name,\n\ts_company_id,\n\ts_street_number,\n\ts_street_name,\n\ts_street_type,\n\ts_suite_number,\n\ts_city,\n\ts_county,\n\ts_state,\n\ts_zip,\n\tsum(case when (sr_returned_date_sk - ss_sold_date_sk <= 30) then 1 else 0 end) as \"30 days\",\n\tsum(case when (sr_returned_date_sk - ss_sold_date_sk > 30)\n\t\tand (sr_returned_date_sk - ss_sold_date_sk <= 60) then 1 else 0 end) as \"31-60 days\",\n\tsum(case when (sr_returned_date_sk - ss_sold_date_sk > 60)\n\t\tand (sr_returned_date_sk - ss_sold_date_sk <= 90) then 1 else 0 end) as \"61-90 days\",\n\tsum(case when (sr_returned_date_sk - ss_sold_date_sk > 90)\n\t\tand (sr_returned_date_sk - ss_sold_date_sk <= 120) then 1 else 0 end) as \"91-120 days\",\n\tsum(case when (sr_returned_date_sk - ss_sold_date_sk > 120) then 1 else 0 end) as \">120 days\"\nfrom\n\tstore_sales,\n\tstore_returns,\n\tstore,\n\tdate_dim d1,\n\tdate_dim d2\nwhere\n\td2.d_year = 2001\n\tand d2.d_moy = 8\n\tand ss_ticket_number = sr_ticket_number\n\tand ss_item_sk = sr_item_sk\n\tand ss_sold_date_sk = d1.d_date_sk\n\tand sr_returned_date_sk = d2.d_date_sk\n\tand ss_customer_sk = sr_customer_sk\n\tand ss_store_sk = s_store_sk\ngroup by\n\ts_store_name,\n\ts_company_id,\n\ts_street_number,\n\ts_street_name,\n\ts_street_type,\n\ts_suite_number,\n\ts_city,\n\ts_county,\n\ts_state,\n\ts_zip\norder by\n\ts_store_name,\n\ts_company_id,\n\ts_street_number,\n\ts_street_name,\n\ts_street_type,\n\ts_suite_number,\n\ts_city,\n\ts_county,\n\ts_state,\n\ts_zip\nlimit 100;\n",
    "53": "/* TPC-DS Query 51 */\n\nWITH web_v1 AS (\n\tSELECT\n\t\tws_item_sk AS item_sk,\n\t\td_date,\n\t\tSUM(SUM(ws_sales_price))\n\t\t\tOVER (\n\t\t\t\tPARTITION BY ws_item_sk\n\t\t\t\tORDER BY d_date\n\t\t\t\tROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW\n\t\t\t) AS cume_sales\n\tFROM\n\t\tweb_sales,\n\t\tdate_dim\n\tWHERE\n\t\tws_sold_date_sk = d_date_sk\n\t\tAND d_month_seq BETWEEN 1212 AND 1212 + 11\n\t\tAND ws_item_sk IS NOT NULL\n\tGROUP BY\n\t\tws_item_sk,\n\t\td_date\n),\nstore_v1 AS (\n\tSELECT\n\t\tss_item_sk AS item_sk,\n\t\td_date,\n\t\tSUM(SUM(ss_sales_price))\n\t\t\tOVER (\n\t\t\t\tPARTITION BY ss_item_sk\n\t\t\t\tORDER BY d_date\n\t\t\t\tROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW\n\t\t\t) AS cume_sales\n\tFROM\n\t\tstore_sales,\n\t\tdate_dim\n\tWHERE\n\t\tss_sold_date_sk = d_date_sk\n\t\tAND d_month_seq BETWEEN 1212 AND 1212 + 11\n\t\tAND ss_item_sk IS NOT NULL\n\tGROUP BY\n\t\tss_item_sk,\n\t\td_date\n)\nSELECT\n\t*\nFROM (\n\tSELECT\n\t\titem_sk,\n\t\td_date,\n\t\tweb_sales,\n\t\tstore_sales,\n\t\tMAX(web_sales)\n\t\t\tOVER (\n\t\t\t\tPARTITION BY item_sk\n\t\t\t\tORDER BY d_date\n\t\t\t\tROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW\n\t\t\t) AS web_cumulative,\n\t\tMAX(store_sales)\n\t\t\tOVER (\n\t\t\t\tPARTITION BY item_sk\n\t\t\t\tORDER BY d_date\n\t\t\t\tROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW\n\t\t\t) AS store_cumulative\n\tFROM (\n\t\tSELECT\n\t\t\tCASE\n\t\t\t\tWHEN web.item_sk IS NOT NULL THEN web.item_sk\n\t\t\t\tELSE store.item_sk\n\t\t\tEND AS item_sk,\n\t\t\tCASE\n\t\t\t\tWHEN web.d_date IS NOT NULL THEN web.d_date\n\t\t\t\tELSE store.d_date\n\t\t\tEND AS d_date,\n\t\t\tweb.cume_sales AS web_sales,\n\t\t\tstore.cume_sales AS store_sales\n\t\tFROM\n\t\t\tweb_v1 web\n\t\tFULL OUTER JOIN\n\t\t\tstore_v1 store\n\t\tON\n\t\t\tweb.item_sk = store.item_sk\n\t\t\tAND web.d_date = store.d_date\n\t) x\n) y\nWHERE\n\tweb_cumulative > store_cumulative\nORDER BY\n\titem_sk,\n\td_date\nLIMIT 100;\n",
    "54": "/* TPC-DS Query 52 */\n\nSELECT\n\tdt.d_year,\n\titem.i_brand_id AS brand_id,\n\titem.i_brand AS brand,\n\tSUM(ss_ext_sales_price) AS ext_price\nFROM\n\tdate_dim dt,\n\tstore_sales,\n\titem\nWHERE\n\tdt.d_date_sk = store_sales.ss_sold_date_sk\n\tAND store_sales.ss_item_sk = item.i_item_sk\n\tAND item.i_manager_id = 1\n\tAND dt.d_moy = 12\n\tAND dt.d_year = 2000\nGROUP BY\n\tdt.d_year,\n\titem.i_brand,\n\titem.i_brand_id\nORDER BY\n\tdt.d_year,\n\text_price DESC,\n\tbrand_id\nLIMIT 100;\n",
    "55": "/* TPC-DS Query 53 */\n\nSELECT\n\t*\nFROM (\n\tSELECT\n\t\ti_manufact_id,\n\t\tSUM(ss_sales_price) AS sum_sales,\n\t\tAVG(SUM(ss_sales_price)) OVER (PARTITION BY i_manufact_id) AS avg_quarterly_sales\n\tFROM\n\t\titem,\n\t\tstore_sales,\n\t\tdate_dim,\n\t\tstore\n\tWHERE\n\t\tss_item_sk = i_item_sk\n\t\tAND ss_sold_date_sk = d_date_sk\n\t\tAND ss_store_sk = s_store_sk\n\t\tAND d_month_seq IN (\n\t\t\t1186,\n\t\t\t1186 + 1,\n\t\t\t1186 + 2,\n\t\t\t1186 + 3,\n\t\t\t1186 + 4,\n\t\t\t1186 + 5,\n\t\t\t1186 + 6,\n\t\t\t1186 + 7,\n\t\t\t1186 + 8,\n\t\t\t1186 + 9,\n\t\t\t1186 + 10,\n\t\t\t1186 + 11\n\t\t)\n\t\tAND ((\n\t\t\ti_category IN ('Books', 'Children', 'Electronics')\n\t\t\tAND i_class IN ('personal', 'portable', 'reference', 'self-help')\n\t\t\tAND i_brand IN (\n\t\t\t\t'scholaramalgamalg #14',\n\t\t\t\t'scholaramalgamalg #7',\n\t\t\t\t'exportiunivamalg #9',\n\t\t\t\t'scholaramalgamalg #9'\n\t\t\t)\n\t\t) OR (\n\t\t\ti_category IN ('Women', 'Music', 'Men')\n\t\t\tAND i_class IN ('accessories', 'classical', 'fragrances', 'pants')\n\t\t\tAND i_brand IN (\n\t\t\t\t'amalgimporto #1',\n\t\t\t\t'edu packscholar #1',\n\t\t\t\t'exportiimporto #1',\n\t\t\t\t'importoamalg #1'\n\t\t\t)\n\t\t))\n\tGROUP BY\n\t\ti_manufact_id,\n\t\td_qoy\n) tmp1\nWHERE\n\tCASE\n\t\tWHEN avg_quarterly_sales > 0 THEN ABS(sum_sales - avg_quarterly_sales) / avg_quarterly_sales\n\t\tELSE NULL\n\tEND > 0.1\nORDER BY\n\tavg_quarterly_sales,\n\tsum_sales,\n\ti_manufact_id\nLIMIT 100;\n",
    "56": "/* TPC-DS Query 54 */\n\nWITH my_customers AS (\n\tSELECT DISTINCT\n\t\tc_customer_sk,\n\t\tc_current_addr_sk\n\tFROM (\n\t\tSELECT\n\t\t\tcs_sold_date_sk AS sold_date_sk,\n\t\t\tcs_bill_customer_sk AS customer_sk,\n\t\t\tcs_item_sk AS item_sk\n\t\tFROM catalog_sales\n\t\tUNION ALL\n\t\tSELECT\n\t\t\tws_sold_date_sk AS sold_date_sk,\n\t\t\tws_bill_customer_sk AS customer_sk,\n\t\t\tws_item_sk AS item_sk\n\t\tFROM web_sales\n\t) cs_or_ws_sales,\n\titem,\n\tdate_dim,\n\tcustomer\n\tWHERE\n\t\tsold_date_sk = d_date_sk\n\t\tAND item_sk = i_item_sk\n\t\tAND i_category = 'Music'\n\t\tAND i_class = 'country'\n\t\tAND c_customer_sk = cs_or_ws_sales.customer_sk\n\t\tAND d_moy = 1\n\t\tAND d_year = 1999\n),\nmy_revenue AS (\n\tSELECT\n\t\tc_customer_sk,\n\t\tSUM(ss_ext_sales_price) AS revenue\n\tFROM\n\t\tmy_customers,\n\t\tstore_sales,\n\t\tcustomer_address,\n\t\tstore,\n\t\tdate_dim\n\tWHERE\n\t\tc_current_addr_sk = ca_address_sk\n\t\tAND ca_county = s_county\n\t\tAND ca_state = s_state\n\t\tAND ss_sold_date_sk = d_date_sk\n\t\tAND c_customer_sk = ss_customer_sk\n\t\tAND d_month_seq BETWEEN (\n\t\t\tSELECT DISTINCT d_month_seq + 1\n\t\t\tFROM date_dim\n\t\t\tWHERE d_year = 1999 AND d_moy = 1\n\t\t) AND (\n\t\t\tSELECT DISTINCT d_month_seq + 3\n\t\t\tFROM date_dim\n\t\t\tWHERE d_year = 1999 AND d_moy = 1\n\t\t)\n\tGROUP BY c_customer_sk\n),\nsegments AS (\n\tSELECT\n\t\tCAST((revenue / 50) AS INT) AS segment\n\tFROM my_revenue\n)\nSELECT\n\tsegment,\n\tCOUNT(*) AS num_customers,\n\tsegment * 50 AS segment_base\nFROM segments\nGROUP BY segment\nORDER BY segment, num_customers\nLIMIT 100;\n",
    "57": "/* TPC-DS Query 55 */\n\nSELECT\n\ti_brand_id AS brand_id,\n\ti_brand AS brand,\n\tSUM(ss_ext_sales_price) AS ext_price\nFROM\n\tdate_dim,\n\tstore_sales,\n\titem\nWHERE\n\td_date_sk = ss_sold_date_sk\n\tAND ss_item_sk = i_item_sk\n\tAND i_manager_id = 52\n\tAND d_moy = 11\n\tAND d_year = 2000\nGROUP BY\n\ti_brand,\n\ti_brand_id\nORDER BY\n\text_price DESC,\n\ti_brand_id\nLIMIT 100;\n",
    "58": "/* TPC-DS Query 56 */\n\nWITH ss AS (\n\tSELECT\n\t\ti_item_id,\n\t\tSUM(ss_ext_sales_price) AS total_sales\n\tFROM\n\t\tstore_sales,\n\t\tdate_dim,\n\t\tcustomer_address,\n\t\titem\n\tWHERE\n\t\ti_item_id IN (\n\t\t\tSELECT i_item_id\n\t\t\tFROM item\n\t\t\tWHERE i_color IN ('powder', 'orchid', 'pink')\n\t\t)\n\t\tAND ss_item_sk = i_item_sk\n\t\tAND ss_sold_date_sk = d_date_sk\n\t\tAND d_year = 2000\n\t\tAND d_moy = 3\n\t\tAND ss_addr_sk = ca_address_sk\n\t\tAND ca_gmt_offset = -6\n\tGROUP BY\n\t\ti_item_id\n),\ncs AS (\n\tSELECT\n\t\ti_item_id,\n\t\tSUM(cs_ext_sales_price) AS total_sales\n\tFROM\n\t\tcatalog_sales,\n\t\tdate_dim,\n\t\tcustomer_address,\n\t\titem\n\tWHERE\n\t\ti_item_id IN (\n\t\t\tSELECT i_item_id\n\t\t\tFROM item\n\t\t\tWHERE i_color IN ('powder', 'orchid', 'pink')\n\t\t)\n\t\tAND cs_item_sk = i_item_sk\n\t\tAND cs_sold_date_sk = d_date_sk\n\t\tAND d_year = 2000\n\t\tAND d_moy = 3\n\t\tAND cs_bill_addr_sk = ca_address_sk\n\t\tAND ca_gmt_offset = -6\n\tGROUP BY\n\t\ti_item_id\n),\nws AS (\n\tSELECT\n\t\ti_item_id,\n\t\tSUM(ws_ext_sales_price) AS total_sales\n\tFROM\n\t\tweb_sales,\n\t\tdate_dim,\n\t\tcustomer_address,\n\t\titem\n\tWHERE\n\t\ti_item_id IN (\n\t\t\tSELECT i_item_id\n\t\t\tFROM item\n\t\t\tWHERE i_color IN ('powder', 'orchid', 'pink')\n\t\t)\n\t\tAND ws_item_sk = i_item_sk\n\t\tAND ws_sold_date_sk = d_date_sk\n\t\tAND d_year = 2000\n\t\tAND d_moy = 3\n\t\tAND ws_bill_addr_sk = ca_address_sk\n\t\tAND ca_gmt_offset = -6\n\tGROUP BY\n\t\ti_item_id\n)\nSELECT\n\ti_item_id,\n\tSUM(total_sales) AS total_sales\nFROM (\n\tSELECT * FROM ss\n\tUNION ALL\n\tSELECT * FROM cs\n\tUNION ALL\n\tSELECT * FROM ws\n) tmp1\nGROUP BY\n\ti_item_id\nORDER BY\n\ttotal_sales,\n\ti_item_id\nLIMIT 100;\n",
    "59": "/* TPC-DS Query 57 */\n\nWITH v1 AS (\n\tSELECT\n\t\ti_category,\n\t\ti_brand,\n\t\tcc_name,\n\t\td_year,\n\t\td_moy,\n\t\tSUM(cs_sales_price) AS sum_sales,\n\t\tAVG(SUM(cs_sales_price)) OVER (\n\t\t\tPARTITION BY i_category, i_brand, cc_name, d_year\n\t\t) AS avg_monthly_sales,\n\t\tRANK() OVER (\n\t\t\tPARTITION BY i_category, i_brand, cc_name\n\t\t\tORDER BY d_year, d_moy\n\t\t) AS rn\n\tFROM\n\t\titem,\n\t\tcatalog_sales,\n\t\tdate_dim,\n\t\tcall_center\n\tWHERE\n\t\tcs_item_sk = i_item_sk\n\t\tAND cs_sold_date_sk = d_date_sk\n\t\tAND cc_call_center_sk = cs_call_center_sk\n\t\tAND (\n\t\t\td_year = 2001\n\t\t\tOR (d_year = 2001 - 1 AND d_moy = 12)\n\t\t\tOR (d_year = 2001 + 1 AND d_moy = 1)\n\t\t)\n\tGROUP BY\n\t\ti_category,\n\t\ti_brand,\n\t\tcc_name,\n\t\td_year,\n\t\td_moy\n),\nv2 AS (\n\tSELECT\n\t\tv1.i_category,\n\t\tv1.i_brand,\n\t\tv1.cc_name,\n\t\tv1.d_year,\n\t\tv1.avg_monthly_sales,\n\t\tv1.sum_sales,\n\t\tv1_lag.sum_sales AS psum,\n\t\tv1_lead.sum_sales AS nsum\n\tFROM\n\t\tv1,\n\t\tv1 v1_lag,\n\t\tv1 v1_lead\n\tWHERE\n\t\tv1.i_category = v1_lag.i_category\n\t\tAND v1.i_category = v1_lead.i_category\n\t\tAND v1.i_brand = v1_lag.i_brand\n\t\tAND v1.i_brand = v1_lead.i_brand\n\t\tAND v1.cc_name = v1_lag.cc_name\n\t\tAND v1.cc_name = v1_lead.cc_name\n\t\tAND v1.rn = v1_lag.rn + 1\n\t\tAND v1.rn = v1_lead.rn - 1\n)\nSELECT\n\t*\nFROM\n\tv2\nWHERE\n\td_year = 2001\n\tAND avg_monthly_sales > 0\n\tAND CASE WHEN avg_monthly_sales > 0 THEN ABS(sum_sales - avg_monthly_sales) / avg_monthly_sales ELSE NULL END > 0.1\nORDER BY\n\tsum_sales - avg_monthly_sales,\n\tavg_monthly_sales\nLIMIT 100;\n",
    "60": "/* TPC-DS Query 58 */\n\nWITH ss_items AS (\n\tSELECT\n\t\ti_item_id AS item_id,\n\t\tSUM(ss_ext_sales_price) AS ss_item_rev\n\tFROM\n\t\tstore_sales,\n\t\titem,\n\t\tdate_dim\n\tWHERE\n\t\tss_item_sk = i_item_sk\n\t\tAND d_date IN (\n\t\t\tSELECT d_date\n\t\t\tFROM date_dim\n\t\t\tWHERE d_week_seq = (\n\t\t\t\tSELECT d_week_seq\n\t\t\t\tFROM date_dim\n\t\t\t\tWHERE d_date = '2001-06-16'\n\t\t\t)\n\t\t)\n\t\tAND ss_sold_date_sk = d_date_sk\n\tGROUP BY\n\t\ti_item_id\n),\ncs_items AS (\n\tSELECT\n\t\ti_item_id AS item_id,\n\t\tSUM(cs_ext_sales_price) AS cs_item_rev\n\tFROM\n\t\tcatalog_sales,\n\t\titem,\n\t\tdate_dim\n\tWHERE\n\t\tcs_item_sk = i_item_sk\n\t\tAND d_date IN (\n\t\t\tSELECT d_date\n\t\t\tFROM date_dim\n\t\t\tWHERE d_week_seq = (\n\t\t\t\tSELECT d_week_seq\n\t\t\t\tFROM date_dim\n\t\t\t\tWHERE d_date = '2001-06-16'\n\t\t\t)\n\t\t)\n\t\tAND cs_sold_date_sk = d_date_sk\n\tGROUP BY\n\t\ti_item_id\n),\nws_items AS (\n\tSELECT\n\t\ti_item_id AS item_id,\n\t\tSUM(ws_ext_sales_price) AS ws_item_rev\n\tFROM\n\t\tweb_sales,\n\t\titem,\n\t\tdate_dim\n\tWHERE\n\t\tws_item_sk = i_item_sk\n\t\tAND d_date IN (\n\t\t\tSELECT d_date\n\t\t\tFROM date_dim\n\t\t\tWHERE d_week_seq = (\n\t\t\t\tSELECT d_week_seq\n\t\t\t\tFROM date_dim\n\t\t\t\tWHERE d_date = '2001-06-16'\n\t\t\t)\n\t\t)\n\t\tAND ws_sold_date_sk = d_date_sk\n\tGROUP BY\n\t\ti_item_id\n)\nSELECT\n\tss_items.item_id,\n\tss_item_rev,\n\tss_item_rev / ((ss_item_rev + cs_item_rev + ws_item_rev) / 3) * 100 AS ss_dev,\n\tcs_item_rev,\n\tcs_item_rev / ((ss_item_rev + cs_item_rev + ws_item_rev) / 3) * 100 AS cs_dev,\n\tws_item_rev,\n\tws_item_rev / ((ss_item_rev + cs_item_rev + ws_item_rev) / 3) * 100 AS ws_dev,\n\t(ss_item_rev + cs_item_rev + ws_item_rev) / 3 AS average\nFROM\n\tss_items,\n\tcs_items,\n\tws_items\nWHERE\n\tss_items.item_id = cs_items.item_id\n\tAND ss_items.item_id = ws_items.item_id\n\tAND ss_item_rev BETWEEN 0.9 * cs_item_rev AND 1.1 * cs_item_rev\n\tAND ss_item_rev BETWEEN 0.9 * ws_item_rev AND 1.1 * ws_item_rev\n\tAND cs_item_rev BETWEEN 0.9 * ss_item_rev AND 1.1 * ss_item_rev\n\tAND cs_item_rev BETWEEN 0.9 * ws_item_rev AND 1.1 * ws_item_rev\n\tAND ws_item_rev BETWEEN 0.9 * ss_item_rev AND 1.1 * ss_item_rev\n\tAND ws_item_rev BETWEEN 0.9 * cs_item_rev AND 1.1 * cs_item_rev\nORDER BY\n\titem_id,\n\tss_item_rev\nLIMIT 100;\n",
    "61": "/* TPC-DS Query 59 */\n\nWITH wss AS (\n\tSELECT\n\t\td_week_seq,\n\t\tss_store_sk,\n\t\tSUM(CASE WHEN (d_day_name = 'Sunday') THEN ss_sales_price ELSE NULL END) AS sun_sales,\n\t\tSUM(CASE WHEN (d_day_name = 'Monday') THEN ss_sales_price ELSE NULL END) AS mon_sales,\n\t\tSUM(CASE WHEN (d_day_name = 'Tuesday') THEN ss_sales_price ELSE NULL END) AS tue_sales,\n\t\tSUM(CASE WHEN (d_day_name = 'Wednesday') THEN ss_sales_price ELSE NULL END) AS wed_sales,\n\t\tSUM(CASE WHEN (d_day_name = 'Thursday') THEN ss_sales_price ELSE NULL END) AS thu_sales,\n\t\tSUM(CASE WHEN (d_day_name = 'Friday') THEN ss_sales_price ELSE NULL END) AS fri_sales,\n\t\tSUM(CASE WHEN (d_day_name = 'Saturday') THEN ss_sales_price ELSE NULL END) AS sat_sales\n\tFROM\n\t\tstore_sales,\n\t\tdate_dim\n\tWHERE\n\t\td_date_sk = ss_sold_date_sk\n\tGROUP BY\n\t\td_week_seq,\n\t\tss_store_sk\n),\nstore_weekly_sales AS (\n\tSELECT\n\t\ts_store_name AS s_store_name1,\n\t\ts_store_id AS s_store_id1,\n\t\twss.d_week_seq AS d_week_seq1,\n\t\tsun_sales AS sun_sales1,\n\t\tmon_sales AS mon_sales1,\n\t\ttue_sales AS tue_sales1,\n\t\twed_sales AS wed_sales1,\n\t\tthu_sales AS thu_sales1,\n\t\tfri_sales AS fri_sales1,\n\t\tsat_sales AS sat_sales1\n\tFROM\n\t\twss,\n\t\tstore,\n\t\tdate_dim d\n\tWHERE\n\t\td.d_week_seq = wss.d_week_seq\n\t\tAND ss_store_sk = s_store_sk\n\t\tAND d_month_seq BETWEEN 1195 AND 1195 + 11\n),\nstore_weekly_comparison AS (\n\tSELECT\n\t\ts_store_name AS s_store_name2,\n\t\ts_store_id AS s_store_id2,\n\t\twss.d_week_seq AS d_week_seq2,\n\t\tsun_sales AS sun_sales2,\n\t\tmon_sales AS mon_sales2,\n\t\ttue_sales AS tue_sales2,\n\t\twed_sales AS wed_sales2,\n\t\tthu_sales AS thu_sales2,\n\t\tfri_sales AS fri_sales2,\n\t\tsat_sales AS sat_sales2\n\tFROM\n\t\twss,\n\t\tstore,\n\t\tdate_dim d\n\tWHERE\n\t\td.d_week_seq = wss.d_week_seq\n\t\tAND ss_store_sk = s_store_sk\n\t\tAND d_month_seq BETWEEN 1195 + 12 AND 1195 + 23\n)\nSELECT\n\ts_store_name1,\n\ts_store_id1,\n\td_week_seq1,\n\tsun_sales1 / sun_sales2 AS sun_sales_ratio,\n\tmon_sales1 / mon_sales2 AS mon_sales_ratio,\n\ttue_sales1 / tue_sales2 AS tue_sales_ratio,\n\twed_sales1 / wed_sales2 AS wed_sales_ratio,\n\tthu_sales1 / thu_sales2 AS thu_sales_ratio,\n\tfri_sales1 / fri_sales2 AS fri_sales_ratio,\n\tsat_sales1 / sat_sales2 AS sat_sales_ratio\nFROM\n\tstore_weekly_sales y,\n\tstore_weekly_comparison x\nWHERE\n\ts_store_id1 = s_store_id2\n\tAND d_week_seq1 = d_week_seq2 - 52\nORDER BY\n\ts_store_name1,\n\ts_store_id1,\n\td_week_seq1\nLIMIT 100;\n",
    "62": "/* TPC-DS Query 60 */\n\nWITH ss AS (\n\tSELECT\n\t\ti_item_id,\n\t\tSUM(ss_ext_sales_price) AS total_sales\n\tFROM\n\t\tstore_sales,\n\t\tdate_dim,\n\t\tcustomer_address,\n\t\titem\n\tWHERE\n\t\ti_item_id IN (\n\t\t\tSELECT i_item_id\n\t\t\tFROM item\n\t\t\tWHERE i_category IN ('Jewelry')\n\t\t)\n\t\tAND ss_item_sk = i_item_sk\n\t\tAND ss_sold_date_sk = d_date_sk\n\t\tAND d_year = 2000\n\t\tAND d_moy = 10\n\t\tAND ss_addr_sk = ca_address_sk\n\t\tAND ca_gmt_offset = -5\n\tGROUP BY i_item_id\n),\ncs AS (\n\tSELECT\n\t\ti_item_id,\n\t\tSUM(cs_ext_sales_price) AS total_sales\n\tFROM\n\t\tcatalog_sales,\n\t\tdate_dim,\n\t\tcustomer_address,\n\t\titem\n\tWHERE\n\t\ti_item_id IN (\n\t\t\tSELECT i_item_id\n\t\t\tFROM item\n\t\t\tWHERE i_category IN ('Jewelry')\n\t\t)\n\t\tAND cs_item_sk = i_item_sk\n\t\tAND cs_sold_date_sk = d_date_sk\n\t\tAND d_year = 2000\n\t\tAND d_moy = 10\n\t\tAND cs_bill_addr_sk = ca_address_sk\n\t\tAND ca_gmt_offset = -5\n\tGROUP BY i_item_id\n),\nws AS (\n\tSELECT\n\t\ti_item_id,\n\t\tSUM(ws_ext_sales_price) AS total_sales\n\tFROM\n\t\tweb_sales,\n\t\tdate_dim,\n\t\tcustomer_address,\n\t\titem\n\tWHERE\n\t\ti_item_id IN (\n\t\t\tSELECT i_item_id\n\t\t\tFROM item\n\t\t\tWHERE i_category IN ('Jewelry')\n\t\t)\n\t\tAND ws_item_sk = i_item_sk\n\t\tAND ws_sold_date_sk = d_date_sk\n\t\tAND d_year = 2000\n\t\tAND d_moy = 10\n\t\tAND ws_bill_addr_sk = ca_address_sk\n\t\tAND ca_gmt_offset = -5\n\tGROUP BY i_item_id\n)\nSELECT\n\ti_item_id,\n\tSUM(total_sales) AS total_sales\nFROM (\n\tSELECT * FROM ss\n\tUNION ALL\n\tSELECT * FROM cs\n\tUNION ALL\n\tSELECT * FROM ws\n) tmp1\nGROUP BY i_item_id\nORDER BY i_item_id,\n\ttotal_sales\nLIMIT 100;\n",
    "63": "/* TPC-DS Query 61 */\n\nSELECT \n\tpromotions,\n\ttotal,\n\tCAST(promotions AS DECIMAL(15,4)) / CAST(total AS DECIMAL(15,4)) * 100 AS promo_percentage\nFROM (\n\tSELECT SUM(ss_ext_sales_price) AS promotions\n\tFROM store_sales\n\t\t,store\n\t\t,promotion\n\t\t,date_dim\n\t\t,customer\n\t\t,customer_address\n\t\t,item\n\tWHERE ss_sold_date_sk = d_date_sk\n\t  AND ss_store_sk = s_store_sk\n\t  AND ss_promo_sk = p_promo_sk\n\t  AND ss_customer_sk = c_customer_sk\n\t  AND ca_address_sk = c_current_addr_sk\n\t  AND ss_item_sk = i_item_sk\n\t  AND ca_gmt_offset = -7\n\t  AND i_category = 'Home'\n\t  AND (p_channel_dmail = 'Y' OR p_channel_email = 'Y' OR p_channel_tv = 'Y')\n\t  AND s_gmt_offset = -7\n\t  AND d_year = 2000\n\t  AND d_moy = 12\n) promotional_sales,\n(\n\tSELECT SUM(ss_ext_sales_price) AS total\n\tFROM store_sales\n\t\t,store\n\t\t,date_dim\n\t\t,customer\n\t\t,customer_address\n\t\t,item\n\tWHERE ss_sold_date_sk = d_date_sk\n\t  AND ss_store_sk = s_store_sk\n\t  AND ss_customer_sk = c_customer_sk\n\t  AND ca_address_sk = c_current_addr_sk\n\t  AND ss_item_sk = i_item_sk\n\t  AND ca_gmt_offset = -7\n\t  AND i_category = 'Home'\n\t  AND s_gmt_offset = -7\n\t  AND d_year = 2000\n\t  AND d_moy = 12\n) all_sales\nORDER BY promotions, total\nLIMIT 100;\n",
    "64": "/* TPC-DS Query 62 */\n\nSELECT \n\tSUBSTR(w_warehouse_name,1,20) AS warehouse_name,\n\tsm_type,\n\tweb_name,\n\tSUM(CASE WHEN (ws_ship_date_sk - ws_sold_date_sk <= 30) THEN 1 ELSE 0 END) AS \"30 days\",\n\tSUM(CASE WHEN (ws_ship_date_sk - ws_sold_date_sk > 30) AND (ws_ship_date_sk - ws_sold_date_sk <= 60) THEN 1 ELSE 0 END) AS \"31-60 days\",\n\tSUM(CASE WHEN (ws_ship_date_sk - ws_sold_date_sk > 60) AND (ws_ship_date_sk - ws_sold_date_sk <= 90) THEN 1 ELSE 0 END) AS \"61-90 days\",\n\tSUM(CASE WHEN (ws_ship_date_sk - ws_sold_date_sk > 90) AND (ws_ship_date_sk - ws_sold_date_sk <= 120) THEN 1 ELSE 0 END) AS \"91-120 days\",\n\tSUM(CASE WHEN (ws_ship_date_sk - ws_sold_date_sk > 120) THEN 1 ELSE 0 END) AS \">120 days\"\nFROM\n\tweb_sales\n\t,warehouse\n\t,ship_mode\n\t,web_site\n\t,date_dim\nWHERE\n\td_month_seq BETWEEN 1223 AND 1223 + 11\n\tAND ws_ship_date_sk = d_date_sk\n\tAND ws_warehouse_sk = w_warehouse_sk\n\tAND ws_ship_mode_sk = sm_ship_mode_sk\n\tAND ws_web_site_sk = web_site_sk\nGROUP BY\n\tSUBSTR(w_warehouse_name,1,20),\n\tsm_type,\n\tweb_name\nORDER BY \n\tSUBSTR(w_warehouse_name,1,20),\n\tsm_type,\n\tweb_name\nLIMIT 100;\n",
    "65": "/* TPC-DS Query 63 */\n\nSELECT *\nFROM (\n\tSELECT \n\t\ti_manager_id,\n\t\tSUM(ss_sales_price) AS sum_sales,\n\t\tAVG(SUM(ss_sales_price)) OVER (PARTITION BY i_manager_id) AS avg_monthly_sales\n\tFROM \n\t\titem,\n\t\tstore_sales,\n\t\tdate_dim,\n\t\tstore\n\tWHERE \n\t\tss_item_sk = i_item_sk\n\t\tAND ss_sold_date_sk = d_date_sk\n\t\tAND ss_store_sk = s_store_sk\n\t\tAND d_month_seq IN (1222, 1222 + 1, 1222 + 2, 1222 + 3, 1222 + 4, 1222 + 5, 1222 + 6, 1222 + 7, 1222 + 8, 1222 + 9, 1222 + 10, 1222 + 11)\n\t\tAND ((\n\t\t\ti_category IN ('Books', 'Children', 'Electronics')\n\t\t\tAND i_class IN ('personal', 'portable', 'reference', 'self-help')\n\t\t\tAND i_brand IN ('scholaramalgamalg #14', 'scholaramalgamalg #7', 'exportiunivamalg #9', 'scholaramalgamalg #9')\n\t\t)\n\t\tOR (\n\t\t\ti_category IN ('Women', 'Music', 'Men')\n\t\t\tAND i_class IN ('accessories', 'classical', 'fragrances', 'pants')\n\t\t\tAND i_brand IN ('amalgimporto #1', 'edu packscholar #1', 'exportiimporto #1', 'importoamalg #1')\n\t\t))\n\tGROUP BY \n\t\ti_manager_id, d_moy\n) tmp1\nWHERE \n\tCASE \n\t\tWHEN avg_monthly_sales > 0 THEN ABS(sum_sales - avg_monthly_sales) / avg_monthly_sales \n\t\tELSE NULL \n\tEND > 0.1\nORDER BY \n\ti_manager_id,\n\tavg_monthly_sales,\n\tsum_sales\nLIMIT 100;\n",
    "66": "/* TPC-DS Query 64 */\n\nWITH cs_ui AS (\n\tSELECT \n\t\tcs_item_sk,\n\t\tSUM(cs_ext_list_price) AS sale,\n\t\tSUM(cr_refunded_cash + cr_reversed_charge + cr_store_credit) AS refund\n\tFROM \n\t\tcatalog_sales,\n\t\tcatalog_returns\n\tWHERE \n\t\tcs_item_sk = cr_item_sk\n\t\tAND cs_order_number = cr_order_number\n\tGROUP BY \n\t\tcs_item_sk\n\tHAVING SUM(cs_ext_list_price) > 2 * SUM(cr_refunded_cash + cr_reversed_charge + cr_store_credit)\n),\ncross_sales AS (\n\tSELECT \n\t\ti_product_name AS product_name,\n\t\ti_item_sk AS item_sk,\n\t\ts_store_name AS store_name,\n\t\ts_zip AS store_zip,\n\t\tad1.ca_street_number AS b_street_number,\n\t\tad1.ca_street_name AS b_street_name,\n\t\tad1.ca_city AS b_city,\n\t\tad1.ca_zip AS b_zip,\n\t\tad2.ca_street_number AS c_street_number,\n\t\tad2.ca_street_name AS c_street_name,\n\t\tad2.ca_city AS c_city,\n\t\tad2.ca_zip AS c_zip,\n\t\td1.d_year AS syear,\n\t\td2.d_year AS fsyear,\n\t\td3.d_year AS s2year,\n\t\tCOUNT(*) AS cnt,\n\t\tSUM(ss_wholesale_cost) AS s1,\n\t\tSUM(ss_list_price) AS s2,\n\t\tSUM(ss_coupon_amt) AS s3\n\tFROM \n\t\tstore_sales,\n\t\tstore_returns,\n\t\tcs_ui,\n\t\tdate_dim d1,\n\t\tdate_dim d2,\n\t\tdate_dim d3,\n\t\tstore,\n\t\tcustomer,\n\t\tcustomer_demographics cd1,\n\t\tcustomer_demographics cd2,\n\t\tpromotion,\n\t\thousehold_demographics hd1,\n\t\thousehold_demographics hd2,\n\t\tcustomer_address ad1,\n\t\tcustomer_address ad2,\n\t\tincome_band ib1,\n\t\tincome_band ib2,\n\t\titem\n\tWHERE \n\t\tss_store_sk = s_store_sk\n\t\tAND ss_sold_date_sk = d1.d_date_sk\n\t\tAND ss_customer_sk = c_customer_sk\n\t\tAND ss_cdemo_sk = cd1.cd_demo_sk\n\t\tAND ss_hdemo_sk = hd1.hd_demo_sk\n\t\tAND ss_addr_sk = ad1.ca_address_sk\n\t\tAND ss_item_sk = i_item_sk\n\t\tAND ss_item_sk = sr_item_sk\n\t\tAND ss_ticket_number = sr_ticket_number\n\t\tAND ss_item_sk = cs_ui.cs_item_sk\n\t\tAND c_current_cdemo_sk = cd2.cd_demo_sk\n\t\tAND c_current_hdemo_sk = hd2.hd_demo_sk\n\t\tAND c_current_addr_sk = ad2.ca_address_sk\n\t\tAND c_first_sales_date_sk = d2.d_date_sk\n\t\tAND c_first_shipto_date_sk = d3.d_date_sk\n\t\tAND ss_promo_sk = p_promo_sk\n\t\tAND hd1.hd_income_band_sk = ib1.ib_income_band_sk\n\t\tAND hd2.hd_income_band_sk = ib2.ib_income_band_sk\n\t\tAND cd1.cd_marital_status <> cd2.cd_marital_status\n\t\tAND i_color IN ('orange', 'lace', 'lawn', 'misty', 'blush', 'pink')\n\t\tAND i_current_price BETWEEN 48 AND 48 + 10\n\t\tAND i_current_price BETWEEN 48 + 1 AND 48 + 15\n\tGROUP BY \n\t\ti_product_name,\n\t\ti_item_sk,\n\t\ts_store_name,\n\t\ts_zip,\n\t\tad1.ca_street_number,\n\t\tad1.ca_street_name,\n\t\tad1.ca_city,\n\t\tad1.ca_zip,\n\t\tad2.ca_street_number,\n\t\tad2.ca_street_name,\n\t\tad2.ca_city,\n\t\tad2.ca_zip,\n\t\td1.d_year,\n\t\td2.d_year,\n\t\td3.d_year\n)\nSELECT \n\tcs1.product_name,\n\tcs1.store_name,\n\tcs1.store_zip,\n\tcs1.b_street_number,\n\tcs1.b_street_name,\n\tcs1.b_city,\n\tcs1.b_zip,\n\tcs1.c_street_number,\n\tcs1.c_street_name,\n\tcs1.c_city,\n\tcs1.c_zip,\n\tcs1.syear,\n\tcs1.cnt,\n\tcs1.s1 AS s11,\n\tcs1.s2 AS s21,\n\tcs1.s3 AS s31,\n\tcs2.s1 AS s12,\n\tcs2.s2 AS s22,\n\tcs2.s3 AS s32,\n\tcs2.syear,\n\tcs2.cnt\nFROM \n\tcross_sales cs1,\n\tcross_sales cs2\nWHERE \n\tcs1.item_sk = cs2.item_sk\n\tAND cs1.syear = 1999\n\tAND cs2.syear = 1999 + 1\n\tAND cs2.cnt <= cs1.cnt\n\tAND cs1.store_name = cs2.store_name\n\tAND cs1.store_zip = cs2.store_zip\nORDER BY \n\tcs1.product_name,\n\tcs1.store_name,\n\tcs2.cnt,\n\tcs1.s1,\n\tcs2.s1;\n",
    "67": "/* TPC-DS Query 65 */\n\nSELECT \n\ts_store_name,\n\ti_item_desc,\n\tsc.revenue,\n\ti_current_price,\n\ti_wholesale_cost,\n\ti_brand\nFROM \n\tstore,\n\titem,\n\t(SELECT \n\t\tss_store_sk, \n\t\tAVG(revenue) AS ave\n\t FROM\n\t\t(SELECT \n\t\t\tss_store_sk, \n\t\t\tss_item_sk, \n\t\t\tSUM(ss_sales_price) AS revenue\n\t\t FROM \n\t\t\tstore_sales,\n\t\t\tdate_dim\n\t\t WHERE \n\t\t\tss_sold_date_sk = d_date_sk \n\t\t\tAND d_month_seq BETWEEN 1176 AND 1176 + 11\n\t\t GROUP BY \n\t\t\tss_store_sk, \n\t\t\tss_item_sk) sa\n\t GROUP BY \n\t\tss_store_sk) sb,\n\t(SELECT \n\t\tss_store_sk, \n\t\tss_item_sk, \n\t\tSUM(ss_sales_price) AS revenue\n\t FROM \n\t\tstore_sales,\n\t\tdate_dim\n\t WHERE \n\t\tss_sold_date_sk = d_date_sk \n\t\tAND d_month_seq BETWEEN 1176 AND 1176 + 11\n\t GROUP BY \n\t\tss_store_sk, \n\t\tss_item_sk) sc\nWHERE \n\tsb.ss_store_sk = sc.ss_store_sk \n\tAND sc.revenue <= 0.1 * sb.ave \n\tAND s_store_sk = sc.ss_store_sk \n\tAND i_item_sk = sc.ss_item_sk\nORDER BY \n\ts_store_name, \n\ti_item_desc\nLIMIT 100;\n",
    "68": "/* TPC-DS Query 66 */\n\nSELECT\n\tw_warehouse_name,\n\tw_warehouse_sq_ft,\n\tw_city,\n\tw_county,\n\tw_state,\n\tw_country,\n\tship_carriers,\n\tyear,\n\tSUM(jan_sales) AS jan_sales,\n\tSUM(feb_sales) AS feb_sales,\n\tSUM(mar_sales) AS mar_sales,\n\tSUM(apr_sales) AS apr_sales,\n\tSUM(may_sales) AS may_sales,\n\tSUM(jun_sales) AS jun_sales,\n\tSUM(jul_sales) AS jul_sales,\n\tSUM(aug_sales) AS aug_sales,\n\tSUM(sep_sales) AS sep_sales,\n\tSUM(oct_sales) AS oct_sales,\n\tSUM(nov_sales) AS nov_sales,\n\tSUM(dec_sales) AS dec_sales,\n\tSUM(jan_sales / w_warehouse_sq_ft) AS jan_sales_per_sq_foot,\n\tSUM(feb_sales / w_warehouse_sq_ft) AS feb_sales_per_sq_foot,\n\tSUM(mar_sales / w_warehouse_sq_ft) AS mar_sales_per_sq_foot,\n\tSUM(apr_sales / w_warehouse_sq_ft) AS apr_sales_per_sq_foot,\n\tSUM(may_sales / w_warehouse_sq_ft) AS may_sales_per_sq_foot,\n\tSUM(jun_sales / w_warehouse_sq_ft) AS jun_sales_per_sq_foot,\n\tSUM(jul_sales / w_warehouse_sq_ft) AS jul_sales_per_sq_foot,\n\tSUM(aug_sales / w_warehouse_sq_ft) AS aug_sales_per_sq_foot,\n\tSUM(sep_sales / w_warehouse_sq_ft) AS sep_sales_per_sq_foot,\n\tSUM(oct_sales / w_warehouse_sq_ft) AS oct_sales_per_sq_foot,\n\tSUM(nov_sales / w_warehouse_sq_ft) AS nov_sales_per_sq_foot,\n\tSUM(dec_sales / w_warehouse_sq_ft) AS dec_sales_per_sq_foot,\n\tSUM(jan_net) AS jan_net,\n\tSUM(feb_net) AS feb_net,\n\tSUM(mar_net) AS mar_net,\n\tSUM(apr_net) AS apr_net,\n\tSUM(may_net) AS may_net,\n\tSUM(jun_net) AS jun_net,\n\tSUM(jul_net) AS jul_net,\n\tSUM(aug_net) AS aug_net,\n\tSUM(sep_net) AS sep_net,\n\tSUM(oct_net) AS oct_net,\n\tSUM(nov_net) AS nov_net,\n\tSUM(dec_net) AS dec_net\nFROM (\n\tSELECT\n\t\tw_warehouse_name,\n\t\tw_warehouse_sq_ft,\n\t\tw_city,\n\t\tw_county,\n\t\tw_state,\n\t\tw_country,\n\t\t'ORIENTAL' || ',' || 'BOXBUNDLES' AS ship_carriers,\n\t\td_year AS year,\n\t\tSUM(CASE WHEN d_moy = 1 THEN ws_ext_sales_price * ws_quantity ELSE 0 END) AS jan_sales,\n\t\tSUM(CASE WHEN d_moy = 2 THEN ws_ext_sales_price * ws_quantity ELSE 0 END) AS feb_sales,\n\t\tSUM(CASE WHEN d_moy = 3 THEN ws_ext_sales_price * ws_quantity ELSE 0 END) AS mar_sales,\n\t\tSUM(CASE WHEN d_moy = 4 THEN ws_ext_sales_price * ws_quantity ELSE 0 END) AS apr_sales,\n\t\tSUM(CASE WHEN d_moy = 5 THEN ws_ext_sales_price * ws_quantity ELSE 0 END) AS may_sales,\n\t\tSUM(CASE WHEN d_moy = 6 THEN ws_ext_sales_price * ws_quantity ELSE 0 END) AS jun_sales,\n\t\tSUM(CASE WHEN d_moy = 7 THEN ws_ext_sales_price * ws_quantity ELSE 0 END) AS jul_sales,\n\t\tSUM(CASE WHEN d_moy = 8 THEN ws_ext_sales_price * ws_quantity ELSE 0 END) AS aug_sales,\n\t\tSUM(CASE WHEN d_moy = 9 THEN ws_ext_sales_price * ws_quantity ELSE 0 END) AS sep_sales,\n\t\tSUM(CASE WHEN d_moy = 10 THEN ws_ext_sales_price * ws_quantity ELSE 0 END) AS oct_sales,\n\t\tSUM(CASE WHEN d_moy = 11 THEN ws_ext_sales_price * ws_quantity ELSE 0 END) AS nov_sales,\n\t\tSUM(CASE WHEN d_moy = 12 THEN ws_ext_sales_price * ws_quantity ELSE 0 END) AS dec_sales,\n\t\tSUM(CASE WHEN d_moy = 1 THEN ws_net_paid_inc_ship * ws_quantity ELSE 0 END) AS jan_net,\n\t\tSUM(CASE WHEN d_moy = 2 THEN ws_net_paid_inc_ship * ws_quantity ELSE 0 END) AS feb_net,\n\t\tSUM(CASE WHEN d_moy = 3 THEN ws_net_paid_inc_ship * ws_quantity ELSE 0 END) AS mar_net,\n\t\tSUM(CASE WHEN d_moy = 4 THEN ws_net_paid_inc_ship * ws_quantity ELSE 0 END) AS apr_net,\n\t\tSUM(CASE WHEN d_moy = 5 THEN ws_net_paid_inc_ship * ws_quantity ELSE 0 END) AS may_net,\n\t\tSUM(CASE WHEN d_moy = 6 THEN ws_net_paid_inc_ship * ws_quantity ELSE 0 END) AS jun_net,\n\t\tSUM(CASE WHEN d_moy = 7 THEN ws_net_paid_inc_ship * ws_quantity ELSE 0 END) AS jul_net,\n\t\tSUM(CASE WHEN d_moy = 8 THEN ws_net_paid_inc_ship * ws_quantity ELSE 0 END) AS aug_net,\n\t\tSUM(CASE WHEN d_moy = 9 THEN ws_net_paid_inc_ship * ws_quantity ELSE 0 END) AS sep_net,\n\t\tSUM(CASE WHEN d_moy = 10 THEN ws_net_paid_inc_ship * ws_quantity ELSE 0 END) AS oct_net,\n\t\tSUM(CASE WHEN d_moy = 11 THEN ws_net_paid_inc_ship * ws_quantity ELSE 0 END) AS nov_net,\n\t\tSUM(CASE WHEN d_moy = 12 THEN ws_net_paid_inc_ship * ws_quantity ELSE 0 END) AS dec_net\n\tFROM\n\t\tweb_sales,\n\t\twarehouse,\n\t\tdate_dim,\n\t\ttime_dim,\n\t\tship_mode\n\tWHERE\n\t\tws_warehouse_sk = w_warehouse_sk\n\t\tAND ws_sold_date_sk = d_date_sk\n\t\tAND ws_sold_time_sk = t_time_sk\n\t\tAND ws_ship_mode_sk = sm_ship_mode_sk\n\t\tAND d_year = 2001\n\t\tAND t_time BETWEEN 42970 AND 42970 + 28800\n\t\tAND sm_carrier IN ('ORIENTAL', 'BOXBUNDLES')\n\tGROUP BY\n\t\tw_warehouse_name,\n\t\tw_warehouse_sq_ft,\n\t\tw_city,\n\t\tw_county,\n\t\tw_state,\n\t\tw_country,\n\t\td_year\n) x\nGROUP BY\n\tw_warehouse_name,\n\tw_warehouse_sq_ft,\n\tw_city,\n\tw_county,\n\tw_state,\n\tw_country,\n\tship_carriers,\n\tyear\nORDER BY\n\tw_warehouse_name\nLIMIT 100;\n",
    "69": "/* TPC-DS Query 67 */\n\nSELECT\n\t*\nFROM (\n\tSELECT\n\t\ti_category,\n\t\ti_class,\n\t\ti_brand,\n\t\ti_product_name,\n\t\td_year,\n\t\td_qoy,\n\t\td_moy,\n\t\ts_store_id,\n\t\tsumsales,\n\t\tRANK() OVER (PARTITION BY i_category ORDER BY sumsales DESC) AS rk\n\tFROM (\n\t\tSELECT\n\t\t\ti_category,\n\t\t\ti_class,\n\t\t\ti_brand,\n\t\t\ti_product_name,\n\t\t\td_year,\n\t\t\td_qoy,\n\t\t\td_moy,\n\t\t\ts_store_id,\n\t\t\tSUM(COALESCE(ss_sales_price * ss_quantity, 0)) AS sumsales\n\t\tFROM\n\t\t\tstore_sales,\n\t\t\tdate_dim,\n\t\t\tstore,\n\t\t\titem\n\t\tWHERE\n\t\t\tss_sold_date_sk = d_date_sk\n\t\t\tAND ss_item_sk = i_item_sk\n\t\t\tAND ss_store_sk = s_store_sk\n\t\t\tAND d_month_seq BETWEEN 1217 AND 1217 + 11\n\t\tGROUP BY\n\t\t\tROLLUP(i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, s_store_id)\n\t) dw1\n) dw2\nWHERE\n\trk <= 100\nORDER BY\n\ti_category,\n\ti_class,\n\ti_brand,\n\ti_product_name,\n\td_year,\n\td_qoy,\n\td_moy,\n\ts_store_id,\n\tsumsales,\n\trk\nLIMIT 100;\n",
    "70": "/* TPC-DS Query 68 */\n\nSELECT\n\tc_last_name,\n\tc_first_name,\n\tca_city,\n\tbought_city,\n\tss_ticket_number,\n\textended_price,\n\textended_tax,\n\tlist_price\nFROM (\n\tSELECT\n\t\tss_ticket_number,\n\t\tss_customer_sk,\n\t\tca_city AS bought_city,\n\t\tSUM(ss_ext_sales_price) AS extended_price,\n\t\tSUM(ss_ext_list_price) AS list_price,\n\t\tSUM(ss_ext_tax) AS extended_tax\n\tFROM\n\t\tstore_sales,\n\t\tdate_dim,\n\t\tstore,\n\t\thousehold_demographics,\n\t\tcustomer_address\n\tWHERE\n\t\tstore_sales.ss_sold_date_sk = date_dim.d_date_sk\n\t\tAND store_sales.ss_store_sk = store.s_store_sk\n\t\tAND store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n\t\tAND store_sales.ss_addr_sk = customer_address.ca_address_sk\n\t\tAND date_dim.d_dom BETWEEN 1 AND 2\n\t\tAND (\n\t\t\thousehold_demographics.hd_dep_count = 3\n\t\t\tOR household_demographics.hd_vehicle_count = 4\n\t\t)\n\t\tAND date_dim.d_year IN (1998, 1998 + 1, 1998 + 2)\n\t\tAND store.s_city IN ('Fairview', 'Midway')\n\tGROUP BY\n\t\tss_ticket_number,\n\t\tss_customer_sk,\n\t\tss_addr_sk,\n\t\tca_city\n) dn,\ncustomer,\ncustomer_address current_addr\nWHERE\n\tss_customer_sk = c_customer_sk\n\tAND customer.c_current_addr_sk = current_addr.ca_address_sk\n\tAND current_addr.ca_city <> bought_city\nORDER BY\n\tc_last_name,\n\tss_ticket_number\nLIMIT 100;\n",
    "71": "/* TPC-DS Query 69 */\n\nSELECT\n\tcd_gender,\n\tcd_marital_status,\n\tcd_education_status,\n\tCOUNT(*) AS cnt1,\n\tcd_purchase_estimate,\n\tCOUNT(*) AS cnt2,\n\tcd_credit_rating,\n\tCOUNT(*) AS cnt3\nFROM\n\tcustomer c,\n\tcustomer_address ca,\n\tcustomer_demographics\nWHERE\n\tc.c_current_addr_sk = ca.ca_address_sk\n\tAND ca_state IN ('IL', 'TX', 'ME')\n\tAND cd_demo_sk = c.c_current_cdemo_sk\n\tAND EXISTS (\n\t\tSELECT\n\t\t\t*\n\t\tFROM\n\t\t\tstore_sales,\n\t\t\tdate_dim\n\t\tWHERE\n\t\t\tc.c_customer_sk = ss_customer_sk\n\t\t\tAND ss_sold_date_sk = d_date_sk\n\t\t\tAND d_year = 2002\n\t\t\tAND d_moy BETWEEN 1 AND 1 + 2\n\t)\n\tAND NOT EXISTS (\n\t\tSELECT\n\t\t\t*\n\t\tFROM\n\t\t\tweb_sales,\n\t\t\tdate_dim\n\t\tWHERE\n\t\t\tc.c_customer_sk = ws_bill_customer_sk\n\t\t\tAND ws_sold_date_sk = d_date_sk\n\t\t\tAND d_year = 2002\n\t\t\tAND d_moy BETWEEN 1 AND 1 + 2\n\t)\n\tAND NOT EXISTS (\n\t\tSELECT\n\t\t\t*\n\t\tFROM\n\t\t\tcatalog_sales,\n\t\t\tdate_dim\n\t\tWHERE\n\t\t\tc.c_customer_sk = cs_ship_customer_sk\n\t\t\tAND cs_sold_date_sk = d_date_sk\n\t\t\tAND d_year = 2002\n\t\t\tAND d_moy BETWEEN 1 AND 1 + 2\n\t)\nGROUP BY\n\tcd_gender,\n\tcd_marital_status,\n\tcd_education_status,\n\tcd_purchase_estimate,\n\tcd_credit_rating\nORDER BY\n\tcd_gender,\n\tcd_marital_status,\n\tcd_education_status,\n\tcd_purchase_estimate,\n\tcd_credit_rating\nLIMIT 100;\n",
    "72": "/* TPC-DS Query 70 */\n\nSELECT\n\t*\nFROM (\n\tSELECT\n\t\tSUM(ss_net_profit) AS total_sum,\n\t\ts_state,\n\t\ts_county,\n\t\tGROUPING(s_state) + GROUPING(s_county) AS lochierarchy,\n\t\tRANK() OVER (\n\t\t\tPARTITION BY GROUPING(s_state) + GROUPING(s_county),\n\t\t\tCASE WHEN GROUPING(s_county) = 0 THEN s_state END\n\t\t\tORDER BY SUM(ss_net_profit) DESC\n\t\t) AS rank_within_parent\n\tFROM\n\t\tstore_sales,\n\t\tdate_dim d1,\n\t\tstore\n\tWHERE\n\t\td1.d_month_seq BETWEEN 1220 AND 1220 + 11\n\t\tAND d1.d_date_sk = ss_sold_date_sk\n\t\tAND s_store_sk = ss_store_sk\n\t\tAND s_state IN (\n\t\t\tSELECT\n\t\t\t\ts_state\n\t\t\tFROM (\n\t\t\t\tSELECT\n\t\t\t\t\ts_state AS s_state,\n\t\t\t\t\tRANK() OVER (\n\t\t\t\t\t\tPARTITION BY s_state\n\t\t\t\t\t\tORDER BY SUM(ss_net_profit) DESC\n\t\t\t\t\t) AS ranking\n\t\t\t\tFROM\n\t\t\t\t\tstore_sales,\n\t\t\t\t\tstore,\n\t\t\t\t\tdate_dim\n\t\t\t\tWHERE\n\t\t\t\t\td_month_seq BETWEEN 1220 AND 1220 + 11\n\t\t\t\t\tAND d_date_sk = ss_sold_date_sk\n\t\t\t\t\tAND s_store_sk = ss_store_sk\n\t\t\t\tGROUP BY\n\t\t\t\t\ts_state\n\t\t\t) tmp1\n\t\t\tWHERE ranking <= 5\n\t\t)\n\tGROUP BY\n\t\tROLLUP(s_state, s_county)\n) AS sub\nORDER BY\n\tlochierarchy DESC,\n\tCASE WHEN lochierarchy = 0 THEN s_state END,\n\trank_within_parent\nLIMIT 100;\n",
    "73": "/* TPC-DS Query 71 */\n\nSELECT\n\ti_brand_id AS brand_id,\n\ti_brand AS brand,\n\tt_hour,\n\tt_minute,\n\tSUM(ext_price) AS ext_price\nFROM\n\titem,\n\t(\n\t\tSELECT\n\t\t\tws_ext_sales_price AS ext_price,\n\t\t\tws_sold_date_sk AS sold_date_sk,\n\t\t\tws_item_sk AS sold_item_sk,\n\t\t\tws_sold_time_sk AS time_sk\n\t\tFROM\n\t\t\tweb_sales,\n\t\t\tdate_dim\n\t\tWHERE\n\t\t\td_date_sk = ws_sold_date_sk\n\t\t\tAND d_moy = 12\n\t\t\tAND d_year = 2002\n\t\tUNION ALL\n\t\tSELECT\n\t\t\tcs_ext_sales_price AS ext_price,\n\t\t\tcs_sold_date_sk AS sold_date_sk,\n\t\t\tcs_item_sk AS sold_item_sk,\n\t\t\tcs_sold_time_sk AS time_sk\n\t\tFROM\n\t\t\tcatalog_sales,\n\t\t\tdate_dim\n\t\tWHERE\n\t\t\td_date_sk = cs_sold_date_sk\n\t\t\tAND d_moy = 12\n\t\t\tAND d_year = 2002\n\t\tUNION ALL\n\t\tSELECT\n\t\t\tss_ext_sales_price AS ext_price,\n\t\t\tss_sold_date_sk AS sold_date_sk,\n\t\t\tss_item_sk AS sold_item_sk,\n\t\t\tss_sold_time_sk AS time_sk\n\t\tFROM\n\t\t\tstore_sales,\n\t\t\tdate_dim\n\t\tWHERE\n\t\t\td_date_sk = ss_sold_date_sk\n\t\t\tAND d_moy = 12\n\t\t\tAND d_year = 2002\n\t) tmp,\n\ttime_dim\nWHERE\n\tsold_item_sk = i_item_sk\n\tAND i_manager_id = 1\n\tAND time_sk = t_time_sk\n\tAND (\n\t\tt_meal_time = 'breakfast'\n\t\tOR t_meal_time = 'dinner'\n\t)\nGROUP BY\n\ti_brand,\n\ti_brand_id,\n\tt_hour,\n\tt_minute\nORDER BY\n\text_price DESC,\n\ti_brand_id;\n",
    "74": "/* TPC-DS Query 72 */\n\nSELECT\n\ti_item_desc,\n\tw_warehouse_name,\n\td1.d_week_seq,\n\tSUM(CASE WHEN p_promo_sk IS NULL THEN 1 ELSE 0 END) AS no_promo,\n\tSUM(CASE WHEN p_promo_sk IS NOT NULL THEN 1 ELSE 0 END) AS promo,\n\tCOUNT(*) AS total_cnt\nFROM\n\tcatalog_sales\n\tJOIN inventory ON (cs_item_sk = inv_item_sk)\n\tJOIN warehouse ON (w_warehouse_sk = inv_warehouse_sk)\n\tJOIN item ON (i_item_sk = cs_item_sk)\n\tJOIN customer_demographics ON (cs_bill_cdemo_sk = cd_demo_sk)\n\tJOIN household_demographics ON (cs_bill_hdemo_sk = hd_demo_sk)\n\tJOIN date_dim d1 ON (cs_sold_date_sk = d1.d_date_sk)\n\tJOIN date_dim d2 ON (inv_date_sk = d2.d_date_sk)\n\tJOIN date_dim d3 ON (cs_ship_date_sk = d3.d_date_sk)\n\tLEFT OUTER JOIN promotion ON (cs_promo_sk = p_promo_sk)\n\tLEFT OUTER JOIN catalog_returns ON (cr_item_sk = cs_item_sk AND cr_order_number = cs_order_number)\nWHERE\n\td1.d_week_seq = d2.d_week_seq\n\tAND inv_quantity_on_hand < cs_quantity\n\tAND d3.d_date > d1.d_date + 5\n\tAND hd_buy_potential = '1001-5000'\n\tAND d1.d_year = 1998\n\tAND cd_marital_status = 'S'\nGROUP BY\n\ti_item_desc,\n\tw_warehouse_name,\n\td1.d_week_seq\nORDER BY\n\ttotal_cnt DESC,\n\ti_item_desc,\n\tw_warehouse_name,\n\td_week_seq\nLIMIT 100;\n",
    "75": "/* TPC-DS Query 73 */\n\nSELECT\n\tc_last_name,\n\tc_first_name,\n\tc_salutation,\n\tc_preferred_cust_flag,\n\tss_ticket_number,\n\tcnt\nFROM (\n\tSELECT\n\t\tss_ticket_number,\n\t\tss_customer_sk,\n\t\tCOUNT(*) AS cnt\n\tFROM\n\t\tstore_sales,\n\t\tdate_dim,\n\t\tstore,\n\t\thousehold_demographics\n\tWHERE\n\t\tstore_sales.ss_sold_date_sk = date_dim.d_date_sk\n\t\tAND store_sales.ss_store_sk = store.s_store_sk\n\t\tAND store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n\t\tAND date_dim.d_dom BETWEEN 1 AND 2\n\t\tAND (\n\t\t\thousehold_demographics.hd_buy_potential = '1001-5000'\n\t\t\tOR household_demographics.hd_buy_potential = '5001-10000'\n\t\t)\n\t\tAND household_demographics.hd_vehicle_count > 0\n\t\tAND CASE\n\t\t\tWHEN household_demographics.hd_vehicle_count > 0 THEN household_demographics.hd_dep_count / household_demographics.hd_vehicle_count\n\t\t\tELSE NULL\n\t\tEND > 1\n\t\tAND date_dim.d_year IN (2000, 2000 + 1, 2000 + 2)\n\t\tAND store.s_county IN ('Williamson County', 'Williamson County', 'Williamson County', 'Williamson County')\n\tGROUP BY\n\t\tss_ticket_number,\n\t\tss_customer_sk\n) dj,\ncustomer\nWHERE\n\tss_customer_sk = c_customer_sk\n\tAND cnt BETWEEN 1 AND 5\nORDER BY\n\tcnt DESC,\n\tc_last_name ASC;\n",
    "76": "/* TPC-DS Query 74 */\n\nWITH year_total AS (\n\tSELECT\n\t\tc_customer_id AS customer_id,\n\t\tc_first_name AS customer_first_name,\n\t\tc_last_name AS customer_last_name,\n\t\td_year AS year,\n\t\tMAX(ss_net_paid) AS year_total,\n\t\t's' AS sale_type\n\tFROM\n\t\tcustomer,\n\t\tstore_sales,\n\t\tdate_dim\n\tWHERE\n\t\tc_customer_sk = ss_customer_sk\n\t\tAND ss_sold_date_sk = d_date_sk\n\t\tAND d_year IN (1999, 1999 + 1)\n\tGROUP BY\n\t\tc_customer_id,\n\t\tc_first_name,\n\t\tc_last_name,\n\t\td_year\n\tUNION ALL\n\tSELECT\n\t\tc_customer_id AS customer_id,\n\t\tc_first_name AS customer_first_name,\n\t\tc_last_name AS customer_last_name,\n\t\td_year AS year,\n\t\tMAX(ws_net_paid) AS year_total,\n\t\t'w' AS sale_type\n\tFROM\n\t\tcustomer,\n\t\tweb_sales,\n\t\tdate_dim\n\tWHERE\n\t\tc_customer_sk = ws_bill_customer_sk\n\t\tAND ws_sold_date_sk = d_date_sk\n\t\tAND d_year IN (1999, 1999 + 1)\n\tGROUP BY\n\t\tc_customer_id,\n\t\tc_first_name,\n\t\tc_last_name,\n\t\td_year\n)\nSELECT\n\tt_s_secyear.customer_id,\n\tt_s_secyear.customer_first_name,\n\tt_s_secyear.customer_last_name\nFROM\n\tyear_total t_s_firstyear,\n\tyear_total t_s_secyear,\n\tyear_total t_w_firstyear,\n\tyear_total t_w_secyear\nWHERE\n\tt_s_secyear.customer_id = t_s_firstyear.customer_id\n\tAND t_s_firstyear.customer_id = t_w_secyear.customer_id\n\tAND t_s_firstyear.customer_id = t_w_firstyear.customer_id\n\tAND t_s_firstyear.sale_type = 's'\n\tAND t_w_firstyear.sale_type = 'w'\n\tAND t_s_secyear.sale_type = 's'\n\tAND t_w_secyear.sale_type = 'w'\n\tAND t_s_firstyear.year = 1999\n\tAND t_s_secyear.year = 1999 + 1\n\tAND t_w_firstyear.year = 1999\n\tAND t_w_secyear.year = 1999 + 1\n\tAND t_s_firstyear.year_total > 0\n\tAND t_w_firstyear.year_total > 0\n\tAND CASE\n\t\tWHEN t_w_firstyear.year_total > 0 THEN t_w_secyear.year_total / t_w_firstyear.year_total\n\t\tELSE NULL\n\tEND > CASE\n\t\tWHEN t_s_firstyear.year_total > 0 THEN t_s_secyear.year_total / t_s_firstyear.year_total\n\t\tELSE NULL\n\tEND\nORDER BY\n\t1,\n\t3,\n\t2\nLIMIT 100;\n",
    "77": "/* TPC-DS Query 75 */\n\nWITH all_sales AS (\n\tSELECT\n\t\td_year,\n\t\ti_brand_id,\n\t\ti_class_id,\n\t\ti_category_id,\n\t\ti_manufact_id,\n\t\tSUM(sales_cnt) AS sales_cnt,\n\t\tSUM(sales_amt) AS sales_amt\n\tFROM (\n\t\tSELECT\n\t\t\td_year,\n\t\t\ti_brand_id,\n\t\t\ti_class_id,\n\t\t\ti_category_id,\n\t\t\ti_manufact_id,\n\t\t\tcs_quantity - COALESCE(cr_return_quantity, 0) AS sales_cnt,\n\t\t\tcs_ext_sales_price - COALESCE(cr_return_amount, 0.0) AS sales_amt\n\t\tFROM\n\t\t\tcatalog_sales\n\t\t\tJOIN item ON i_item_sk = cs_item_sk\n\t\t\tJOIN date_dim ON d_date_sk = cs_sold_date_sk\n\t\t\tLEFT JOIN catalog_returns ON (\n\t\t\t\tcs_order_number = cr_order_number\n\t\t\t\tAND cs_item_sk = cr_item_sk\n\t\t\t)\n\t\tWHERE\n\t\t\ti_category = 'Sports'\n\t\tUNION\n\t\tSELECT\n\t\t\td_year,\n\t\t\ti_brand_id,\n\t\t\ti_class_id,\n\t\t\ti_category_id,\n\t\t\ti_manufact_id,\n\t\t\tss_quantity - COALESCE(sr_return_quantity, 0) AS sales_cnt,\n\t\t\tss_ext_sales_price - COALESCE(sr_return_amt, 0.0) AS sales_amt\n\t\tFROM\n\t\t\tstore_sales\n\t\t\tJOIN item ON i_item_sk = ss_item_sk\n\t\t\tJOIN date_dim ON d_date_sk = ss_sold_date_sk\n\t\t\tLEFT JOIN store_returns ON (\n\t\t\t\tss_ticket_number = sr_ticket_number\n\t\t\t\tAND ss_item_sk = sr_item_sk\n\t\t\t)\n\t\tWHERE\n\t\t\ti_category = 'Sports'\n\t\tUNION\n\t\tSELECT\n\t\t\td_year,\n\t\t\ti_brand_id,\n\t\t\ti_class_id,\n\t\t\ti_category_id,\n\t\t\ti_manufact_id,\n\t\t\tws_quantity - COALESCE(wr_return_quantity, 0) AS sales_cnt,\n\t\t\tws_ext_sales_price - COALESCE(wr_return_amt, 0.0) AS sales_amt\n\t\tFROM\n\t\t\tweb_sales\n\t\t\tJOIN item ON i_item_sk = ws_item_sk\n\t\t\tJOIN date_dim ON d_date_sk = ws_sold_date_sk\n\t\t\tLEFT JOIN web_returns ON (\n\t\t\t\tws_order_number = wr_order_number\n\t\t\t\tAND ws_item_sk = wr_item_sk\n\t\t\t)\n\t\tWHERE\n\t\t\ti_category = 'Sports'\n\t) sales_detail\n\tGROUP BY\n\t\td_year,\n\t\ti_brand_id,\n\t\ti_class_id,\n\t\ti_category_id,\n\t\ti_manufact_id\n)\nSELECT\n\tprev_yr.d_year AS prev_year,\n\tcurr_yr.d_year AS year,\n\tcurr_yr.i_brand_id,\n\tcurr_yr.i_class_id,\n\tcurr_yr.i_category_id,\n\tcurr_yr.i_manufact_id,\n\tprev_yr.sales_cnt AS prev_yr_cnt,\n\tcurr_yr.sales_cnt AS curr_yr_cnt,\n\tcurr_yr.sales_cnt - prev_yr.sales_cnt AS sales_cnt_diff,\n\tcurr_yr.sales_amt - prev_yr.sales_amt AS sales_amt_diff\nFROM\n\tall_sales curr_yr,\n\tall_sales prev_yr\nWHERE\n\tcurr_yr.i_brand_id = prev_yr.i_brand_id\n\tAND curr_yr.i_class_id = prev_yr.i_class_id\n\tAND curr_yr.i_category_id = prev_yr.i_category_id\n\tAND curr_yr.i_manufact_id = prev_yr.i_manufact_id\n\tAND curr_yr.d_year = 2002\n\tAND prev_yr.d_year = 2002 - 1\n\tAND CAST(curr_yr.sales_cnt AS DECIMAL(17, 2)) / CAST(prev_yr.sales_cnt AS DECIMAL(17, 2)) < 0.9\nORDER BY\n\tsales_cnt_diff,\n\tsales_amt_diff\nLIMIT 100;\n",
    "78": "/* TPC-DS Query 76 */\n\nSELECT\n\tchannel,\n\tcol_name,\n\td_year,\n\td_qoy,\n\ti_category,\n\tCOUNT(*) AS sales_cnt,\n\tSUM(ext_sales_price) AS sales_amt\nFROM (\n\tSELECT\n\t\t'store' AS channel,\n\t\t'ss_customer_sk' AS col_name,\n\t\td_year,\n\t\td_qoy,\n\t\ti_category,\n\t\tss_ext_sales_price AS ext_sales_price\n\tFROM\n\t\tstore_sales,\n\t\titem,\n\t\tdate_dim\n\tWHERE\n\t\tss_customer_sk IS NULL\n\t\tAND ss_sold_date_sk = d_date_sk\n\t\tAND ss_item_sk = i_item_sk\n\tUNION ALL\n\tSELECT\n\t\t'web' AS channel,\n\t\t'ws_promo_sk' AS col_name,\n\t\td_year,\n\t\td_qoy,\n\t\ti_category,\n\t\tws_ext_sales_price AS ext_sales_price\n\tFROM\n\t\tweb_sales,\n\t\titem,\n\t\tdate_dim\n\tWHERE\n\t\tws_promo_sk IS NULL\n\t\tAND ws_sold_date_sk = d_date_sk\n\t\tAND ws_item_sk = i_item_sk\n\tUNION ALL\n\tSELECT\n\t\t'catalog' AS channel,\n\t\t'cs_bill_customer_sk' AS col_name,\n\t\td_year,\n\t\td_qoy,\n\t\ti_category,\n\t\tcs_ext_sales_price AS ext_sales_price\n\tFROM\n\t\tcatalog_sales,\n\t\titem,\n\t\tdate_dim\n\tWHERE\n\t\tcs_bill_customer_sk IS NULL\n\t\tAND cs_sold_date_sk = d_date_sk\n\t\tAND cs_item_sk = i_item_sk\n) foo\nGROUP BY\n\tchannel,\n\tcol_name,\n\td_year,\n\td_qoy,\n\ti_category\nORDER BY\n\tchannel,\n\tcol_name,\n\td_year,\n\td_qoy,\n\ti_category\nLIMIT 100;\n",
    "79": "/* TPC-DS Query 77 */\n\nWITH ss AS (\n\tSELECT\n\t\ts_store_sk,\n\t\tSUM(ss_ext_sales_price) AS sales,\n\t\tSUM(ss_net_profit) AS profit\n\tFROM\n\t\tstore_sales,\n\t\tdate_dim,\n\t\tstore\n\tWHERE\n\t\tss_sold_date_sk = d_date_sk\n\t\tAND d_date BETWEEN CAST('2000-08-10' AS DATE)\n\t\t\tAND (CAST('2000-08-10' AS DATE) + 30)\n\t\tAND ss_store_sk = s_store_sk\n\tGROUP BY\n\t\ts_store_sk\n),\n\nsr AS (\n\tSELECT\n\t\ts_store_sk,\n\t\tSUM(sr_return_amt) AS returns,\n\t\tSUM(sr_net_loss) AS profit_loss\n\tFROM\n\t\tstore_returns,\n\t\tdate_dim,\n\t\tstore\n\tWHERE\n\t\tsr_returned_date_sk = d_date_sk\n\t\tAND d_date BETWEEN CAST('2000-08-10' AS DATE)\n\t\t\tAND (CAST('2000-08-10' AS DATE) + 30)\n\t\tAND sr_store_sk = s_store_sk\n\tGROUP BY\n\t\ts_store_sk\n),\n\ncs AS (\n\tSELECT\n\t\tcs_call_center_sk,\n\t\tSUM(cs_ext_sales_price) AS sales,\n\t\tSUM(cs_net_profit) AS profit\n\tFROM\n\t\tcatalog_sales,\n\t\tdate_dim\n\tWHERE\n\t\tcs_sold_date_sk = d_date_sk\n\t\tAND d_date BETWEEN CAST('2000-08-10' AS DATE)\n\t\t\tAND (CAST('2000-08-10' AS DATE) + 30)\n\tGROUP BY\n\t\tcs_call_center_sk\n),\n\ncr AS (\n\tSELECT\n\t\tcr_call_center_sk,\n\t\tSUM(cr_return_amount) AS returns,\n\t\tSUM(cr_net_loss) AS profit_loss\n\tFROM\n\t\tcatalog_returns,\n\t\tdate_dim\n\tWHERE\n\t\tcr_returned_date_sk = d_date_sk\n\t\tAND d_date BETWEEN CAST('2000-08-10' AS DATE)\n\t\t\tAND (CAST('2000-08-10' AS DATE) + 30)\n\tGROUP BY\n\t\tcr_call_center_sk\n),\n\nws AS (\n\tSELECT\n\t\twp_web_page_sk,\n\t\tSUM(ws_ext_sales_price) AS sales,\n\t\tSUM(ws_net_profit) AS profit\n\tFROM\n\t\tweb_sales,\n\t\tdate_dim,\n\t\tweb_page\n\tWHERE\n\t\tws_sold_date_sk = d_date_sk\n\t\tAND d_date BETWEEN CAST('2000-08-10' AS DATE)\n\t\t\tAND (CAST('2000-08-10' AS DATE) + 30)\n\t\tAND ws_web_page_sk = wp_web_page_sk\n\tGROUP BY\n\t\twp_web_page_sk\n),\n\nwr AS (\n\tSELECT\n\t\twp_web_page_sk,\n\t\tSUM(wr_return_amt) AS returns,\n\t\tSUM(wr_net_loss) AS profit_loss\n\tFROM\n\t\tweb_returns,\n\t\tdate_dim,\n\t\tweb_page\n\tWHERE\n\t\twr_returned_date_sk = d_date_sk\n\t\tAND d_date BETWEEN CAST('2000-08-10' AS DATE)\n\t\t\tAND (CAST('2000-08-10' AS DATE) + 30)\n\t\tAND wr_web_page_sk = wp_web_page_sk\n\tGROUP BY\n\t\twp_web_page_sk\n)\n\nSELECT\n\tchannel,\n\tid,\n\tSUM(sales) AS sales,\n\tSUM(returns) AS returns,\n\tSUM(profit) AS profit\nFROM (\n\tSELECT\n\t\t'store channel' AS channel,\n\t\tss.s_store_sk AS id,\n\t\tsales,\n\t\tCOALESCE(returns, 0) AS returns,\n\t\t(profit - COALESCE(profit_loss, 0)) AS profit\n\tFROM\n\t\tss\n\t\tLEFT JOIN sr ON ss.s_store_sk = sr.s_store_sk\n\tUNION ALL\n\tSELECT\n\t\t'catalog channel' AS channel,\n\t\tcs_call_center_sk AS id,\n\t\tsales,\n\t\treturns,\n\t\t(profit - profit_loss) AS profit\n\tFROM\n\t\tcs,\n\t\tcr\n\tUNION ALL\n\tSELECT\n\t\t'web channel' AS channel,\n\t\tws.wp_web_page_sk AS id,\n\t\tsales,\n\t\tCOALESCE(returns, 0) AS returns,\n\t\t(profit - COALESCE(profit_loss, 0)) AS profit\n\tFROM\n\t\tws\n\t\tLEFT JOIN wr ON ws.wp_web_page_sk = wr.wp_web_page_sk\n) x\nGROUP BY\n\tROLLUP (channel, id)\nORDER BY\n\tchannel,\n\tid\nLIMIT 100;\n",
    "80": "/* TPC-DS Query 78 */\n\nWITH ws AS (\n\tSELECT\n\t\td_year AS ws_sold_year,\n\t\tws_item_sk,\n\t\tws_bill_customer_sk AS ws_customer_sk,\n\t\tSUM(ws_quantity) AS ws_qty,\n\t\tSUM(ws_wholesale_cost) AS ws_wc,\n\t\tSUM(ws_sales_price) AS ws_sp\n\tFROM\n\t\tweb_sales\n\t\tLEFT JOIN web_returns ON wr_order_number = ws_order_number AND ws_item_sk = wr_item_sk\n\t\tJOIN date_dim ON ws_sold_date_sk = d_date_sk\n\tWHERE\n\t\twr_order_number IS NULL\n\tGROUP BY\n\t\td_year,\n\t\tws_item_sk,\n\t\tws_bill_customer_sk\n),\ncs AS (\n\tSELECT\n\t\td_year AS cs_sold_year,\n\t\tcs_item_sk,\n\t\tcs_bill_customer_sk AS cs_customer_sk,\n\t\tSUM(cs_quantity) AS cs_qty,\n\t\tSUM(cs_wholesale_cost) AS cs_wc,\n\t\tSUM(cs_sales_price) AS cs_sp\n\tFROM\n\t\tcatalog_sales\n\t\tLEFT JOIN catalog_returns ON cr_order_number = cs_order_number AND cs_item_sk = cr_item_sk\n\t\tJOIN date_dim ON cs_sold_date_sk = d_date_sk\n\tWHERE\n\t\tcr_order_number IS NULL\n\tGROUP BY\n\t\td_year,\n\t\tcs_item_sk,\n\t\tcs_bill_customer_sk\n),\nss AS (\n\tSELECT\n\t\td_year AS ss_sold_year,\n\t\tss_item_sk,\n\t\tss_customer_sk,\n\t\tSUM(ss_quantity) AS ss_qty,\n\t\tSUM(ss_wholesale_cost) AS ss_wc,\n\t\tSUM(ss_sales_price) AS ss_sp\n\tFROM\n\t\tstore_sales\n\t\tLEFT JOIN store_returns ON sr_ticket_number = ss_ticket_number AND ss_item_sk = sr_item_sk\n\t\tJOIN date_dim ON ss_sold_date_sk = d_date_sk\n\tWHERE\n\t\tsr_ticket_number IS NULL\n\tGROUP BY\n\t\td_year,\n\t\tss_item_sk,\n\t\tss_customer_sk\n)\nSELECT\n\tss_customer_sk,\n\tROUND(ss_qty / (COALESCE(ws_qty, 0) + COALESCE(cs_qty, 0)), 2) AS ratio,\n\tss_qty AS store_qty,\n\tss_wc AS store_wholesale_cost,\n\tss_sp AS store_sales_price,\n\tCOALESCE(ws_qty, 0) + COALESCE(cs_qty, 0) AS other_chan_qty,\n\tCOALESCE(ws_wc, 0) + COALESCE(cs_wc, 0) AS other_chan_wholesale_cost,\n\tCOALESCE(ws_sp, 0) + COALESCE(cs_sp, 0) AS other_chan_sales_price\nFROM\n\tss\n\tLEFT JOIN ws ON (ws_sold_year = ss_sold_year AND ws_item_sk = ss_item_sk AND ws_customer_sk = ss_customer_sk)\n\tLEFT JOIN cs ON (cs_sold_year = ss_sold_year AND cs_item_sk = ss_item_sk AND cs_customer_sk = ss_customer_sk)\nWHERE\n\t(COALESCE(ws_qty, 0) > 0 OR COALESCE(cs_qty, 0) > 0)\n\tAND ss_sold_year = 1998\nORDER BY\n\tss_customer_sk,\n\tss_qty DESC,\n\tss_wc DESC,\n\tss_sp DESC,\n\tother_chan_qty,\n\tother_chan_wholesale_cost,\n\tother_chan_sales_price,\n\tratio\nLIMIT 100;\n",
    "81": "/* TPC-DS Query 79 */\n\nSELECT\n\tc_last_name,\n\tc_first_name,\n\tsubstr(s_city, 1, 30),\n\tss_ticket_number,\n\tamt,\n\tprofit\nFROM (\n\tSELECT\n\t\tss_ticket_number,\n\t\tss_customer_sk,\n\t\tstore.s_city,\n\t\tSUM(ss_coupon_amt) AS amt,\n\t\tSUM(ss_net_profit) AS profit\n\tFROM\n\t\tstore_sales,\n\t\tdate_dim,\n\t\tstore,\n\t\thousehold_demographics\n\tWHERE\n\t\tstore_sales.ss_sold_date_sk = date_dim.d_date_sk\n\t\tAND store_sales.ss_store_sk = store.s_store_sk\n\t\tAND store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n\t\tAND (\n\t\t\thousehold_demographics.hd_dep_count = 7\n\t\t\tOR household_demographics.hd_vehicle_count > -1\n\t\t)\n\t\tAND date_dim.d_dow = 1\n\t\tAND date_dim.d_year IN (2000, 2000 + 1, 2000 + 2)\n\t\tAND store.s_number_employees BETWEEN 200 AND 295\n\tGROUP BY\n\t\tss_ticket_number,\n\t\tss_customer_sk,\n\t\tss_addr_sk,\n\t\tstore.s_city\n) ms,\ncustomer\nWHERE\n\tss_customer_sk = c_customer_sk\nORDER BY\n\tc_last_name,\n\tc_first_name,\n\tsubstr(s_city, 1, 30),\n\tprofit\nLIMIT 100;\n",
    "82": "/* TPC-DS Query 80 */\n\nWITH ssr AS (\n\tSELECT\n\t\ts_store_id AS store_id,\n\t\tSUM(ss_ext_sales_price) AS sales,\n\t\tSUM(COALESCE(sr_return_amt, 0)) AS returns,\n\t\tSUM(ss_net_profit - COALESCE(sr_net_loss, 0)) AS profit\n\tFROM\n\t\tstore_sales\n\t\tLEFT OUTER JOIN store_returns ON (ss_item_sk = sr_item_sk AND ss_ticket_number = sr_ticket_number),\n\t\tdate_dim,\n\t\tstore,\n\t\titem,\n\t\tpromotion\n\tWHERE\n\t\tss_sold_date_sk = d_date_sk\n\t\tAND d_date BETWEEN CAST('2002-08-14' AS DATE)\n\t\t\tAND (CAST('2002-08-14' AS DATE) + 30)\n\t\tAND ss_store_sk = s_store_sk\n\t\tAND ss_item_sk = i_item_sk\n\t\tAND i_current_price > 50\n\t\tAND ss_promo_sk = p_promo_sk\n\t\tAND p_channel_tv = 'N'\n\tGROUP BY\n\t\ts_store_id\n),\ncsr AS (\n\tSELECT\n\t\tcp_catalog_page_id AS catalog_page_id,\n\t\tSUM(cs_ext_sales_price) AS sales,\n\t\tSUM(COALESCE(cr_return_amount, 0)) AS returns,\n\t\tSUM(cs_net_profit - COALESCE(cr_net_loss, 0)) AS profit\n\tFROM\n\t\tcatalog_sales\n\t\tLEFT OUTER JOIN catalog_returns ON (cs_item_sk = cr_item_sk AND cs_order_number = cr_order_number),\n\t\tdate_dim,\n\t\tcatalog_page,\n\t\titem,\n\t\tpromotion\n\tWHERE\n\t\tcs_sold_date_sk = d_date_sk\n\t\tAND d_date BETWEEN CAST('2002-08-14' AS DATE)\n\t\t\tAND (CAST('2002-08-14' AS DATE) + 30)\n\t\tAND cs_catalog_page_sk = cp_catalog_page_sk\n\t\tAND cs_item_sk = i_item_sk\n\t\tAND i_current_price > 50\n\t\tAND cs_promo_sk = p_promo_sk\n\t\tAND p_channel_tv = 'N'\n\tGROUP BY\n\t\tcp_catalog_page_id\n),\nwsr AS (\n\tSELECT\n\t\tweb_site_id,\n\t\tSUM(ws_ext_sales_price) AS sales,\n\t\tSUM(COALESCE(wr_return_amt, 0)) AS returns,\n\t\tSUM(ws_net_profit - COALESCE(wr_net_loss, 0)) AS profit\n\tFROM\n\t\tweb_sales\n\t\tLEFT OUTER JOIN web_returns ON (ws_item_sk = wr_item_sk AND ws_order_number = wr_order_number),\n\t\tdate_dim,\n\t\tweb_site,\n\t\titem,\n\t\tpromotion\n\tWHERE\n\t\tws_sold_date_sk = d_date_sk\n\t\tAND d_date BETWEEN CAST('2002-08-14' AS DATE)\n\t\t\tAND (CAST('2002-08-14' AS DATE) + 30)\n\t\tAND ws_web_site_sk = web_site_sk\n\t\tAND ws_item_sk = i_item_sk\n\t\tAND i_current_price > 50\n\t\tAND ws_promo_sk = p_promo_sk\n\t\tAND p_channel_tv = 'N'\n\tGROUP BY\n\t\tweb_site_id\n)\nSELECT\n\tchannel,\n\tid,\n\tSUM(sales) AS sales,\n\tSUM(returns) AS returns,\n\tSUM(profit) AS profit\nFROM (\n\tSELECT\n\t\t'store channel' AS channel,\n\t\t'store' || store_id AS id,\n\t\tsales,\n\t\treturns,\n\t\tprofit\n\tFROM\n\t\tssr\n\tUNION ALL\n\tSELECT\n\t\t'catalog channel' AS channel,\n\t\t'catalog_page' || catalog_page_id AS id,\n\t\tsales,\n\t\treturns,\n\t\tprofit\n\tFROM\n\t\tcsr\n\tUNION ALL\n\tSELECT\n\t\t'web channel' AS channel,\n\t\t'web_site' || web_site_id AS id,\n\t\tsales,\n\t\treturns,\n\t\tprofit\n\tFROM\n\t\twsr\n) x\nGROUP BY\n\tROLLUP (channel, id)\nORDER BY\n\tchannel,\n\tid\nLIMIT 100;\n",
    "83": "/* TPC-DS Query 81 */\n\nWITH customer_total_return AS (\n\tSELECT\n\t\tcr_returning_customer_sk AS ctr_customer_sk,\n\t\tca_state AS ctr_state,\n\t\tSUM(cr_return_amt_inc_tax) AS ctr_total_return\n\tFROM\n\t\tcatalog_returns,\n\t\tdate_dim,\n\t\tcustomer_address\n\tWHERE\n\t\tcr_returned_date_sk = d_date_sk\n\t\tAND d_year = 2001\n\t\tAND cr_returning_addr_sk = ca_address_sk\n\tGROUP BY\n\t\tcr_returning_customer_sk,\n\t\tca_state\n)\nSELECT\n\tc_customer_id,\n\tc_salutation,\n\tc_first_name,\n\tc_last_name,\n\tca_street_number,\n\tca_street_name,\n\tca_street_type,\n\tca_suite_number,\n\tca_city,\n\tca_county,\n\tca_state,\n\tca_zip,\n\tca_country,\n\tca_gmt_offset,\n\tca_location_type,\n\tctr_total_return\nFROM\n\tcustomer_total_return ctr1,\n\tcustomer_address,\n\tcustomer\nWHERE\n\tctr1.ctr_total_return > (\n\t\tSELECT\n\t\t\tAVG(ctr_total_return) * 1.2\n\t\tFROM\n\t\t\tcustomer_total_return ctr2\n\t\tWHERE\n\t\t\tctr1.ctr_state = ctr2.ctr_state\n\t)\n\tAND ca_address_sk = c_current_addr_sk\n\tAND ca_state = 'TN'\n\tAND ctr1.ctr_customer_sk = c_customer_sk\nORDER BY\n\tc_customer_id,\n\tc_salutation,\n\tc_first_name,\n\tc_last_name,\n\tca_street_number,\n\tca_street_name,\n\tca_street_type,\n\tca_suite_number,\n\tca_city,\n\tca_county,\n\tca_state,\n\tca_zip,\n\tca_country,\n\tca_gmt_offset,\n\tca_location_type,\n\tctr_total_return\nLIMIT 100;\n",
    "84": "/* TPC-DS Query 82 */\n\nSELECT\n\ti_item_id,\n\ti_item_desc,\n\ti_current_price\nFROM\n\titem,\n\tinventory,\n\tdate_dim,\n\tstore_sales\nWHERE\n\ti_current_price BETWEEN 58 AND 58 + 30\n\tAND inv_item_sk = i_item_sk\n\tAND d_date_sk = inv_date_sk\n\tAND d_date BETWEEN CAST('2001-01-13' AS DATE) AND (CAST('2001-01-13' AS DATE) + 60)\n\tAND i_manufact_id IN (259, 559, 580, 485)\n\tAND inv_quantity_on_hand BETWEEN 100 AND 500\n\tAND ss_item_sk = i_item_sk\nGROUP BY\n\ti_item_id,\n\ti_item_desc,\n\ti_current_price\nORDER BY\n\ti_item_id\nLIMIT 100;\n",
    "85": "/* TPC-DS Query 83 */\n\nWITH sr_items AS (\n\tSELECT\n\t\ti_item_id AS item_id,\n\t\tSUM(sr_return_quantity) AS sr_item_qty\n\tFROM\n\t\tstore_returns,\n\t\titem,\n\t\tdate_dim\n\tWHERE\n\t\tsr_item_sk = i_item_sk\n\t\tAND d_date IN (\n\t\t\tSELECT\n\t\t\t\td_date\n\t\t\tFROM\n\t\t\t\tdate_dim\n\t\t\tWHERE\n\t\t\t\td_week_seq IN (\n\t\t\t\t\tSELECT\n\t\t\t\t\t\td_week_seq\n\t\t\t\t\tFROM\n\t\t\t\t\t\tdate_dim\n\t\t\t\t\tWHERE\n\t\t\t\t\t\td_date IN ('2001-07-13', '2001-09-10', '2001-11-16')\n\t\t\t\t)\n\t\t\t)\n\t\t)\n\t\tAND sr_returned_date_sk = d_date_sk\n\tGROUP BY\n\t\ti_item_id\n),\ncr_items AS (\n\tSELECT\n\t\ti_item_id AS item_id,\n\t\tSUM(cr_return_quantity) AS cr_item_qty\n\tFROM\n\t\tcatalog_returns,\n\t\titem,\n\t\tdate_dim\n\tWHERE\n\t\tcr_item_sk = i_item_sk\n\t\tAND d_date IN (\n\t\t\tSELECT\n\t\t\t\td_date\n\t\t\tFROM\n\t\t\t\tdate_dim\n\t\t\tWHERE\n\t\t\t\td_week_seq IN (\n\t\t\t\t\tSELECT\n\t\t\t\t\t\td_week_seq\n\t\t\t\t\tFROM\n\t\t\t\t\t\tdate_dim\n\t\t\t\t\tWHERE\n\t\t\t\t\t\td_date IN ('2001-07-13', '2001-09-10', '2001-11-16')\n\t\t\t\t)\n\t\t\t)\n\t\t)\n\t\tAND cr_returned_date_sk = d_date_sk\n\tGROUP BY\n\t\ti_item_id\n),\nwr_items AS (\n\tSELECT\n\t\ti_item_id AS item_id,\n\t\tSUM(wr_return_quantity) AS wr_item_qty\n\tFROM\n\t\tweb_returns,\n\t\titem,\n\t\tdate_dim\n\tWHERE\n\t\twr_item_sk = i_item_sk\n\t\tAND d_date IN (\n\t\t\tSELECT\n\t\t\t\td_date\n\t\t\tFROM\n\t\t\t\tdate_dim\n\t\t\tWHERE\n\t\t\t\td_week_seq IN (\n\t\t\t\t\tSELECT\n\t\t\t\t\t\td_week_seq\n\t\t\t\t\tFROM\n\t\t\t\t\t\tdate_dim\n\t\t\t\t\tWHERE\n\t\t\t\t\t\td_date IN ('2001-07-13', '2001-09-10', '2001-11-16')\n\t\t\t\t)\n\t\t\t)\n\t\t)\n\t\tAND wr_returned_date_sk = d_date_sk\n\tGROUP BY\n\t\ti_item_id\n)\nSELECT\n\tsr_items.item_id,\n\tsr_item_qty,\n\tsr_item_qty / (sr_item_qty + cr_item_qty + wr_item_qty) / 3.0 * 100 AS sr_dev,\n\tcr_item_qty,\n\tcr_item_qty / (sr_item_qty + cr_item_qty + wr_item_qty) / 3.0 * 100 AS cr_dev,\n\twr_item_qty,\n\twr_item_qty / (sr_item_qty + cr_item_qty + wr_item_qty) / 3.0 * 100 AS wr_dev,\n\t(sr_item_qty + cr_item_qty + wr_item_qty) / 3.0 AS average\nFROM\n\tsr_items,\n\tcr_items,\n\twr_items\nWHERE\n\tsr_items.item_id = cr_items.item_id\n\tAND sr_items.item_id = wr_items.item_id\nORDER BY\n\tsr_items.item_id,\n\tsr_item_qty\nLIMIT 100;\n",
    "86": "/* TPC-DS Query 84 */\n\nSELECT\n\tc_customer_id AS customer_id,\n\tCOALESCE(c_last_name, '') || ', ' || COALESCE(c_first_name, '') AS customername\nFROM\n\tcustomer,\n\tcustomer_address,\n\tcustomer_demographics,\n\thousehold_demographics,\n\tincome_band,\n\tstore_returns\nWHERE\n\tca_city = 'Woodland'\n\tAND c_current_addr_sk = ca_address_sk\n\tAND ib_lower_bound >= 60306\n\tAND ib_upper_bound <= 60306 + 50000\n\tAND ib_income_band_sk = hd_income_band_sk\n\tAND cd_demo_sk = c_current_cdemo_sk\n\tAND hd_demo_sk = c_current_hdemo_sk\n\tAND sr_cdemo_sk = cd_demo_sk\nORDER BY\n\tc_customer_id\nLIMIT 100;\n",
    "87": "/* TPC-DS Query 85 */\n\nSELECT\n\tsubstr(r_reason_desc, 1, 20),\n\tAVG(ws_quantity),\n\tAVG(wr_refunded_cash),\n\tAVG(wr_fee)\nFROM\n\tweb_sales,\n\tweb_returns,\n\tweb_page,\n\tcustomer_demographics cd1,\n\tcustomer_demographics cd2,\n\tcustomer_address,\n\tdate_dim,\n\treason\nWHERE\n\tws_web_page_sk = wp_web_page_sk\n\tAND ws_item_sk = wr_item_sk\n\tAND ws_order_number = wr_order_number\n\tAND ws_sold_date_sk = d_date_sk\n\tAND d_year = 1998\n\tAND cd1.cd_demo_sk = wr_refunded_cdemo_sk\n\tAND cd2.cd_demo_sk = wr_returning_cdemo_sk\n\tAND ca_address_sk = wr_refunded_addr_sk\n\tAND r_reason_sk = wr_reason_sk\n\tAND (\n\t\t(\n\t\t\tcd1.cd_marital_status = 'D'\n\t\t\tAND cd1.cd_marital_status = cd2.cd_marital_status\n\t\t\tAND cd1.cd_education_status = 'Primary'\n\t\t\tAND cd1.cd_education_status = cd2.cd_education_status\n\t\t\tAND ws_sales_price BETWEEN 100.00 AND 150.00\n\t\t)\n\t\tOR (\n\t\t\tcd1.cd_marital_status = 'S'\n\t\t\tAND cd1.cd_marital_status = cd2.cd_marital_status\n\t\t\tAND cd1.cd_education_status = 'College'\n\t\t\tAND cd1.cd_education_status = cd2.cd_education_status\n\t\t\tAND ws_sales_price BETWEEN 50.00 AND 100.00\n\t\t)\n\t\tOR (\n\t\t\tcd1.cd_marital_status = 'U'\n\t\t\tAND cd1.cd_marital_status = cd2.cd_marital_status\n\t\t\tAND cd1.cd_education_status = 'Advanced Degree'\n\t\t\tAND cd1.cd_education_status = cd2.cd_education_status\n\t\t\tAND ws_sales_price BETWEEN 150.00 AND 200.00\n\t\t)\n\t)\n\tAND (\n\t\t(\n\t\t\tca_country = 'United States'\n\t\t\tAND ca_state IN ('NC', 'TX', 'IA')\n\t\t\tAND ws_net_profit BETWEEN 100 AND 200\n\t\t)\n\t\tOR (\n\t\t\tca_country = 'United States'\n\t\t\tAND ca_state IN ('WI', 'WV', 'GA')\n\t\t\tAND ws_net_profit BETWEEN 150 AND 300\n\t\t)\n\t\tOR (\n\t\t\tca_country = 'United States'\n\t\t\tAND ca_state IN ('OK', 'VA', 'KY')\n\t\t\tAND ws_net_profit BETWEEN 50 AND 250\n\t\t)\n\t)\nGROUP BY\n\tr_reason_desc\nORDER BY\n\tsubstr(r_reason_desc, 1, 20),\n\tAVG(ws_quantity),\n\tAVG(wr_refunded_cash),\n\tAVG(wr_fee)\nLIMIT 100;\n",
    "88": "/* TPC-DS Query 86 */\n\nSELECT\n\t*\nFROM (\n\tSELECT\n\t\tSUM(ws_net_paid) AS total_sum,\n\t\ti_category,\n\t\ti_class,\n\t\tGROUPING(i_category) + GROUPING(i_class) AS lochierarchy,\n\t\tRANK() OVER (\n\t\t\tPARTITION BY GROUPING(i_category) + GROUPING(i_class),\n\t\t\tCASE WHEN GROUPING(i_class) = 0 THEN i_category END\n\t\t\tORDER BY SUM(ws_net_paid) DESC\n\t\t) AS rank_within_parent\n\tFROM\n\t\tweb_sales,\n\t\tdate_dim d1,\n\t\titem\n\tWHERE\n\t\td1.d_month_seq BETWEEN 1186 AND 1186 + 11\n\t\tAND d1.d_date_sk = ws_sold_date_sk\n\t\tAND i_item_sk = ws_item_sk\n\tGROUP BY\n\t\tROLLUP(i_category, i_class)\n) AS sub\nORDER BY\n\tlochierarchy DESC,\n\tCASE WHEN lochierarchy = 0 THEN i_category END,\n\trank_within_parent\nLIMIT 100;\n",
    "89": "/* TPC-DS Query 87 */\n\nSELECT\n\tCOUNT(*)\nFROM (\n\t(\n\t\tSELECT DISTINCT\n\t\t\tc_last_name,\n\t\t\tc_first_name,\n\t\t\td_date\n\t\tFROM\n\t\t\tstore_sales,\n\t\t\tdate_dim,\n\t\t\tcustomer\n\t\tWHERE\n\t\t\tstore_sales.ss_sold_date_sk = date_dim.d_date_sk\n\t\t\tAND store_sales.ss_customer_sk = customer.c_customer_sk\n\t\t\tAND d_month_seq BETWEEN 1202 AND 1202 + 11\n\t)\n\tEXCEPT\n\t(\n\t\tSELECT DISTINCT\n\t\t\tc_last_name,\n\t\t\tc_first_name,\n\t\t\td_date\n\t\tFROM\n\t\t\tcatalog_sales,\n\t\t\tdate_dim,\n\t\t\tcustomer\n\t\tWHERE\n\t\t\tcatalog_sales.cs_sold_date_sk = date_dim.d_date_sk\n\t\t\tAND catalog_sales.cs_bill_customer_sk = customer.c_customer_sk\n\t\t\tAND d_month_seq BETWEEN 1202 AND 1202 + 11\n\t)\n\tEXCEPT\n\t(\n\t\tSELECT DISTINCT\n\t\t\tc_last_name,\n\t\t\tc_first_name,\n\t\t\td_date\n\t\tFROM\n\t\t\tweb_sales,\n\t\t\tdate_dim,\n\t\t\tcustomer\n\t\tWHERE\n\t\t\tweb_sales.ws_sold_date_sk = date_dim.d_date_sk\n\t\t\tAND web_sales.ws_bill_customer_sk = customer.c_customer_sk\n\t\t\tAND d_month_seq BETWEEN 1202 AND 1202 + 11\n\t)\n) cool_cust;\n",
    "90": "/* TPC-DS Query 88 */\n\nSELECT\n\t*\nFROM (\n\tSELECT\n\t\tCOUNT(*) AS h8_30_to_9\n\tFROM\n\t\tstore_sales,\n\t\thousehold_demographics,\n\t\ttime_dim,\n\t\tstore\n\tWHERE\n\t\tss_sold_time_sk = time_dim.t_time_sk\n\t\tAND ss_hdemo_sk = household_demographics.hd_demo_sk\n\t\tAND ss_store_sk = s_store_sk\n\t\tAND time_dim.t_hour = 8\n\t\tAND time_dim.t_minute >= 30\n\t\tAND (\n\t\t\t(household_demographics.hd_dep_count = 0 AND household_demographics.hd_vehicle_count <= 0 + 2)\n\t\t\tOR (household_demographics.hd_dep_count = -1 AND household_demographics.hd_vehicle_count <= -1 + 2)\n\t\t\tOR (household_demographics.hd_dep_count = 3 AND household_demographics.hd_vehicle_count <= 3 + 2)\n\t\t)\n\t\tAND store.s_store_name = 'ese'\n) s1,\n(\n\tSELECT\n\t\tCOUNT(*) AS h9_to_9_30\n\tFROM\n\t\tstore_sales,\n\t\thousehold_demographics,\n\t\ttime_dim,\n\t\tstore\n\tWHERE\n\t\tss_sold_time_sk = time_dim.t_time_sk\n\t\tAND ss_hdemo_sk = household_demographics.hd_demo_sk\n\t\tAND ss_store_sk = s_store_sk\n\t\tAND time_dim.t_hour = 9\n\t\tAND time_dim.t_minute < 30\n\t\tAND (\n\t\t\t(household_demographics.hd_dep_count = 0 AND household_demographics.hd_vehicle_count <= 0 + 2)\n\t\t\tOR (household_demographics.hd_dep_count = -1 AND household_demographics.hd_vehicle_count <= -1 + 2)\n\t\t\tOR (household_demographics.hd_dep_count = 3 AND household_demographics.hd_vehicle_count <= 3 + 2)\n\t\t)\n\t\tAND store.s_store_name = 'ese'\n) s2,\n(\n\tSELECT\n\t\tCOUNT(*) AS h9_30_to_10\n\tFROM\n\t\tstore_sales,\n\t\thousehold_demographics,\n\t\ttime_dim,\n\t\tstore\n\tWHERE\n\t\tss_sold_time_sk = time_dim.t_time_sk\n\t\tAND ss_hdemo_sk = household_demographics.hd_demo_sk\n\t\tAND ss_store_sk = s_store_sk\n\t\tAND time_dim.t_hour = 9\n\t\tAND time_dim.t_minute >= 30\n\t\tAND (\n\t\t\t(household_demographics.hd_dep_count = 0 AND household_demographics.hd_vehicle_count <= 0 + 2)\n\t\t\tOR (household_demographics.hd_dep_count = -1 AND household_demographics.hd_vehicle_count <= -1 + 2)\n\t\t\tOR (household_demographics.hd_dep_count = 3 AND household_demographics.hd_vehicle_count <= 3 + 2)\n\t\t)\n\t\tAND store.s_store_name = 'ese'\n) s3,\n(\n\tSELECT\n\t\tCOUNT(*) AS h10_to_10_30\n\tFROM\n\t\tstore_sales,\n\t\thousehold_demographics,\n\t\ttime_dim,\n\t\tstore\n\tWHERE\n\t\tss_sold_time_sk = time_dim.t_time_sk\n\t\tAND ss_hdemo_sk = household_demographics.hd_demo_sk\n\t\tAND ss_store_sk = s_store_sk\n\t\tAND time_dim.t_hour = 10\n\t\tAND time_dim.t_minute < 30\n\t\tAND (\n\t\t\t(household_demographics.hd_dep_count = 0 AND household_demographics.hd_vehicle_count <= 0 + 2)\n\t\t\tOR (household_demographics.hd_dep_count = -1 AND household_demographics.hd_vehicle_count <= -1 + 2)\n\t\t\tOR (household_demographics.hd_dep_count = 3 AND household_demographics.hd_vehicle_count <= 3 + 2)\n\t\t)\n\t\tAND store.s_store_name = 'ese'\n) s4,\n(\n\tSELECT\n\t\tCOUNT(*) AS h10_30_to_11\n\tFROM\n\t\tstore_sales,\n\t\thousehold_demographics,\n\t\ttime_dim,\n\t\tstore\n\tWHERE\n\t\tss_sold_time_sk = time_dim.t_time_sk\n\t\tAND ss_hdemo_sk = household_demographics.hd_demo_sk\n\t\tAND ss_store_sk = s_store_sk\n\t\tAND time_dim.t_hour = 10\n\t\tAND time_dim.t_minute >= 30\n\t\tAND (\n\t\t\t(household_demographics.hd_dep_count = 0 AND household_demographics.hd_vehicle_count <= 0 + 2)\n\t\t\tOR (household_demographics.hd_dep_count = -1 AND household_demographics.hd_vehicle_count <= -1 + 2)\n\t\t\tOR (household_demographics.hd_dep_count = 3 AND household_demographics.hd_vehicle_count <= 3 + 2)\n\t\t)\n\t\tAND store.s_store_name = 'ese'\n) s5,\n(\n\tSELECT\n\t\tCOUNT(*) AS h11_to_11_30\n\tFROM\n\t\tstore_sales,\n\t\thousehold_demographics,\n\t\ttime_dim,\n\t\tstore\n\tWHERE\n\t\tss_sold_time_sk = time_dim.t_time_sk\n\t\tAND ss_hdemo_sk = household_demographics.hd_demo_sk\n\t\tAND ss_store_sk = s_store_sk\n\t\tAND time_dim.t_hour = 11\n\t\tAND time_dim.t_minute < 30\n\t\tAND (\n\t\t\t(household_demographics.hd_dep_count = 0 AND household_demographics.hd_vehicle_count <= 0 + 2)\n\t\t\tOR (household_demographics.hd_dep_count = -1 AND household_demographics.hd_vehicle_count <= -1 + 2)\n\t\t\tOR (household_demographics.hd_dep_count = 3 AND household_demographics.hd_vehicle_count <= 3 + 2)\n\t\t)\n\t\tAND store.s_store_name = 'ese'\n) s6,\n(\n\tSELECT\n\t\tCOUNT(*) AS h11_30_to_12\n\tFROM\n\t\tstore_sales,\n\t\thousehold_demographics,\n\t\ttime_dim,\n\t\tstore\n\tWHERE\n\t\tss_sold_time_sk = time_dim.t_time_sk\n\t\tAND ss_hdemo_sk = household_demographics.hd_demo_sk\n\t\tAND ss_store_sk = s_store_sk\n\t\tAND time_dim.t_hour = 11\n\t\tAND time_dim.t_minute >= 30\n\t\tAND (\n\t\t\t(household_demographics.hd_dep_count = 0 AND household_demographics.hd_vehicle_count <= 0 + 2)\n\t\t\tOR (household_demographics.hd_dep_count = -1 AND household_demographics.hd_vehicle_count <= -1 + 2)\n\t\t\tOR (household_demographics.hd_dep_count = 3 AND household_demographics.hd_vehicle_count <= 3 + 2)\n\t\t)\n\t\tAND store.s_store_name = 'ese'\n) s7,\n(\n\tSELECT\n\t\tCOUNT(*) AS h12_to_12_30\n\tFROM\n\t\tstore_sales,\n\t\thousehold_demographics,\n\t\ttime_dim,\n\t\tstore\n\tWHERE\n\t\tss_sold_time_sk = time_dim.t_time_sk\n\t\tAND ss_hdemo_sk = household_demographics.hd_demo_sk\n\t\tAND ss_store_sk = s_store_sk\n\t\tAND time_dim.t_hour = 12\n\t\tAND time_dim.t_minute < 30\n\t\tAND (\n\t\t\t(household_demographics.hd_dep_count = 0 AND household_demographics.hd_vehicle_count <= 0 + 2)\n\t\t\tOR (household_demographics.hd_dep_count = -1 AND household_demographics.hd_vehicle_count <= -1 + 2)\n\t\t\tOR (household_demographics.hd_dep_count = 3 AND household_demographics.hd_vehicle_count <= 3 + 2)\n\t\t)\n\t\tAND store.s_store_name = 'ese'\n) s8;\n",
    "91": "/* TPC-DS Query 89 */\n\nSELECT\n\t*\nFROM (\n\tSELECT\n\t\ti_category,\n\t\ti_class,\n\t\ti_brand,\n\t\ts_store_name,\n\t\ts_company_name,\n\t\td_moy,\n\t\tSUM(ss_sales_price) AS sum_sales,\n\t\tAVG(SUM(ss_sales_price)) OVER (\n\t\t\tPARTITION BY i_category, i_brand, s_store_name, s_company_name\n\t\t) AS avg_monthly_sales\n\tFROM\n\t\titem,\n\t\tstore_sales,\n\t\tdate_dim,\n\t\tstore\n\tWHERE\n\t\tss_item_sk = i_item_sk\n\t\tAND ss_sold_date_sk = d_date_sk\n\t\tAND ss_store_sk = s_store_sk\n\t\tAND d_year IN (2001)\n\t\tAND (\n\t\t\t(i_category IN ('Books', 'Children', 'Electronics')\n\t\t\t\tAND i_class IN ('history', 'school-uniforms', 'audio'))\n\t\t\tOR (i_category IN ('Men', 'Sports', 'Shoes')\n\t\t\t\tAND i_class IN ('pants', 'tennis', 'womens'))\n\t\t)\n\tGROUP BY\n\t\ti_category,\n\t\ti_class,\n\t\ti_brand,\n\t\ts_store_name,\n\t\ts_company_name,\n\t\td_moy\n) tmp1\nWHERE\n\tCASE\n\t\tWHEN (avg_monthly_sales <> 0) THEN (ABS(sum_sales - avg_monthly_sales) / avg_monthly_sales)\n\t\tELSE NULL\n\tEND > 0.1\nORDER BY\n\tsum_sales - avg_monthly_sales,\n\ts_store_name\nLIMIT 100;\n",
    "92": "/* TPC-DS Query 90 */\n\nSELECT\n\tCAST(amc AS DECIMAL(15, 4)) / CAST(pmc AS DECIMAL(15, 4)) AS am_pm_ratio\nFROM (\n\tSELECT\n\t\tCOUNT(*) AS amc\n\tFROM\n\t\tweb_sales,\n\t\thousehold_demographics,\n\t\ttime_dim,\n\t\tweb_page\n\tWHERE\n\t\tws_sold_time_sk = time_dim.t_time_sk\n\t\tAND ws_ship_hdemo_sk = household_demographics.hd_demo_sk\n\t\tAND ws_web_page_sk = web_page.wp_web_page_sk\n\t\tAND time_dim.t_hour BETWEEN 12 AND 12 + 1\n\t\tAND household_demographics.hd_dep_count = 6\n\t\tAND web_page.wp_char_count BETWEEN 5000 AND 5200\n) at,\n(\n\tSELECT\n\t\tCOUNT(*) AS pmc\n\tFROM\n\t\tweb_sales,\n\t\thousehold_demographics,\n\t\ttime_dim,\n\t\tweb_page\n\tWHERE\n\t\tws_sold_time_sk = time_dim.t_time_sk\n\t\tAND ws_ship_hdemo_sk = household_demographics.hd_demo_sk\n\t\tAND ws_web_page_sk = web_page.wp_web_page_sk\n\t\tAND time_dim.t_hour BETWEEN 14 AND 14 + 1\n\t\tAND household_demographics.hd_dep_count = 6\n\t\tAND web_page.wp_char_count BETWEEN 5000 AND 5200\n) pt\nORDER BY\n\tam_pm_ratio\nLIMIT 100;\n",
    "93": "/* TPC-DS Query 91 */\n\nSELECT\n\tcc_call_center_id AS Call_Center,\n\tcc_name AS Call_Center_Name,\n\tcc_manager AS Manager,\n\tSUM(cr_net_loss) AS Returns_Loss\nFROM\n\tcall_center,\n\tcatalog_returns,\n\tdate_dim,\n\tcustomer,\n\tcustomer_address,\n\tcustomer_demographics,\n\thousehold_demographics\nWHERE\n\tcr_call_center_sk = cc_call_center_sk\n\tAND cr_returned_date_sk = d_date_sk\n\tAND cr_returning_customer_sk = c_customer_sk\n\tAND cd_demo_sk = c_current_cdemo_sk\n\tAND hd_demo_sk = c_current_hdemo_sk\n\tAND ca_address_sk = c_current_addr_sk\n\tAND d_year = 2000\n\tAND d_moy = 12\n\tAND (\n\t\t(cd_marital_status = 'M' AND cd_education_status = 'Unknown')\n\t\tOR (cd_marital_status = 'W' AND cd_education_status = 'Advanced Degree')\n\t)\n\tAND hd_buy_potential LIKE 'Unknown%'\n\tAND ca_gmt_offset = -7\nGROUP BY\n\tcc_call_center_id,\n\tcc_name,\n\tcc_manager,\n\tcd_marital_status,\n\tcd_education_status\nORDER BY\n\tSUM(cr_net_loss) DESC;\n",
    "94": "/* TPC-DS Query 92 */\n\nSELECT\n\tSUM(ws_ext_discount_amt) AS \"Excess Discount Amount\"\nFROM\n\tweb_sales,\n\titem,\n\tdate_dim\nWHERE\n\ti_manufact_id = 714\n\tAND i_item_sk = ws_item_sk\n\tAND d_date BETWEEN '2000-02-01' AND (CAST('2000-02-01' AS DATE) + 90)\n\tAND d_date_sk = ws_sold_date_sk\n\tAND ws_ext_discount_amt > (\n\t\tSELECT\n\t\t\t1.3 * AVG(ws_ext_discount_amt)\n\t\tFROM\n\t\t\tweb_sales,\n\t\t\tdate_dim\n\t\tWHERE\n\t\t\tws_item_sk = i_item_sk\n\t\t\tAND d_date BETWEEN '2000-02-01' AND (CAST('2000-02-01' AS DATE) + 90)\n\t\t\tAND d_date_sk = ws_sold_date_sk\n\t)\nORDER BY\n\tSUM(ws_ext_discount_amt)\nLIMIT 100;\n",
    "95": "/* TPC-DS Query 93 */\n\nSELECT\n\tss_customer_sk,\n\tSUM(act_sales) AS sumsales\nFROM (\n\tSELECT\n\t\tss_item_sk,\n\t\tss_ticket_number,\n\t\tss_customer_sk,\n\t\tCASE\n\t\t\tWHEN sr_return_quantity IS NOT NULL THEN (ss_quantity - sr_return_quantity) * ss_sales_price\n\t\t\tELSE (ss_quantity * ss_sales_price)\n\t\tEND AS act_sales\n\tFROM\n\t\tstore_sales\n\t\tLEFT OUTER JOIN store_returns ON (sr_item_sk = ss_item_sk AND sr_ticket_number = ss_ticket_number),\n\t\treason\n\tWHERE\n\t\tsr_reason_sk = r_reason_sk\n\t\tAND r_reason_desc = 'reason 58'\n) t\nGROUP BY\n\tss_customer_sk\nORDER BY\n\tsumsales,\n\tss_customer_sk\nLIMIT 100;\n",
    "96": "/* TPC-DS Query 94 */\n\nSELECT\n\tCOUNT(DISTINCT ws_order_number) AS \"order count\",\n\tSUM(ws_ext_ship_cost) AS \"total shipping cost\",\n\tSUM(ws_net_profit) AS \"total net profit\"\nFROM\n\tweb_sales ws1,\n\tdate_dim,\n\tcustomer_address,\n\tweb_site\nWHERE\n\td_date BETWEEN '2002-5-01' AND (CAST('2002-5-01' AS DATE) + 60)\n\tAND ws1.ws_ship_date_sk = d_date_sk\n\tAND ws1.ws_ship_addr_sk = ca_address_sk\n\tAND ca_state = 'OK'\n\tAND ws1.ws_web_site_sk = web_site_sk\n\tAND web_company_name = 'pri'\n\tAND EXISTS (\n\t\tSELECT\n\t\t\t*\n\t\tFROM\n\t\t\tweb_sales ws2\n\t\tWHERE\n\t\t\tws1.ws_order_number = ws2.ws_order_number\n\t\t\tAND ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk\n\t)\n\tAND NOT EXISTS (\n\t\tSELECT\n\t\t\t*\n\t\tFROM\n\t\t\tweb_returns wr1\n\t\tWHERE\n\t\t\tws1.ws_order_number = wr1.wr_order_number\n\t)\nORDER BY\n\tCOUNT(DISTINCT ws_order_number)\nLIMIT 100;\n",
    "97": "/* TPC-DS Query 95 */\n\nWITH ws_wh AS (\n\tSELECT\n\t\tws1.ws_order_number,\n\t\tws1.ws_warehouse_sk AS wh1,\n\t\tws2.ws_warehouse_sk AS wh2\n\tFROM\n\t\tweb_sales ws1,\n\t\tweb_sales ws2\n\tWHERE\n\t\tws1.ws_order_number = ws2.ws_order_number\n\t\tAND ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk\n)\nSELECT\n\tCOUNT(DISTINCT ws_order_number) AS \"order count\",\n\tSUM(ws_ext_ship_cost) AS \"total shipping cost\",\n\tSUM(ws_net_profit) AS \"total net profit\"\nFROM\n\tweb_sales ws1,\n\tdate_dim,\n\tcustomer_address,\n\tweb_site\nWHERE\n\td_date BETWEEN '2001-4-01' AND (CAST('2001-4-01' AS DATE) + 60)\n\tAND ws1.ws_ship_date_sk = d_date_sk\n\tAND ws1.ws_ship_addr_sk = ca_address_sk\n\tAND ca_state = 'VA'\n\tAND ws1.ws_web_site_sk = web_site_sk\n\tAND web_company_name = 'pri'\n\tAND ws1.ws_order_number IN (\n\t\tSELECT\n\t\t\tws_order_number\n\t\tFROM\n\t\t\tws_wh\n\t)\n\tAND ws1.ws_order_number IN (\n\t\tSELECT\n\t\t\twr_order_number\n\t\tFROM\n\t\t\tweb_returns,\n\t\t\tws_wh\n\t\tWHERE\n\t\t\twr_order_number = ws_wh.ws_order_number\n\t)\nORDER BY\n\tCOUNT(DISTINCT ws_order_number)\nLIMIT 100;\n",
    "98": "/* TPC-DS Query 96 */\n\nSELECT\n\tCOUNT(*)\nFROM\n\tstore_sales,\n\thousehold_demographics,\n\ttime_dim,\n\tstore\nWHERE\n\tss_sold_time_sk = time_dim.t_time_sk\n\tAND ss_hdemo_sk = household_demographics.hd_demo_sk\n\tAND ss_store_sk = s_store_sk\n\tAND time_dim.t_hour = 8\n\tAND time_dim.t_minute >= 30\n\tAND household_demographics.hd_dep_count = 0\n\tAND store.s_store_name = 'ese'\nORDER BY\n\tCOUNT(*)\nLIMIT 100;\n",
    "99": "/* TPC-DS Query 97 */\n\nWITH ssci AS (\n\tSELECT\n\t\tss_customer_sk AS customer_sk,\n\t\tss_item_sk AS item_sk\n\tFROM\n\t\tstore_sales,\n\t\tdate_dim\n\tWHERE\n\t\tss_sold_date_sk = d_date_sk\n\t\tAND d_month_seq BETWEEN 1199 AND 1199 + 11\n\tGROUP BY\n\t\tss_customer_sk,\n\t\tss_item_sk\n),\ncsci AS (\n\tSELECT\n\t\tcs_bill_customer_sk AS customer_sk,\n\t\tcs_item_sk AS item_sk\n\tFROM\n\t\tcatalog_sales,\n\t\tdate_dim\n\tWHERE\n\t\tcs_sold_date_sk = d_date_sk\n\t\tAND d_month_seq BETWEEN 1199 AND 1199 + 11\n\tGROUP BY\n\t\tcs_bill_customer_sk,\n\t\tcs_item_sk\n)\nSELECT\n\tSUM(CASE WHEN ssci.customer_sk IS NOT NULL AND csci.customer_sk IS NULL THEN 1 ELSE 0 END) AS store_only,\n\tSUM(CASE WHEN ssci.customer_sk IS NULL AND csci.customer_sk IS NOT NULL THEN 1 ELSE 0 END) AS catalog_only,\n\tSUM(CASE WHEN ssci.customer_sk IS NOT NULL AND csci.customer_sk IS NOT NULL THEN 1 ELSE 0 END) AS store_and_catalog\nFROM\n\tssci\n\tFULL OUTER JOIN csci ON (\n\t\tssci.customer_sk = csci.customer_sk\n\t\tAND ssci.item_sk = csci.item_sk\n\t)\nLIMIT 100;\n",
    "100": "/* TPC-DS Query 98 */\n\nSELECT\n\ti_item_id,\n\ti_item_desc,\n\ti_category,\n\ti_class,\n\ti_current_price,\n\tSUM(ss_ext_sales_price) AS itemrevenue,\n\tSUM(ss_ext_sales_price) * 100 / SUM(SUM(ss_ext_sales_price)) OVER (PARTITION BY i_class) AS revenueratio\nFROM\n\tstore_sales,\n\titem,\n\tdate_dim\nWHERE\n\tss_item_sk = i_item_sk\n\tAND i_category IN ('Men', 'Sports', 'Jewelry')\n\tAND ss_sold_date_sk = d_date_sk\n\tAND d_date BETWEEN CAST('1999-02-05' AS DATE) AND (CAST('1999-02-05' AS DATE) + 30)\nGROUP BY\n\ti_item_id,\n\ti_item_desc,\n\ti_category,\n\ti_class,\n\ti_current_price\nORDER BY\n\ti_category,\n\ti_class,\n\ti_item_id,\n\ti_item_desc,\n\trevenueratio;\n",
    "101": "/* TPC-DS Query 99 */\n\nSELECT\n\tsubstr(w_warehouse_name, 1, 20),\n\tsm_type,\n\tcc_name,\n\tSUM(CASE WHEN (cs_ship_date_sk - cs_sold_date_sk <= 30) THEN 1 ELSE 0 END) AS \"30 days\",\n\tSUM(CASE WHEN (cs_ship_date_sk - cs_sold_date_sk > 30) AND (cs_ship_date_sk - cs_sold_date_sk <= 60) THEN 1 ELSE 0 END) AS \"31-60 days\",\n\tSUM(CASE WHEN (cs_ship_date_sk - cs_sold_date_sk > 60) AND (cs_ship_date_sk - cs_sold_date_sk <= 90) THEN 1 ELSE 0 END) AS \"61-90 days\",\n\tSUM(CASE WHEN (cs_ship_date_sk - cs_sold_date_sk > 90) AND (cs_ship_date_sk - cs_sold_date_sk <= 120) THEN 1 ELSE 0 END) AS \"91-120 days\",\n\tSUM(CASE WHEN (cs_ship_date_sk - cs_sold_date_sk > 120) THEN 1 ELSE 0 END) AS \">120 days\"\nFROM\n\tcatalog_sales,\n\twarehouse,\n\tship_mode,\n\tcall_center,\n\tdate_dim\nWHERE\n\td_month_seq BETWEEN 1194 AND 1194 + 11\n\tAND cs_ship_date_sk = d_date_sk\n\tAND cs_warehouse_sk = w_warehouse_sk\n\tAND cs_ship_mode_sk = sm_ship_mode_sk\n\tAND cs_call_center_sk = cc_call_center_sk\nGROUP BY\n\tsubstr(w_warehouse_name, 1, 20),\n\tsm_type,\n\tcc_name\nORDER BY\n\tsubstr(w_warehouse_name, 1, 20),\n\tsm_type,\n\tcc_name\nLIMIT 100;\n"
  }
}